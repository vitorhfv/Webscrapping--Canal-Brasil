[0m19:46:58.528794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7131C5400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E712D16710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E715E0F890>]}


============================== 19:46:58.534449 | 33b4e9db-89a4-438a-b69d-566926d8256a ==============================
[0m19:46:58.534449 [info ] [MainThread]: Running with dbt=1.7.4
[0m19:46:58.535207 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt ', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'c:\\Users\\Felli\\.code\\dbt\\canal_brasil_dbt\\logs', 'profiles_dir': 'C:\\Users\\Felli\\.dbt', 'use_colors': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m19:46:58.702360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33b4e9db-89a4-438a-b69d-566926d8256a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E715D51350>]}
[0m19:46:58.703150 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:46:58.704130 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:46:58.705764 [debug] [MainThread]: Command `cli deps` succeeded at 19:46:58.705573 after 0.23 seconds
[0m19:46:58.706132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E715CE3F00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E715CE3DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E715569050>]}
[0m19:46:58.706471 [debug] [MainThread]: Flushing usage events
[0m20:26:08.836740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E22D0C5160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E22FCFBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E22FCFBC50>]}


============================== 20:26:08.840489 | f56b1562-47b9-48e3-b8e7-8b80ba29cec3 ==============================
[0m20:26:08.840489 [info ] [MainThread]: Running with dbt=1.7.4
[0m20:26:08.841137 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt debug', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\Felli\\.code\\dbt\\canal_brasil_dbt\\logs', 'warn_error': 'None', 'use_colors': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Felli\\.dbt', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m20:26:08.841689 [info ] [MainThread]: dbt version: 1.7.4
[0m20:26:08.842083 [info ] [MainThread]: python version: 3.13.3
[0m20:26:08.842455 [info ] [MainThread]: python path: c:\Users\Felli\.code\.venv\Scripts\python.exe
[0m20:26:08.842797 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m20:26:08.942816 [info ] [MainThread]: Using profiles dir at C:\Users\Felli\.dbt
[0m20:26:08.943393 [info ] [MainThread]: Using profiles.yml file at C:\Users\Felli\.dbt\profiles.yml
[0m20:26:08.943895 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Felli\.code\dbt\canal_brasil_dbt\dbt_project.yml
[0m20:26:08.945079 [info ] [MainThread]: adapter type: postgres
[0m20:26:08.945545 [info ] [MainThread]: adapter version: 1.7.4
[0m20:26:09.022894 [info ] [MainThread]: Configuration:
[0m20:26:09.023400 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:26:09.023810 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:26:09.024191 [info ] [MainThread]: Required dependencies:
[0m20:26:09.024584 [debug] [MainThread]: Executing "git --help"
[0m20:26:09.054874 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:26:09.055328 [debug] [MainThread]: STDERR: "b''"
[0m20:26:09.055703 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:26:09.056337 [info ] [MainThread]: Connection:
[0m20:26:09.057042 [info ] [MainThread]:   host: ozadowjafypabbrltwoy.supabase.co
[0m20:26:09.057989 [info ] [MainThread]:   port: 5432
[0m20:26:09.058818 [info ] [MainThread]:   user: postgres
[0m20:26:09.059558 [info ] [MainThread]:   database: postgres
[0m20:26:09.060101 [info ] [MainThread]:   schema: public
[0m20:26:09.060572 [info ] [MainThread]:   connect_timeout: 10
[0m20:26:09.061066 [info ] [MainThread]:   role: None
[0m20:26:09.061656 [info ] [MainThread]:   search_path: None
[0m20:26:09.062257 [info ] [MainThread]:   keepalives_idle: 0
[0m20:26:09.062740 [info ] [MainThread]:   sslmode: None
[0m20:26:09.063306 [info ] [MainThread]:   sslcert: None
[0m20:26:09.063837 [info ] [MainThread]:   sslkey: None
[0m20:26:09.064345 [info ] [MainThread]:   sslrootcert: None
[0m20:26:09.064918 [info ] [MainThread]:   application_name: dbt
[0m20:26:09.065379 [info ] [MainThread]:   retries: 1
[0m20:26:09.065888 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m20:26:09.066815 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:26:09.067329 [debug] [MainThread]: Using postgres connection "debug"
[0m20:26:09.067672 [debug] [MainThread]: On debug: select 1 as id
[0m20:26:09.068141 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:26:29.233759 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "ozadowjafypabbrltwoy.supabase.co" (104.18.38.10), port 5432 failed: timeout expired
connection to server at "ozadowjafypabbrltwoy.supabase.co" (172.64.149.246), port 5432 failed: timeout expired

[0m20:26:49.246732 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m20:26:49.247272 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m20:26:49.247692 [debug] [MainThread]: On debug: No close available on handle
[0m20:26:49.247996 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m20:26:49.248510 [info ] [MainThread]: [31m1 check failed:[0m
[0m20:26:49.249050 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "ozadowjafypabbrltwoy.supabase.co" (104.18.38.10), port 5432 failed: timeout expired
  connection to server at "ozadowjafypabbrltwoy.supabase.co" (172.64.149.246), port 5432 failed: timeout expired
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m20:26:49.250324 [debug] [MainThread]: Command `dbt debug` failed at 20:26:49.250180 after 40.53 seconds
[0m20:26:49.250663 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:26:49.250983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E22FC33490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2300527B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E22FDE17B0>]}
[0m20:26:49.251343 [debug] [MainThread]: Flushing usage events
[0m01:00:25.175555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA23E91400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA239E6710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA26AEFED0>]}


============================== 01:00:25.179585 | d0c1d14f-5396-497a-b3d0-49037c6a6ea0 ==============================
[0m01:00:25.179585 [info ] [MainThread]: Running with dbt=1.7.4
[0m01:00:25.180152 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt ', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'c:\\Users\\Felli\\.code\\dbt\\canal_brasil_dbt\\logs', 'warn_error': 'None', 'cache_selected_only': 'False', 'introspect': 'True', 'profiles_dir': 'C:\\Users\\Felli\\.dbt', 'use_colors': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m01:00:25.294269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0c1d14f-5396-497a-b3d0-49037c6a6ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA26A39220>]}
[0m01:00:25.295054 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m01:00:25.296430 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m01:00:25.298252 [debug] [MainThread]: Command `cli deps` succeeded at 01:00:25.297952 after 0.21 seconds
[0m01:00:25.298667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA269C3F00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA269C3DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA26249050>]}
[0m01:00:25.298998 [debug] [MainThread]: Flushing usage events
[0m01:04:14.722235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B39D195160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B39FDCBD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B39FDCB750>]}


============================== 01:04:14.725842 | bb93c2cc-f47a-4e5c-bd81-7f2942d064ce ==============================
[0m01:04:14.725842 [info ] [MainThread]: Running with dbt=1.7.4
[0m01:04:14.726471 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt show --select canal_brasil', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\Felli\\.code\\dbt\\canal_brasil_dbt\\logs', 'profiles_dir': 'C:\\Users\\Felli\\.dbt', 'warn_error': 'None', 'introspect': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m01:04:14.929498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb93c2cc-f47a-4e5c-bd81-7f2942d064ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B39FD07100>]}
[0m01:04:15.013072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb93c2cc-f47a-4e5c-bd81-7f2942d064ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B39FED96A0>]}
[0m01:04:15.013988 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m01:04:15.020902 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m01:04:15.077943 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:04:15.078434 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:04:15.083126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb93c2cc-f47a-4e5c-bd81-7f2942d064ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3A02A8950>]}
[0m01:04:15.102606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb93c2cc-f47a-4e5c-bd81-7f2942d064ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B39FCA6E40>]}
[0m01:04:15.103161 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m01:04:15.103755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb93c2cc-f47a-4e5c-bd81-7f2942d064ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3A0157CB0>]}
[0m01:04:15.104866 [warn ] [MainThread]: The selection criterion 'canal_brasil' does not match any nodes
[0m01:04:15.106203 [info ] [MainThread]: 
[0m01:04:15.106687 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m01:04:15.107355 [debug] [MainThread]: Command end result
[0m01:04:15.118775 [debug] [MainThread]: Command `dbt show` succeeded at 01:04:15.118461 after 0.49 seconds
[0m01:04:15.119385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3A0112EA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B39FCDE690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3A0270650>]}
[0m01:04:15.119943 [debug] [MainThread]: Flushing usage events
[0m01:04:34.322956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1D9965160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1DC5ABD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1DC5AB750>]}


============================== 01:04:34.326886 | 01381082-339d-422b-a2b1-dcc3df7228e2 ==============================
[0m01:04:34.326886 [info ] [MainThread]: Running with dbt=1.7.4
[0m01:04:34.328044 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt show --select canal_brasil --limit 10', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\Felli\\.code\\dbt\\canal_brasil_dbt\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Felli\\.dbt', 'introspect': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m01:04:34.511955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01381082-339d-422b-a2b1-dcc3df7228e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1DC4E3100>]}
[0m01:04:34.592076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01381082-339d-422b-a2b1-dcc3df7228e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1DC6B96A0>]}
[0m01:04:34.592941 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m01:04:34.599970 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m01:04:34.652055 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:04:34.652414 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:04:34.657106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01381082-339d-422b-a2b1-dcc3df7228e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1DCADC950>]}
[0m01:04:34.665384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01381082-339d-422b-a2b1-dcc3df7228e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1DC486E40>]}
[0m01:04:34.665866 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m01:04:34.666359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01381082-339d-422b-a2b1-dcc3df7228e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1DC97FCB0>]}
[0m01:04:34.666959 [warn ] [MainThread]: The selection criterion 'canal_brasil' does not match any nodes
[0m01:04:34.668127 [info ] [MainThread]: 
[0m01:04:34.668544 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m01:04:34.669112 [debug] [MainThread]: Command end result
[0m01:04:34.678575 [debug] [MainThread]: Command `dbt show` succeeded at 01:04:34.678375 after 0.44 seconds
[0m01:04:34.678971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1DC946EA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1DC4C2690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1DCAA4650>]}
[0m01:04:34.679327 [debug] [MainThread]: Flushing usage events
[0m01:07:10.137816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016978735160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001697B36BD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001697B36B750>]}


============================== 01:07:10.141795 | c22c9dcd-07b3-4df4-95b7-fd008ce34367 ==============================
[0m01:07:10.141795 [info ] [MainThread]: Running with dbt=1.7.4
[0m01:07:10.142396 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt compile --select my_first_dbt_model.sql', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\Felli\\.code\\dbt\\canal_brasil_dbt\\logs', 'profiles_dir': 'C:\\Users\\Felli\\.dbt', 'use_colors': 'True', 'introspect': 'True', 'write_json': 'True', 'warn_error': 'None', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m01:07:10.330440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c22c9dcd-07b3-4df4-95b7-fd008ce34367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001697B2A3100>]}
[0m01:07:10.412000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c22c9dcd-07b3-4df4-95b7-fd008ce34367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001697B47D6A0>]}
[0m01:07:10.412899 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m01:07:10.420216 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m01:07:10.496204 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:07:10.496596 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:07:10.503484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c22c9dcd-07b3-4df4-95b7-fd008ce34367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001697B848950>]}
[0m01:07:10.514709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c22c9dcd-07b3-4df4-95b7-fd008ce34367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001697B246E40>]}
[0m01:07:10.515203 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m01:07:10.515890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c22c9dcd-07b3-4df4-95b7-fd008ce34367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001697B6F7CB0>]}
[0m01:07:10.517648 [info ] [MainThread]: 
[0m01:07:10.518533 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:07:10.519544 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m01:07:10.528434 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m01:07:10.528802 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m01:07:10.529096 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:07:30.690560 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "ozadowjafypabbrltwoy.supabase.co" (104.18.38.10), port 5432 failed: timeout expired
connection to server at "ozadowjafypabbrltwoy.supabase.co" (172.64.149.246), port 5432 failed: timeout expired

[0m01:07:50.708679 [debug] [ThreadPool]: Postgres adapter: Error running SQL: BEGIN
[0m01:07:50.709138 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m01:07:50.709517 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_relations_without_caching
[0m01:07:50.709820 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m01:07:50.710128 [debug] [ThreadPool]: On list_postgres_public: No close available on handle
[0m01:07:50.711867 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:07:50.712160 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m01:07:50.712561 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "ozadowjafypabbrltwoy.supabase.co" (104.18.38.10), port 5432 failed: timeout expired
  connection to server at "ozadowjafypabbrltwoy.supabase.co" (172.64.149.246), port 5432 failed: timeout expired
  
[0m01:07:50.713771 [debug] [MainThread]: Command `dbt compile` failed at 01:07:50.713626 after 40.69 seconds
[0m01:07:50.714128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001697B846000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001697B282690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001697B810890>]}
[0m01:07:50.714467 [debug] [MainThread]: Flushing usage events
[0m01:07:59.127939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEE4175160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEE6DABD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEE6DAB750>]}


============================== 01:07:59.131505 | f2aff825-83df-4d79-aa30-cfa0c9dd2a17 ==============================
[0m01:07:59.131505 [info ] [MainThread]: Running with dbt=1.7.4
[0m01:07:59.132077 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --select my_first_dbt_model', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\Felli\\.code\\dbt\\canal_brasil_dbt\\logs', 'profiles_dir': 'C:\\Users\\Felli\\.dbt', 'cache_selected_only': 'False', 'introspect': 'True', 'write_json': 'True', 'warn_error': 'None', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m01:07:59.320154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f2aff825-83df-4d79-aa30-cfa0c9dd2a17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEE6CE7100>]}
[0m01:07:59.399557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f2aff825-83df-4d79-aa30-cfa0c9dd2a17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEE6EB96A0>]}
[0m01:07:59.400399 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m01:07:59.407877 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m01:07:59.462283 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:07:59.462633 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:07:59.467709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f2aff825-83df-4d79-aa30-cfa0c9dd2a17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEE7328950>]}
[0m01:07:59.476035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f2aff825-83df-4d79-aa30-cfa0c9dd2a17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEE6C86E40>]}
[0m01:07:59.476511 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m01:07:59.477042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2aff825-83df-4d79-aa30-cfa0c9dd2a17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEE71D7CB0>]}
[0m01:07:59.478449 [info ] [MainThread]: 
[0m01:07:59.479308 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:07:59.480389 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:07:59.488877 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:07:59.489355 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:07:59.489687 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:08:19.586723 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "ozadowjafypabbrltwoy.supabase.co" (104.18.38.10), port 5432 failed: timeout expired
connection to server at "ozadowjafypabbrltwoy.supabase.co" (172.64.149.246), port 5432 failed: timeout expired

[0m01:08:39.613671 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:08:39.614073 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m01:08:39.614437 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m01:08:39.614740 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m01:08:39.615048 [debug] [ThreadPool]: On list_postgres: No close available on handle
[0m01:08:39.616189 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:08:39.616482 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m01:08:39.617047 [info ] [MainThread]: 
[0m01:08:39.617510 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 40.14 seconds (40.14s).
[0m01:08:39.618054 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "ozadowjafypabbrltwoy.supabase.co" (104.18.38.10), port 5432 failed: timeout expired
  connection to server at "ozadowjafypabbrltwoy.supabase.co" (172.64.149.246), port 5432 failed: timeout expired
  
[0m01:08:39.619169 [debug] [MainThread]: Command `dbt run` failed at 01:08:39.619023 after 40.57 seconds
[0m01:08:39.619590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEE7325D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEE6CBE690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEE72F0B90>]}
[0m01:08:39.619977 [debug] [MainThread]: Flushing usage events
[0m01:08:43.106573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024242BD5160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002424580BD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002424580B750>]}


============================== 01:08:43.110288 | c25c043a-0431-4e55-ad97-f0d793cb3e28 ==============================
[0m01:08:43.110288 [info ] [MainThread]: Running with dbt=1.7.4
[0m01:08:43.110892 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --select my_first_dbt_model', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\Felli\\.code\\dbt\\canal_brasil_dbt\\logs', 'profiles_dir': 'C:\\Users\\Felli\\.dbt', 'warn_error': 'None', 'introspect': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m01:08:43.294368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c25c043a-0431-4e55-ad97-f0d793cb3e28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024245743100>]}
[0m01:08:43.373333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c25c043a-0431-4e55-ad97-f0d793cb3e28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242459196A0>]}
[0m01:08:43.374270 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m01:08:43.382127 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m01:08:43.436620 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:08:43.436972 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:08:43.442172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c25c043a-0431-4e55-ad97-f0d793cb3e28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024245D6C950>]}
[0m01:08:43.450917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c25c043a-0431-4e55-ad97-f0d793cb3e28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242456E6E40>]}
[0m01:08:43.451460 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m01:08:43.452111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c25c043a-0431-4e55-ad97-f0d793cb3e28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024245C17CB0>]}
[0m01:08:43.453551 [info ] [MainThread]: 
[0m01:08:43.454452 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:08:43.455584 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:08:43.465142 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:08:43.465531 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:08:43.465876 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:09:03.569323 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "ozadowjafypabbrltwoy.supabase.co" (104.18.38.10), port 5432 failed: timeout expired
connection to server at "ozadowjafypabbrltwoy.supabase.co" (172.64.149.246), port 5432 failed: timeout expired

[0m01:09:23.605082 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:09:23.605470 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m01:09:23.605926 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m01:09:23.606224 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m01:09:23.606528 [debug] [ThreadPool]: On list_postgres: No close available on handle
[0m01:09:23.607643 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:09:23.607932 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m01:09:23.608226 [info ] [MainThread]: 
[0m01:09:23.608742 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 40.15 seconds (40.15s).
[0m01:09:23.609372 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "ozadowjafypabbrltwoy.supabase.co" (104.18.38.10), port 5432 failed: timeout expired
  connection to server at "ozadowjafypabbrltwoy.supabase.co" (172.64.149.246), port 5432 failed: timeout expired
  
[0m01:09:23.610561 [debug] [MainThread]: Command `dbt run` failed at 01:09:23.610423 after 40.59 seconds
[0m01:09:23.610908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024245D69D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002424571E690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024245D34B90>]}
[0m01:09:23.611244 [debug] [MainThread]: Flushing usage events
[0m01:13:44.516252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179386C5160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001793B2FBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001793B2FBC50>]}


============================== 01:13:44.519784 | 52793643-6e81-4b5a-b3b8-62e61227d8c1 ==============================
[0m01:13:44.519784 [info ] [MainThread]: Running with dbt=1.7.4
[0m01:13:44.520358 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt debug', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\Felli\\.code\\dbt\\canal_brasil_dbt\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Felli\\.dbt', 'introspect': 'True', 'write_json': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m01:13:44.520841 [info ] [MainThread]: dbt version: 1.7.4
[0m01:13:44.521212 [info ] [MainThread]: python version: 3.13.3
[0m01:13:44.521562 [info ] [MainThread]: python path: c:\Users\Felli\.code\.venv\Scripts\python.exe
[0m01:13:44.522005 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m01:13:44.604888 [info ] [MainThread]: Using profiles dir at C:\Users\Felli\.dbt
[0m01:13:44.605406 [info ] [MainThread]: Using profiles.yml file at C:\Users\Felli\.dbt\profiles.yml
[0m01:13:44.605870 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Felli\.code\dbt\canal_brasil_dbt\dbt_project.yml
[0m01:13:44.607092 [info ] [MainThread]: adapter type: postgres
[0m01:13:44.607690 [info ] [MainThread]: adapter version: 1.7.4
[0m01:13:44.708884 [info ] [MainThread]: Configuration:
[0m01:13:44.709382 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m01:13:44.709783 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m01:13:44.710164 [info ] [MainThread]: Required dependencies:
[0m01:13:44.710564 [debug] [MainThread]: Executing "git --help"
[0m01:13:44.736964 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:13:44.737399 [debug] [MainThread]: STDERR: "b''"
[0m01:13:44.737745 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m01:13:44.738135 [info ] [MainThread]: Connection:
[0m01:13:44.738605 [info ] [MainThread]:   host: ozadowjafypabbrltwoy.supabase.co
[0m01:13:44.739029 [info ] [MainThread]:   port: 5432
[0m01:13:44.739387 [info ] [MainThread]:   user: postgres
[0m01:13:44.739727 [info ] [MainThread]:   database: postgres
[0m01:13:44.740065 [info ] [MainThread]:   schema: public
[0m01:13:44.740397 [info ] [MainThread]:   connect_timeout: 10
[0m01:13:44.740736 [info ] [MainThread]:   role: None
[0m01:13:44.741069 [info ] [MainThread]:   search_path: None
[0m01:13:44.741404 [info ] [MainThread]:   keepalives_idle: 0
[0m01:13:44.741772 [info ] [MainThread]:   sslmode: None
[0m01:13:44.742111 [info ] [MainThread]:   sslcert: None
[0m01:13:44.742443 [info ] [MainThread]:   sslkey: None
[0m01:13:44.742793 [info ] [MainThread]:   sslrootcert: None
[0m01:13:44.743237 [info ] [MainThread]:   application_name: dbt
[0m01:13:44.743709 [info ] [MainThread]:   retries: 1
[0m01:13:44.744286 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m01:13:44.744878 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m01:13:44.745208 [debug] [MainThread]: Using postgres connection "debug"
[0m01:13:44.745505 [debug] [MainThread]: On debug: select 1 as id
[0m01:13:44.745790 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:14:04.854770 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "ozadowjafypabbrltwoy.supabase.co" (104.18.38.10), port 5432 failed: timeout expired
connection to server at "ozadowjafypabbrltwoy.supabase.co" (172.64.149.246), port 5432 failed: timeout expired

[0m01:14:24.877795 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m01:14:24.878184 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m01:14:24.878509 [debug] [MainThread]: On debug: No close available on handle
[0m01:14:24.878808 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m01:14:24.879322 [info ] [MainThread]: [31m1 check failed:[0m
[0m01:14:24.879804 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "ozadowjafypabbrltwoy.supabase.co" (104.18.38.10), port 5432 failed: timeout expired
  connection to server at "ozadowjafypabbrltwoy.supabase.co" (172.64.149.246), port 5432 failed: timeout expired
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m01:14:24.881118 [debug] [MainThread]: Command `dbt debug` failed at 01:14:24.880979 after 40.48 seconds
[0m01:14:24.881435 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m01:14:24.881751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001793B233490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001793B6527B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001793B3E17B0>]}
[0m01:14:24.882112 [debug] [MainThread]: Flushing usage events
[0m01:17:23.869120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE54865160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE574ABED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE574ABC50>]}


============================== 01:17:23.872718 | e3d50b01-2371-4240-831b-b2c442eb40f3 ==============================
[0m01:17:23.872718 [info ] [MainThread]: Running with dbt=1.7.4
[0m01:17:23.873285 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt debug', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\Felli\\.code\\dbt\\canal_brasil_dbt\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Felli\\.dbt', 'introspect': 'True', 'write_json': 'True', 'use_colors': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m01:17:23.873799 [info ] [MainThread]: dbt version: 1.7.4
[0m01:17:23.874178 [info ] [MainThread]: python version: 3.13.3
[0m01:17:23.874529 [info ] [MainThread]: python path: c:\Users\Felli\.code\.venv\Scripts\python.exe
[0m01:17:23.874872 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m01:17:23.954892 [info ] [MainThread]: Using profiles dir at C:\Users\Felli\.dbt
[0m01:17:23.955478 [info ] [MainThread]: Using profiles.yml file at C:\Users\Felli\.dbt\profiles.yml
[0m01:17:23.955967 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Felli\.code\dbt\canal_brasil_dbt\dbt_project.yml
[0m01:17:23.956827 [info ] [MainThread]: adapter type: postgres
[0m01:17:23.957306 [info ] [MainThread]: adapter version: 1.7.4
[0m01:17:24.027033 [info ] [MainThread]: Configuration:
[0m01:17:24.027613 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m01:17:24.028042 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m01:17:24.028478 [info ] [MainThread]: Required dependencies:
[0m01:17:24.028935 [debug] [MainThread]: Executing "git --help"
[0m01:17:24.057111 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:17:24.057532 [debug] [MainThread]: STDERR: "b''"
[0m01:17:24.057860 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m01:17:24.058315 [info ] [MainThread]: Connection:
[0m01:17:24.058856 [info ] [MainThread]:   host: ozadowjafypabbrltwoy.supabase.co
[0m01:17:24.059392 [info ] [MainThread]:   port: 5432
[0m01:17:24.059836 [info ] [MainThread]:   user: postgres
[0m01:17:24.060277 [info ] [MainThread]:   database: postgres
[0m01:17:24.060704 [info ] [MainThread]:   schema: public
[0m01:17:24.061143 [info ] [MainThread]:   connect_timeout: 10
[0m01:17:24.061586 [info ] [MainThread]:   role: None
[0m01:17:24.061985 [info ] [MainThread]:   search_path: None
[0m01:17:24.062379 [info ] [MainThread]:   keepalives_idle: 0
[0m01:17:24.062731 [info ] [MainThread]:   sslmode: None
[0m01:17:24.063121 [info ] [MainThread]:   sslcert: None
[0m01:17:24.063513 [info ] [MainThread]:   sslkey: None
[0m01:17:24.064004 [info ] [MainThread]:   sslrootcert: None
[0m01:17:24.064507 [info ] [MainThread]:   application_name: dbt
[0m01:17:24.065222 [info ] [MainThread]:   retries: 1
[0m01:17:24.065862 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m01:17:24.066450 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m01:17:24.066789 [debug] [MainThread]: Using postgres connection "debug"
[0m01:17:24.067079 [debug] [MainThread]: On debug: select 1 as id
[0m01:17:24.067360 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:17:44.166417 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "ozadowjafypabbrltwoy.supabase.co" (104.18.38.10), port 5432 failed: timeout expired
connection to server at "ozadowjafypabbrltwoy.supabase.co" (172.64.149.246), port 5432 failed: timeout expired

[0m01:18:04.182992 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m01:18:04.183363 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m01:18:04.183734 [debug] [MainThread]: On debug: No close available on handle
[0m01:18:04.184030 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m01:18:04.184515 [info ] [MainThread]: [31m1 check failed:[0m
[0m01:18:04.184997 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "ozadowjafypabbrltwoy.supabase.co" (104.18.38.10), port 5432 failed: timeout expired
  connection to server at "ozadowjafypabbrltwoy.supabase.co" (172.64.149.246), port 5432 failed: timeout expired
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m01:18:04.186347 [debug] [MainThread]: Command `dbt debug` failed at 01:18:04.186203 after 40.43 seconds
[0m01:18:04.186668 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m01:18:04.186979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE573E3490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE577127B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE575BCF30>]}
[0m01:18:04.187329 [debug] [MainThread]: Flushing usage events
[0m01:23:40.740672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248BF405160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248C204BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248C204BC50>]}


============================== 01:23:40.744591 | 7194168c-45ca-49cb-9d4d-5f5f4af34001 ==============================
[0m01:23:40.744591 [info ] [MainThread]: Running with dbt=1.7.4
[0m01:23:40.745166 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt debug', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\Felli\\.code\\dbt\\canal_brasil_dbt\\logs', 'profiles_dir': 'C:\\Users\\Felli\\.dbt', 'warn_error': 'None', 'introspect': 'True', 'write_json': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m01:23:40.745695 [info ] [MainThread]: dbt version: 1.7.4
[0m01:23:40.746071 [info ] [MainThread]: python version: 3.13.3
[0m01:23:40.746422 [info ] [MainThread]: python path: c:\Users\Felli\.code\.venv\Scripts\python.exe
[0m01:23:40.746770 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m01:23:40.837108 [info ] [MainThread]: Using profiles dir at C:\Users\Felli\.dbt
[0m01:23:40.837788 [info ] [MainThread]: Using profiles.yml file at C:\Users\Felli\.dbt\profiles.yml
[0m01:23:40.838399 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Felli\.code\dbt\canal_brasil_dbt\dbt_project.yml
[0m01:23:40.839494 [info ] [MainThread]: adapter type: postgres
[0m01:23:40.840039 [info ] [MainThread]: adapter version: 1.7.4
[0m01:23:40.916679 [info ] [MainThread]: Configuration:
[0m01:23:40.917189 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m01:23:40.917603 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m01:23:40.918009 [info ] [MainThread]: Required dependencies:
[0m01:23:40.918428 [debug] [MainThread]: Executing "git --help"
[0m01:23:40.949567 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:23:40.949995 [debug] [MainThread]: STDERR: "b''"
[0m01:23:40.950339 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m01:23:40.950740 [info ] [MainThread]: Connection:
[0m01:23:40.951160 [info ] [MainThread]:   host: localhost
[0m01:23:40.951523 [info ] [MainThread]:   port: 5432
[0m01:23:40.951857 [info ] [MainThread]:   user: postgres
[0m01:23:40.952185 [info ] [MainThread]:   database: postgres
[0m01:23:40.952552 [info ] [MainThread]:   schema: public
[0m01:23:40.952898 [info ] [MainThread]:   connect_timeout: 10
[0m01:23:40.953237 [info ] [MainThread]:   role: None
[0m01:23:40.953569 [info ] [MainThread]:   search_path: None
[0m01:23:40.953902 [info ] [MainThread]:   keepalives_idle: 0
[0m01:23:40.954238 [info ] [MainThread]:   sslmode: None
[0m01:23:40.954580 [info ] [MainThread]:   sslcert: None
[0m01:23:40.954927 [info ] [MainThread]:   sslkey: None
[0m01:23:40.955268 [info ] [MainThread]:   sslrootcert: None
[0m01:23:40.955606 [info ] [MainThread]:   application_name: dbt
[0m01:23:40.955962 [info ] [MainThread]:   retries: 1
[0m01:23:40.956464 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m01:23:40.957202 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m01:23:40.957725 [debug] [MainThread]: Using postgres connection "debug"
[0m01:23:40.958078 [debug] [MainThread]: On debug: select 1 as id
[0m01:23:40.958386 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:23:45.024630 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?

[0m01:23:49.078730 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m01:23:49.079123 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m01:23:49.079628 [debug] [MainThread]: On debug: No close available on handle
[0m01:23:49.079954 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m01:23:49.080474 [info ] [MainThread]: [31m1 check failed:[0m
[0m01:23:49.080953 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
  	Is the server running on that host and accepting TCP/IP connections?
  connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused (0x0000274D/10061)
  	Is the server running on that host and accepting TCP/IP connections?
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m01:23:49.082248 [debug] [MainThread]: Command `dbt debug` failed at 01:23:49.082102 after 8.42 seconds
[0m01:23:49.082571 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m01:23:49.082942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248C1F83490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248C23467B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248C2161480>]}
[0m01:23:49.083295 [debug] [MainThread]: Flushing usage events
[0m01:25:37.915180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002241D1D5160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002241FE1BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002241FE1BC50>]}


============================== 01:25:37.919974 | de584bc6-eea1-40ad-a02e-7eead54c95c7 ==============================
[0m01:25:37.919974 [info ] [MainThread]: Running with dbt=1.7.4
[0m01:25:37.920682 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt debug', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\Felli\\.code\\dbt\\canal_brasil_dbt\\logs', 'profiles_dir': 'C:\\Users\\Felli\\.dbt', 'warn_error': 'None', 'introspect': 'True', 'use_colors': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m01:25:37.921294 [info ] [MainThread]: dbt version: 1.7.4
[0m01:25:37.921843 [info ] [MainThread]: python version: 3.13.3
[0m01:25:37.922348 [info ] [MainThread]: python path: c:\Users\Felli\.code\.venv\Scripts\python.exe
[0m01:25:37.922815 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m01:25:38.042376 [info ] [MainThread]: Using profiles dir at C:\Users\Felli\.dbt
[0m01:25:38.043096 [info ] [MainThread]: Using profiles.yml file at C:\Users\Felli\.dbt\profiles.yml
[0m01:25:38.043943 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Felli\.code\dbt\canal_brasil_dbt\dbt_project.yml
[0m01:25:38.044910 [info ] [MainThread]: adapter type: postgres
[0m01:25:38.045459 [info ] [MainThread]: adapter version: 1.7.4
[0m01:25:38.132875 [info ] [MainThread]: Configuration:
[0m01:25:38.133515 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m01:25:38.134240 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m01:25:38.134754 [info ] [MainThread]: Required dependencies:
[0m01:25:38.135240 [debug] [MainThread]: Executing "git --help"
[0m01:25:38.165943 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:25:38.166435 [debug] [MainThread]: STDERR: "b''"
[0m01:25:38.166809 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m01:25:38.167220 [info ] [MainThread]: Connection:
[0m01:25:38.167665 [info ] [MainThread]:   host: ozadowjafypabbrltwoy.supabase.co
[0m01:25:38.168080 [info ] [MainThread]:   port: 5432
[0m01:25:38.168487 [info ] [MainThread]:   user: postgres
[0m01:25:38.168897 [info ] [MainThread]:   database: postgres
[0m01:25:38.169310 [info ] [MainThread]:   schema: public
[0m01:25:38.169682 [info ] [MainThread]:   connect_timeout: 10
[0m01:25:38.170126 [info ] [MainThread]:   role: None
[0m01:25:38.170550 [info ] [MainThread]:   search_path: None
[0m01:25:38.170985 [info ] [MainThread]:   keepalives_idle: 0
[0m01:25:38.171462 [info ] [MainThread]:   sslmode: None
[0m01:25:38.172344 [info ] [MainThread]:   sslcert: None
[0m01:25:38.173195 [info ] [MainThread]:   sslkey: None
[0m01:25:38.174030 [info ] [MainThread]:   sslrootcert: None
[0m01:25:38.175137 [info ] [MainThread]:   application_name: dbt
[0m01:25:38.175708 [info ] [MainThread]:   retries: 1
[0m01:25:38.176343 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m01:25:38.177017 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m01:25:38.177434 [debug] [MainThread]: Using postgres connection "debug"
[0m01:25:38.177780 [debug] [MainThread]: On debug: select 1 as id
[0m01:25:38.178136 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:25:58.292610 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "ozadowjafypabbrltwoy.supabase.co" (172.64.149.246), port 5432 failed: timeout expired
connection to server at "ozadowjafypabbrltwoy.supabase.co" (104.18.38.10), port 5432 failed: timeout expired

[0m01:26:18.323273 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m01:26:18.323660 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m01:26:18.324001 [debug] [MainThread]: On debug: No close available on handle
[0m01:26:18.324310 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m01:26:18.324789 [info ] [MainThread]: [31m1 check failed:[0m
[0m01:26:18.325268 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "ozadowjafypabbrltwoy.supabase.co" (172.64.149.246), port 5432 failed: timeout expired
  connection to server at "ozadowjafypabbrltwoy.supabase.co" (104.18.38.10), port 5432 failed: timeout expired
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m01:26:18.326559 [debug] [MainThread]: Command `dbt debug` failed at 01:26:18.326397 after 40.54 seconds
[0m01:26:18.326899 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m01:26:18.327243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002241FD53490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224201267B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002241FF2CF30>]}
[0m01:26:18.327609 [debug] [MainThread]: Flushing usage events
[0m01:29:32.490271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C75D85160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C789BBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C789BBC50>]}


============================== 01:29:32.494019 | 46199c59-e065-4b8e-a46d-c62943f5e996 ==============================
[0m01:29:32.494019 [info ] [MainThread]: Running with dbt=1.7.4
[0m01:29:32.494708 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt debug', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\Felli\\.code\\dbt\\canal_brasil_dbt\\logs', 'warn_error': 'None', 'cache_selected_only': 'False', 'introspect': 'True', 'profiles_dir': 'C:\\Users\\Felli\\.dbt', 'write_json': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m01:29:32.495304 [info ] [MainThread]: dbt version: 1.7.4
[0m01:29:32.495824 [info ] [MainThread]: python version: 3.13.3
[0m01:29:32.496303 [info ] [MainThread]: python path: c:\Users\Felli\.code\.venv\Scripts\python.exe
[0m01:29:32.496773 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m01:29:32.578879 [info ] [MainThread]: Using profiles dir at C:\Users\Felli\.dbt
[0m01:29:32.579426 [info ] [MainThread]: Using profiles.yml file at C:\Users\Felli\.dbt\profiles.yml
[0m01:29:32.579884 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Felli\.code\dbt\canal_brasil_dbt\dbt_project.yml
[0m01:29:32.580715 [info ] [MainThread]: adapter type: postgres
[0m01:29:32.581174 [info ] [MainThread]: adapter version: 1.7.4
[0m01:29:32.582297 [info ] [MainThread]: Configuration:
[0m01:29:32.582732 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m01:29:32.583158 [info ] [MainThread]:   dbt_project.yml file [[31mERROR invalid[0m]
[0m01:29:32.583572 [info ] [MainThread]: Required dependencies:
[0m01:29:32.584113 [debug] [MainThread]: Executing "git --help"
[0m01:29:32.611366 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:29:32.611827 [debug] [MainThread]: STDERR: "b''"
[0m01:29:32.612176 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m01:29:32.612594 [info ] [MainThread]: Connection:
[0m01:29:32.613006 [info ] [MainThread]:   host: ozadowjafypabbrltwoy.supabase.co
[0m01:29:32.613359 [info ] [MainThread]:   port: 5432
[0m01:29:32.613733 [info ] [MainThread]:   user: postgres
[0m01:29:32.614100 [info ] [MainThread]:   database: postgres
[0m01:29:32.614447 [info ] [MainThread]:   schema: public
[0m01:29:32.614796 [info ] [MainThread]:   connect_timeout: 10
[0m01:29:32.615143 [info ] [MainThread]:   role: None
[0m01:29:32.615482 [info ] [MainThread]:   search_path: None
[0m01:29:32.615821 [info ] [MainThread]:   keepalives_idle: 0
[0m01:29:32.616159 [info ] [MainThread]:   sslmode: None
[0m01:29:32.616499 [info ] [MainThread]:   sslcert: None
[0m01:29:32.616837 [info ] [MainThread]:   sslkey: None
[0m01:29:32.617244 [info ] [MainThread]:   sslrootcert: None
[0m01:29:32.617922 [info ] [MainThread]:   application_name: dbt
[0m01:29:32.618730 [info ] [MainThread]:   retries: 1
[0m01:29:32.619422 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m01:29:32.620353 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m01:29:32.620776 [debug] [MainThread]: Using postgres connection "debug"
[0m01:29:32.621110 [debug] [MainThread]: On debug: select 1 as id
[0m01:29:32.621404 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:29:52.704958 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "ozadowjafypabbrltwoy.supabase.co" (172.64.149.246), port 5432 failed: timeout expired
connection to server at "ozadowjafypabbrltwoy.supabase.co" (104.18.38.10), port 5432 failed: timeout expired

[0m01:30:12.730443 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m01:30:12.730826 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m01:30:12.731142 [debug] [MainThread]: On debug: No close available on handle
[0m01:30:12.731437 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m01:30:12.731941 [info ] [MainThread]: [31m2 checks failed:[0m
[0m01:30:12.732557 [info ] [MainThread]: Project loading failed for the following reason:
Runtime Error
  Required "name" field not present in project

Error encountered in C:\Users\Felli\.code\dbt\canal_brasil_dbt\dbt_project.yml


[0m01:30:12.733144 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "ozadowjafypabbrltwoy.supabase.co" (172.64.149.246), port 5432 failed: timeout expired
  connection to server at "ozadowjafypabbrltwoy.supabase.co" (104.18.38.10), port 5432 failed: timeout expired
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m01:30:12.734748 [debug] [MainThread]: Command `dbt debug` failed at 01:30:12.734555 after 40.40 seconds
[0m01:30:12.735112 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m01:30:12.735436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C788F3490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C78B9D130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C78AB45A0>]}
[0m01:30:12.735793 [debug] [MainThread]: Flushing usage events
[0m01:32:14.361640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FBCCE5160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FBF91BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FBF91BC50>]}


============================== 01:32:14.365272 | 8c23a392-f3a6-48ec-b5f0-d7dfd2086f88 ==============================
[0m01:32:14.365272 [info ] [MainThread]: Running with dbt=1.7.4
[0m01:32:14.365848 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt debug', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\Felli\\.code\\dbt\\canal_brasil_dbt\\logs', 'warn_error': 'None', 'use_colors': 'True', 'introspect': 'True', 'profiles_dir': 'C:\\Users\\Felli\\.dbt', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m01:32:14.366340 [info ] [MainThread]: dbt version: 1.7.4
[0m01:32:14.366751 [info ] [MainThread]: python version: 3.13.3
[0m01:32:14.367151 [info ] [MainThread]: python path: c:\Users\Felli\.code\.venv\Scripts\python.exe
[0m01:32:14.367559 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m01:32:14.449128 [info ] [MainThread]: Using profiles dir at C:\Users\Felli\.dbt
[0m01:32:14.449648 [info ] [MainThread]: Using profiles.yml file at C:\Users\Felli\.dbt\profiles.yml
[0m01:32:14.450179 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Felli\.code\dbt\canal_brasil_dbt\dbt_project.yml
[0m01:32:14.451045 [info ] [MainThread]: adapter type: postgres
[0m01:32:14.451502 [info ] [MainThread]: adapter version: 1.7.4
[0m01:32:14.453112 [info ] [MainThread]: Configuration:
[0m01:32:14.453594 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m01:32:14.454030 [info ] [MainThread]:   dbt_project.yml file [[31mERROR invalid[0m]
[0m01:32:14.454436 [info ] [MainThread]: Required dependencies:
[0m01:32:14.454895 [debug] [MainThread]: Executing "git --help"
[0m01:32:14.481216 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:32:14.481688 [debug] [MainThread]: STDERR: "b''"
[0m01:32:14.482113 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m01:32:14.482692 [info ] [MainThread]: Connection:
[0m01:32:14.483369 [info ] [MainThread]:   host: ozadowjafypabbrltwoy.supabase.co
[0m01:32:14.483990 [info ] [MainThread]:   port: 5432
[0m01:32:14.484562 [info ] [MainThread]:   user: postgres
[0m01:32:14.485037 [info ] [MainThread]:   database: postgres
[0m01:32:14.485515 [info ] [MainThread]:   schema: public
[0m01:32:14.485928 [info ] [MainThread]:   connect_timeout: 60
[0m01:32:14.486393 [info ] [MainThread]:   role: None
[0m01:32:14.486927 [info ] [MainThread]:   search_path: None
[0m01:32:14.487400 [info ] [MainThread]:   keepalives_idle: 0
[0m01:32:14.487824 [info ] [MainThread]:   sslmode: require
[0m01:32:14.488281 [info ] [MainThread]:   sslcert: None
[0m01:32:14.488737 [info ] [MainThread]:   sslkey: None
[0m01:32:14.489164 [info ] [MainThread]:   sslrootcert: None
[0m01:32:14.489584 [info ] [MainThread]:   application_name: dbt
[0m01:32:14.489976 [info ] [MainThread]:   retries: 1
[0m01:32:14.490422 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m01:32:14.490948 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m01:32:14.491268 [debug] [MainThread]: Using postgres connection "debug"
[0m01:32:14.491565 [debug] [MainThread]: On debug: select 1 as id
[0m01:32:14.491852 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:32:56.742793 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "ozadowjafypabbrltwoy.supabase.co" (172.64.149.246), port 5432 failed: Connection timed out (0x0000274C/10060)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "ozadowjafypabbrltwoy.supabase.co" (104.18.38.10), port 5432 failed: Connection timed out (0x0000274C/10060)
	Is the server running on that host and accepting TCP/IP connections?

[0m01:33:38.919150 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m01:33:38.919537 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m01:33:38.919900 [debug] [MainThread]: On debug: No close available on handle
[0m01:33:38.920212 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m01:33:38.920746 [info ] [MainThread]: [31m2 checks failed:[0m
[0m01:33:38.921320 [info ] [MainThread]: Project loading failed for the following reason:
Runtime Error
  Required "name" field not present in project

Error encountered in C:\Users\Felli\.code\dbt\canal_brasil_dbt\dbt_project.yml


[0m01:33:38.921861 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "ozadowjafypabbrltwoy.supabase.co" (172.64.149.246), port 5432 failed: Connection timed out (0x0000274C/10060)
  	Is the server running on that host and accepting TCP/IP connections?
  connection to server at "ozadowjafypabbrltwoy.supabase.co" (104.18.38.10), port 5432 failed: Connection timed out (0x0000274C/10060)
  	Is the server running on that host and accepting TCP/IP connections?
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m01:33:38.923471 [debug] [MainThread]: Command `dbt debug` failed at 01:33:38.923308 after 84.68 seconds
[0m01:33:38.923813 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m01:33:38.924134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FBF8535C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FBFB3D130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FBFA08C00>]}
[0m01:33:38.924494 [debug] [MainThread]: Flushing usage events
[0m01:33:46.748874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E651855160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E65449BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E65449BC50>]}


============================== 01:33:46.752830 | 5de44daa-8ffb-4d43-a73c-fd7fc7b69f34 ==============================
[0m01:33:46.752830 [info ] [MainThread]: Running with dbt=1.7.4
[0m01:33:46.753509 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt debug', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\Felli\\.code\\dbt\\canal_brasil_dbt\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Felli\\.dbt', 'introspect': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m01:33:46.754009 [info ] [MainThread]: dbt version: 1.7.4
[0m01:33:46.754485 [info ] [MainThread]: python version: 3.13.3
[0m01:33:46.754950 [info ] [MainThread]: python path: c:\Users\Felli\.code\.venv\Scripts\python.exe
[0m01:33:46.755413 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m01:33:46.836580 [info ] [MainThread]: Using profiles dir at C:\Users\Felli\.dbt
[0m01:33:46.837117 [info ] [MainThread]: Using profiles.yml file at C:\Users\Felli\.dbt\profiles.yml
[0m01:33:46.837563 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Felli\.code\dbt\canal_brasil_dbt\dbt_project.yml
[0m01:33:46.838475 [info ] [MainThread]: adapter type: postgres
[0m01:33:46.838981 [info ] [MainThread]: adapter version: 1.7.4
[0m01:33:46.909247 [info ] [MainThread]: Configuration:
[0m01:33:46.909788 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m01:33:46.910252 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m01:33:46.910721 [info ] [MainThread]: Required dependencies:
[0m01:33:46.911217 [debug] [MainThread]: Executing "git --help"
[0m01:33:46.938468 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:33:46.938921 [debug] [MainThread]: STDERR: "b''"
[0m01:33:46.939267 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m01:33:46.939694 [info ] [MainThread]: Connection:
[0m01:33:46.940151 [info ] [MainThread]:   host: ozadowjafypabbrltwoy.supabase.co
[0m01:33:46.940555 [info ] [MainThread]:   port: 5432
[0m01:33:46.940899 [info ] [MainThread]:   user: postgres
[0m01:33:46.941228 [info ] [MainThread]:   database: postgres
[0m01:33:46.941554 [info ] [MainThread]:   schema: public
[0m01:33:46.941877 [info ] [MainThread]:   connect_timeout: 60
[0m01:33:46.942201 [info ] [MainThread]:   role: None
[0m01:33:46.942522 [info ] [MainThread]:   search_path: None
[0m01:33:46.942857 [info ] [MainThread]:   keepalives_idle: 0
[0m01:33:46.943189 [info ] [MainThread]:   sslmode: require
[0m01:33:46.943515 [info ] [MainThread]:   sslcert: None
[0m01:33:46.943840 [info ] [MainThread]:   sslkey: None
[0m01:33:46.944164 [info ] [MainThread]:   sslrootcert: None
[0m01:33:46.944488 [info ] [MainThread]:   application_name: dbt
[0m01:33:46.944836 [info ] [MainThread]:   retries: 1
[0m01:33:46.945653 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m01:33:46.946397 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m01:33:46.946773 [debug] [MainThread]: Using postgres connection "debug"
[0m01:33:46.947115 [debug] [MainThread]: On debug: select 1 as id
[0m01:33:46.947482 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:34:29.179733 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "ozadowjafypabbrltwoy.supabase.co" (172.64.149.246), port 5432 failed: Connection timed out (0x0000274C/10060)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "ozadowjafypabbrltwoy.supabase.co" (104.18.38.10), port 5432 failed: Connection timed out (0x0000274C/10060)
	Is the server running on that host and accepting TCP/IP connections?

[0m01:34:38.887092 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m01:34:38.887692 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m01:34:38.888237 [debug] [MainThread]: On debug: No close available on handle
[0m01:34:38.888842 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m01:34:38.894919 [info ] [MainThread]: [31m1 check failed:[0m
[0m01:34:38.899743 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "ozadowjafypabbrltwoy.supabase.co" (172.64.149.246), port 5432 failed: Software caused connection abort (0x00002745/10053)
  	Is the server running on that host and accepting TCP/IP connections?
  connection to server at "ozadowjafypabbrltwoy.supabase.co" (104.18.38.10), port 5432 failed: Network is unreachable (0x00002743/10051)
  	Is the server running on that host and accepting TCP/IP connections?
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m01:34:38.905079 [debug] [MainThread]: Command `dbt debug` failed at 01:34:38.904762 after 52.28 seconds
[0m01:34:38.905712 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m01:34:38.906319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E6543D3490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E6547027B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E654538D10>]}
[0m01:34:38.907095 [debug] [MainThread]: Flushing usage events
[0m01:34:38.935085 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m01:35:38.152235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219B0AC5160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219B36FBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219B36FBC50>]}


============================== 01:35:38.156399 | e10d9fe2-349c-41c9-82e9-ef7bcc030749 ==============================
[0m01:35:38.156399 [info ] [MainThread]: Running with dbt=1.7.4
[0m01:35:38.157004 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt debug', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\Felli\\.code\\dbt\\canal_brasil_dbt\\logs', 'warn_error': 'None', 'use_colors': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Felli\\.dbt', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m01:35:38.157511 [info ] [MainThread]: dbt version: 1.7.4
[0m01:35:38.157920 [info ] [MainThread]: python version: 3.13.3
[0m01:35:38.158338 [info ] [MainThread]: python path: c:\Users\Felli\.code\.venv\Scripts\python.exe
[0m01:35:38.158746 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m01:35:38.361598 [info ] [MainThread]: Using profiles dir at C:\Users\Felli\.dbt
[0m01:35:38.362178 [info ] [MainThread]: Using profiles.yml file at C:\Users\Felli\.dbt\profiles.yml
[0m01:35:38.362688 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Felli\.code\dbt\canal_brasil_dbt\dbt_project.yml
[0m01:35:38.363928 [info ] [MainThread]: adapter type: postgres
[0m01:35:38.364415 [info ] [MainThread]: adapter version: 1.7.4
[0m01:35:38.436408 [info ] [MainThread]: Configuration:
[0m01:35:38.436940 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m01:35:38.437420 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m01:35:38.437871 [info ] [MainThread]: Required dependencies:
[0m01:35:38.438337 [debug] [MainThread]: Executing "git --help"
[0m01:35:38.465863 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:35:38.466322 [debug] [MainThread]: STDERR: "b''"
[0m01:35:38.466665 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m01:35:38.467107 [info ] [MainThread]: Connection:
[0m01:35:38.467590 [info ] [MainThread]:   host: ozadowjafypabbrltwoy.supabase.co
[0m01:35:38.468038 [info ] [MainThread]:   port: 5432
[0m01:35:38.468429 [info ] [MainThread]:   user: postgres
[0m01:35:38.468880 [info ] [MainThread]:   database: postgres
[0m01:35:38.469347 [info ] [MainThread]:   schema: public
[0m01:35:38.469791 [info ] [MainThread]:   connect_timeout: 60
[0m01:35:38.470219 [info ] [MainThread]:   role: None
[0m01:35:38.470667 [info ] [MainThread]:   search_path: None
[0m01:35:38.471114 [info ] [MainThread]:   keepalives_idle: 0
[0m01:35:38.471532 [info ] [MainThread]:   sslmode: require
[0m01:35:38.472006 [info ] [MainThread]:   sslcert: None
[0m01:35:38.472631 [info ] [MainThread]:   sslkey: None
[0m01:35:38.473123 [info ] [MainThread]:   sslrootcert: None
[0m01:35:38.473643 [info ] [MainThread]:   application_name: dbt
[0m01:35:38.474078 [info ] [MainThread]:   retries: 1
[0m01:35:38.474536 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m01:35:38.475063 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m01:35:38.475378 [debug] [MainThread]: Using postgres connection "debug"
[0m01:35:38.475680 [debug] [MainThread]: On debug: select 1 as id
[0m01:35:38.475974 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:36:20.646858 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "ozadowjafypabbrltwoy.supabase.co" (172.64.149.246), port 5432 failed: Connection timed out (0x0000274C/10060)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "ozadowjafypabbrltwoy.supabase.co" (104.18.38.10), port 5432 failed: Connection timed out (0x0000274C/10060)
	Is the server running on that host and accepting TCP/IP connections?

[0m01:37:02.781999 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m01:37:02.782387 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m01:37:02.782709 [debug] [MainThread]: On debug: No close available on handle
[0m01:37:02.783013 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m01:37:02.783530 [info ] [MainThread]: [31m1 check failed:[0m
[0m01:37:02.784024 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "ozadowjafypabbrltwoy.supabase.co" (172.64.149.246), port 5432 failed: Connection timed out (0x0000274C/10060)
  	Is the server running on that host and accepting TCP/IP connections?
  connection to server at "ozadowjafypabbrltwoy.supabase.co" (104.18.38.10), port 5432 failed: Connection timed out (0x0000274C/10060)
  	Is the server running on that host and accepting TCP/IP connections?
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m01:37:02.785521 [debug] [MainThread]: Command `dbt debug` failed at 01:37:02.785309 after 84.74 seconds
[0m01:37:02.785867 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m01:37:02.786193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219B3633490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219B39727B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219B3798D10>]}
[0m01:37:02.786568 [debug] [MainThread]: Flushing usage events
[0m01:37:27.783780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017263F25160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017266B5BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017266B5BC50>]}


============================== 01:37:27.791182 | 4e1475ef-982f-430e-a30e-0aa0a0f9199f ==============================
[0m01:37:27.791182 [info ] [MainThread]: Running with dbt=1.7.4
[0m01:37:27.792235 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt debug', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\Felli\\.code\\dbt\\canal_brasil_dbt\\logs', 'warn_error': 'None', 'use_colors': 'True', 'introspect': 'True', 'write_json': 'True', 'profiles_dir': 'C:\\Users\\Felli\\.dbt', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m01:37:27.793115 [info ] [MainThread]: dbt version: 1.7.4
[0m01:37:27.793775 [info ] [MainThread]: python version: 3.13.3
[0m01:37:27.794434 [info ] [MainThread]: python path: c:\Users\Felli\.code\.venv\Scripts\python.exe
[0m01:37:27.795051 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m01:37:27.897458 [info ] [MainThread]: Using profiles dir at C:\Users\Felli\.dbt
[0m01:37:27.898024 [info ] [MainThread]: Using profiles.yml file at C:\Users\Felli\.dbt\profiles.yml
[0m01:37:27.898435 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Felli\.code\dbt\canal_brasil_dbt\dbt_project.yml
[0m01:37:27.899502 [info ] [MainThread]: adapter type: postgres
[0m01:37:27.900020 [info ] [MainThread]: adapter version: 1.7.4
[0m01:37:27.970628 [info ] [MainThread]: Configuration:
[0m01:37:27.971151 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m01:37:27.971522 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m01:37:27.971939 [info ] [MainThread]: Required dependencies:
[0m01:37:27.972364 [debug] [MainThread]: Executing "git --help"
[0m01:37:27.999262 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:37:27.999695 [debug] [MainThread]: STDERR: "b''"
[0m01:37:28.000040 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m01:37:28.000515 [info ] [MainThread]: Connection:
[0m01:37:28.000958 [info ] [MainThread]:   host: ozadowjafypabbrltwoy.supabase.co
[0m01:37:28.001453 [info ] [MainThread]:   port: 5432
[0m01:37:28.001868 [info ] [MainThread]:   user: postgres
[0m01:37:28.002257 [info ] [MainThread]:   database: postgres
[0m01:37:28.002727 [info ] [MainThread]:   schema: public
[0m01:37:28.003244 [info ] [MainThread]:   connect_timeout: 10
[0m01:37:28.003748 [info ] [MainThread]:   role: None
[0m01:37:28.004180 [info ] [MainThread]:   search_path: None
[0m01:37:28.004608 [info ] [MainThread]:   keepalives_idle: 0
[0m01:37:28.005063 [info ] [MainThread]:   sslmode: None
[0m01:37:28.005489 [info ] [MainThread]:   sslcert: None
[0m01:37:28.005896 [info ] [MainThread]:   sslkey: None
[0m01:37:28.006290 [info ] [MainThread]:   sslrootcert: None
[0m01:37:28.006738 [info ] [MainThread]:   application_name: dbt
[0m01:37:28.007175 [info ] [MainThread]:   retries: 1
[0m01:37:28.007644 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m01:37:28.008264 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m01:37:28.008600 [debug] [MainThread]: Using postgres connection "debug"
[0m01:37:28.008901 [debug] [MainThread]: On debug: select 1 as id
[0m01:37:28.009187 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:37:48.074795 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "ozadowjafypabbrltwoy.supabase.co" (172.64.149.246), port 5432 failed: timeout expired
connection to server at "ozadowjafypabbrltwoy.supabase.co" (104.18.38.10), port 5432 failed: timeout expired

[0m01:38:08.080186 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m01:38:08.080570 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m01:38:08.080950 [debug] [MainThread]: On debug: No close available on handle
[0m01:38:08.081253 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m01:38:08.081752 [info ] [MainThread]: [31m1 check failed:[0m
[0m01:38:08.082221 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "ozadowjafypabbrltwoy.supabase.co" (172.64.149.246), port 5432 failed: timeout expired
  connection to server at "ozadowjafypabbrltwoy.supabase.co" (104.18.38.10), port 5432 failed: timeout expired
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m01:38:08.083695 [debug] [MainThread]: Command `dbt debug` failed at 01:38:08.083535 after 40.43 seconds
[0m01:38:08.084029 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m01:38:08.084349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017266A93490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017266E727B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017266C6CF30>]}
[0m01:38:08.084709 [debug] [MainThread]: Flushing usage events
[0m01:39:11.343676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F8C8B5160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F8F4FBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F8F4FBC50>]}


============================== 01:39:11.347727 | a6bee66c-477d-41b1-ba64-f498dec7aa2f ==============================
[0m01:39:11.347727 [info ] [MainThread]: Running with dbt=1.7.4
[0m01:39:11.348315 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt debug', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\Felli\\.code\\dbt\\canal_brasil_dbt\\logs', 'warn_error': 'None', 'use_colors': 'True', 'introspect': 'True', 'profiles_dir': 'C:\\Users\\Felli\\.dbt', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m01:39:11.348838 [info ] [MainThread]: dbt version: 1.7.4
[0m01:39:11.349263 [info ] [MainThread]: python version: 3.13.3
[0m01:39:11.349624 [info ] [MainThread]: python path: c:\Users\Felli\.code\.venv\Scripts\python.exe
[0m01:39:11.350061 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m01:39:11.439511 [info ] [MainThread]: Using profiles dir at C:\Users\Felli\.dbt
[0m01:39:11.440059 [info ] [MainThread]: Using profiles.yml file at C:\Users\Felli\.dbt\profiles.yml
[0m01:39:11.440534 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Felli\.code\dbt\canal_brasil_dbt\dbt_project.yml
[0m01:39:11.441533 [info ] [MainThread]: adapter type: postgres
[0m01:39:11.441919 [info ] [MainThread]: adapter version: 1.7.4
[0m01:39:11.514449 [info ] [MainThread]: Configuration:
[0m01:39:11.514964 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m01:39:11.515375 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m01:39:11.515816 [info ] [MainThread]: Required dependencies:
[0m01:39:11.516273 [debug] [MainThread]: Executing "git --help"
[0m01:39:11.584860 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:39:11.585696 [debug] [MainThread]: STDERR: "b''"
[0m01:39:11.586233 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m01:39:11.586752 [info ] [MainThread]: Connection:
[0m01:39:11.587220 [info ] [MainThread]:   host: ozadowjafypabbrltwoy.supabase.co
[0m01:39:11.587664 [info ] [MainThread]:   port: 5432
[0m01:39:11.588187 [info ] [MainThread]:   user: postgres
[0m01:39:11.588686 [info ] [MainThread]:   database: postgres
[0m01:39:11.589172 [info ] [MainThread]:   schema: public
[0m01:39:11.589653 [info ] [MainThread]:   connect_timeout: 60
[0m01:39:11.590155 [info ] [MainThread]:   role: None
[0m01:39:11.590755 [info ] [MainThread]:   search_path: None
[0m01:39:11.591329 [info ] [MainThread]:   keepalives_idle: 0
[0m01:39:11.591884 [info ] [MainThread]:   sslmode: require
[0m01:39:11.592338 [info ] [MainThread]:   sslcert: None
[0m01:39:11.592780 [info ] [MainThread]:   sslkey: None
[0m01:39:11.593178 [info ] [MainThread]:   sslrootcert: None
[0m01:39:11.593540 [info ] [MainThread]:   application_name: dbt
[0m01:39:11.593937 [info ] [MainThread]:   retries: 1
[0m01:39:11.594367 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m01:39:11.594855 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m01:39:11.595218 [debug] [MainThread]: Using postgres connection "debug"
[0m01:39:11.595569 [debug] [MainThread]: On debug: select 1 as id
[0m01:39:11.595866 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:39:53.752891 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "ozadowjafypabbrltwoy.supabase.co" (172.64.149.246), port 5432 failed: Connection timed out (0x0000274C/10060)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "ozadowjafypabbrltwoy.supabase.co" (104.18.38.10), port 5432 failed: Connection timed out (0x0000274C/10060)
	Is the server running on that host and accepting TCP/IP connections?

[0m01:40:36.055746 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m01:40:36.056157 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m01:40:36.056507 [debug] [MainThread]: On debug: No close available on handle
[0m01:40:36.056849 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m01:40:36.057333 [info ] [MainThread]: [31m1 check failed:[0m
[0m01:40:36.057823 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "ozadowjafypabbrltwoy.supabase.co" (172.64.149.246), port 5432 failed: Connection timed out (0x0000274C/10060)
  	Is the server running on that host and accepting TCP/IP connections?
  connection to server at "ozadowjafypabbrltwoy.supabase.co" (104.18.38.10), port 5432 failed: Connection timed out (0x0000274C/10060)
  	Is the server running on that host and accepting TCP/IP connections?
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m01:40:36.059245 [debug] [MainThread]: Command `dbt debug` failed at 01:40:36.059057 after 84.83 seconds
[0m01:40:36.059625 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m01:40:36.059971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F8F433490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F8F7F67B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F8F594D10>]}
[0m01:40:36.060369 [debug] [MainThread]: Flushing usage events
[0m01:45:27.138378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4B1275160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4B3EBBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4B3EBBC50>]}


============================== 01:45:27.142216 | ef0fb19a-877e-48a0-84bb-0e8c8a4ecc4e ==============================
[0m01:45:27.142216 [info ] [MainThread]: Running with dbt=1.7.4
[0m01:45:27.142788 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt debug', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\Felli\\.code\\dbt\\canal_brasil_dbt\\logs', 'profiles_dir': 'C:\\Users\\Felli\\.dbt', 'warn_error': 'None', 'introspect': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m01:45:27.143326 [info ] [MainThread]: dbt version: 1.7.4
[0m01:45:27.143783 [info ] [MainThread]: python version: 3.13.3
[0m01:45:27.144302 [info ] [MainThread]: python path: c:\Users\Felli\.code\.venv\Scripts\python.exe
[0m01:45:27.144791 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m01:45:27.231237 [info ] [MainThread]: Using profiles dir at C:\Users\Felli\.dbt
[0m01:45:27.231783 [info ] [MainThread]: Using profiles.yml file at C:\Users\Felli\.dbt\profiles.yml
[0m01:45:27.232228 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Felli\.code\dbt\canal_brasil_dbt\dbt_project.yml
[0m01:45:27.233328 [info ] [MainThread]: adapter type: postgres
[0m01:45:27.233768 [info ] [MainThread]: adapter version: 1.7.4
[0m01:45:27.304607 [info ] [MainThread]: Configuration:
[0m01:45:27.305165 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m01:45:27.305617 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m01:45:27.306052 [info ] [MainThread]: Required dependencies:
[0m01:45:27.306516 [debug] [MainThread]: Executing "git --help"
[0m01:45:27.333366 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:45:27.333796 [debug] [MainThread]: STDERR: "b''"
[0m01:45:27.334142 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m01:45:27.334599 [info ] [MainThread]: Connection:
[0m01:45:27.335071 [info ] [MainThread]:   host: aws-0-sa-east-1.pooler.supabase.com
[0m01:45:27.335457 [info ] [MainThread]:   port: 6543
[0m01:45:27.335804 [info ] [MainThread]:   user: postgres.ozadowjafypabbrltwoy
[0m01:45:27.336179 [info ] [MainThread]:   database: postgres
[0m01:45:27.336581 [info ] [MainThread]:   schema: public
[0m01:45:27.336930 [info ] [MainThread]:   connect_timeout: 60
[0m01:45:27.337272 [info ] [MainThread]:   role: None
[0m01:45:27.337607 [info ] [MainThread]:   search_path: None
[0m01:45:27.337946 [info ] [MainThread]:   keepalives_idle: 0
[0m01:45:27.338308 [info ] [MainThread]:   sslmode: require
[0m01:45:27.338646 [info ] [MainThread]:   sslcert: None
[0m01:45:27.338984 [info ] [MainThread]:   sslkey: None
[0m01:45:27.339358 [info ] [MainThread]:   sslrootcert: None
[0m01:45:27.339712 [info ] [MainThread]:   application_name: dbt
[0m01:45:27.340122 [info ] [MainThread]:   retries: 1
[0m01:45:27.340570 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m01:45:27.341075 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m01:45:27.341431 [debug] [MainThread]: Using postgres connection "debug"
[0m01:45:27.341745 [debug] [MainThread]: On debug: select 1 as id
[0m01:45:27.342037 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:45:28.308427 [debug] [MainThread]: SQL status: SELECT 1 in 1.0 seconds
[0m01:45:28.309314 [debug] [MainThread]: On debug: Close
[0m01:45:28.309792 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m01:45:28.310422 [info ] [MainThread]: [32mAll checks passed![0m
[0m01:45:28.312027 [debug] [MainThread]: Command `dbt debug` succeeded at 01:45:28.311772 after 1.29 seconds
[0m01:45:28.312459 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m01:45:28.312835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4AD2669E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4B41628D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4B3D8F020>]}
[0m01:45:28.313218 [debug] [MainThread]: Flushing usage events
[0m01:47:02.730856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CFDD9B5160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CFE05EBD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CFE05EB750>]}


============================== 01:47:02.734735 | 2099e423-a807-454b-8b96-22451382089e ==============================
[0m01:47:02.734735 [info ] [MainThread]: Running with dbt=1.7.4
[0m01:47:02.735295 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --select minha_quer', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\Felli\\.code\\dbt\\canal_brasil_dbt\\logs', 'profiles_dir': 'C:\\Users\\Felli\\.dbt', 'write_json': 'True', 'introspect': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m01:47:02.926384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2099e423-a807-454b-8b96-22451382089e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CFE0523100>]}
[0m01:47:03.007501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2099e423-a807-454b-8b96-22451382089e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CFE04BF020>]}
[0m01:47:03.008701 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m01:47:03.015902 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m01:47:03.073025 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m01:47:03.073534 [debug] [MainThread]: Partial parsing: added file: canal_brasil_dbt://models\example\query.sql
[0m01:47:03.073947 [debug] [MainThread]: Partial parsing: deleted file: canal_brasil_dbt://models\example\my_first_dbt_model.sql
[0m01:47:03.240377 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_first_dbt_model' in the 'models' section of file 'models\example\schema.yml'
[0m01:47:03.332088 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.canal_brasil_dbt.my_second_dbt_model' (models\example\my_second_dbt_model.sql) depends on a node named 'my_first_dbt_model' which was not found
[0m01:47:03.333338 [debug] [MainThread]: Command `dbt run` failed at 01:47:03.333167 after 0.71 seconds
[0m01:47:03.333720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CFE0A75D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CFE0A75E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CFE1CC4050>]}
[0m01:47:03.334076 [debug] [MainThread]: Flushing usage events
[0m01:47:15.131627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283843B5160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028386FEBD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028386FEB750>]}


============================== 01:47:15.135578 | 60fb2b33-5a93-43de-97e3-93e62847fc19 ==============================
[0m01:47:15.135578 [info ] [MainThread]: Running with dbt=1.7.4
[0m01:47:15.136149 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --select query.sql', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\Felli\\.code\\dbt\\canal_brasil_dbt\\logs', 'profiles_dir': 'C:\\Users\\Felli\\.dbt', 'write_json': 'True', 'introspect': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m01:47:15.323510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60fb2b33-5a93-43de-97e3-93e62847fc19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028386F27100>]}
[0m01:47:15.403770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60fb2b33-5a93-43de-97e3-93e62847fc19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028386EBF020>]}
[0m01:47:15.404914 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m01:47:15.412288 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m01:47:15.465945 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m01:47:15.466434 [debug] [MainThread]: Partial parsing: added file: canal_brasil_dbt://models\example\query.sql
[0m01:47:15.466857 [debug] [MainThread]: Partial parsing: deleted file: canal_brasil_dbt://models\example\my_first_dbt_model.sql
[0m01:47:15.632028 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_first_dbt_model' in the 'models' section of file 'models\example\schema.yml'
[0m01:47:15.721241 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.canal_brasil_dbt.my_second_dbt_model' (models\example\my_second_dbt_model.sql) depends on a node named 'my_first_dbt_model' which was not found
[0m01:47:15.722505 [debug] [MainThread]: Command `dbt run` failed at 01:47:15.722342 after 0.67 seconds
[0m01:47:15.722948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028387475D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028387475E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283886C4050>]}
[0m01:47:15.723311 [debug] [MainThread]: Flushing usage events
[0m01:47:50.643183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FC9195160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FCBDDBD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FCBDDB750>]}


============================== 01:47:50.647259 | 7df876fd-20ad-48b5-b16d-9ec5706a8a57 ==============================
[0m01:47:50.647259 [info ] [MainThread]: Running with dbt=1.7.4
[0m01:47:50.647839 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --select my_first_dbt_model', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\Felli\\.code\\dbt\\canal_brasil_dbt\\logs', 'profiles_dir': 'C:\\Users\\Felli\\.dbt', 'warn_error': 'None', 'introspect': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m01:47:50.834392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7df876fd-20ad-48b5-b16d-9ec5706a8a57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FCBD17100>]}
[0m01:47:50.914749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7df876fd-20ad-48b5-b16d-9ec5706a8a57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FCBCAF020>]}
[0m01:47:50.916035 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m01:47:50.923102 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m01:47:50.977562 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:47:50.977931 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:47:50.982452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7df876fd-20ad-48b5-b16d-9ec5706a8a57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FCC264950>]}
[0m01:47:51.003361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7df876fd-20ad-48b5-b16d-9ec5706a8a57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FCBCB7110>]}
[0m01:47:51.003814 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m01:47:51.004544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7df876fd-20ad-48b5-b16d-9ec5706a8a57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FCC117CB0>]}
[0m01:47:51.005947 [info ] [MainThread]: 
[0m01:47:51.006836 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:47:51.007950 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:47:51.016543 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:47:51.017005 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:47:51.017318 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:47:52.115267 [debug] [ThreadPool]: SQL status: SELECT 20 in 1.0 seconds
[0m01:47:52.117249 [debug] [ThreadPool]: On list_postgres: Close
[0m01:47:52.119969 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m01:47:52.128525 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m01:47:52.129154 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m01:47:52.129704 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:47:52.967397 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m01:47:52.967771 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m01:47:52.968078 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m01:47:53.074363 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m01:47:53.079054 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m01:47:53.182161 [debug] [ThreadPool]: On list_postgres_public: Close
[0m01:47:53.186151 [debug] [MainThread]: Using postgres connection "master"
[0m01:47:53.186497 [debug] [MainThread]: On master: BEGIN
[0m01:47:53.186779 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:47:54.026870 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m01:47:54.027344 [debug] [MainThread]: Using postgres connection "master"
[0m01:47:54.027734 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:47:54.148238 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m01:47:54.149394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7df876fd-20ad-48b5-b16d-9ec5706a8a57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FCC2625B0>]}
[0m01:47:54.149791 [debug] [MainThread]: On master: ROLLBACK
[0m01:47:54.253674 [debug] [MainThread]: Using postgres connection "master"
[0m01:47:54.254048 [debug] [MainThread]: On master: BEGIN
[0m01:47:54.464398 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:47:54.464782 [debug] [MainThread]: On master: COMMIT
[0m01:47:54.465083 [debug] [MainThread]: Using postgres connection "master"
[0m01:47:54.465401 [debug] [MainThread]: On master: COMMIT
[0m01:47:54.570505 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:47:54.570891 [debug] [MainThread]: On master: Close
[0m01:47:54.571634 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:47:54.572135 [info ] [MainThread]: 
[0m01:47:54.597056 [debug] [Thread-1 (]: Began running node model.canal_brasil_dbt.my_first_dbt_model
[0m01:47:54.597562 [info ] [Thread-1 (]: 1 of 1 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m01:47:54.598718 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.canal_brasil_dbt.my_first_dbt_model'
[0m01:47:54.599131 [debug] [Thread-1 (]: Began compiling node model.canal_brasil_dbt.my_first_dbt_model
[0m01:47:54.604761 [debug] [Thread-1 (]: Writing injected SQL for node "model.canal_brasil_dbt.my_first_dbt_model"
[0m01:47:54.606632 [debug] [Thread-1 (]: Timing info for model.canal_brasil_dbt.my_first_dbt_model (compile): 01:47:54.599361 => 01:47:54.606306
[0m01:47:54.607105 [debug] [Thread-1 (]: Began executing node model.canal_brasil_dbt.my_first_dbt_model
[0m01:47:54.643179 [debug] [Thread-1 (]: Writing runtime sql for node "model.canal_brasil_dbt.my_first_dbt_model"
[0m01:47:54.644789 [debug] [Thread-1 (]: Using postgres connection "model.canal_brasil_dbt.my_first_dbt_model"
[0m01:47:54.645228 [debug] [Thread-1 (]: On model.canal_brasil_dbt.my_first_dbt_model: BEGIN
[0m01:47:54.645732 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:47:55.550685 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m01:47:55.551250 [debug] [Thread-1 (]: Using postgres connection "model.canal_brasil_dbt.my_first_dbt_model"
[0m01:47:55.551860 [debug] [Thread-1 (]: On model.canal_brasil_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "node_id": "model.canal_brasil_dbt.my_first_dbt_model"} */

  
    

  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m01:47:55.673054 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m01:47:55.678856 [debug] [Thread-1 (]: Using postgres connection "model.canal_brasil_dbt.my_first_dbt_model"
[0m01:47:55.679273 [debug] [Thread-1 (]: On model.canal_brasil_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "node_id": "model.canal_brasil_dbt.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m01:47:55.791173 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:47:55.808561 [debug] [Thread-1 (]: On model.canal_brasil_dbt.my_first_dbt_model: COMMIT
[0m01:47:55.809081 [debug] [Thread-1 (]: Using postgres connection "model.canal_brasil_dbt.my_first_dbt_model"
[0m01:47:55.809426 [debug] [Thread-1 (]: On model.canal_brasil_dbt.my_first_dbt_model: COMMIT
[0m01:47:55.921589 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m01:47:55.927732 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."my_first_dbt_model__dbt_backup"
[0m01:47:55.932256 [debug] [Thread-1 (]: Using postgres connection "model.canal_brasil_dbt.my_first_dbt_model"
[0m01:47:55.932642 [debug] [Thread-1 (]: On model.canal_brasil_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "node_id": "model.canal_brasil_dbt.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
[0m01:47:56.045166 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m01:47:56.046777 [debug] [Thread-1 (]: Timing info for model.canal_brasil_dbt.my_first_dbt_model (execute): 01:47:54.607416 => 01:47:56.046533
[0m01:47:56.047163 [debug] [Thread-1 (]: On model.canal_brasil_dbt.my_first_dbt_model: Close
[0m01:47:56.048066 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7df876fd-20ad-48b5-b16d-9ec5706a8a57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FCC22DCD0>]}
[0m01:47:56.048645 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 1.45s]
[0m01:47:56.049460 [debug] [Thread-1 (]: Finished running node model.canal_brasil_dbt.my_first_dbt_model
[0m01:47:56.051170 [debug] [MainThread]: Using postgres connection "master"
[0m01:47:56.051515 [debug] [MainThread]: On master: BEGIN
[0m01:47:56.051812 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:47:56.907338 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m01:47:56.907751 [debug] [MainThread]: On master: COMMIT
[0m01:47:56.908081 [debug] [MainThread]: Using postgres connection "master"
[0m01:47:56.908378 [debug] [MainThread]: On master: COMMIT
[0m01:47:57.012913 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:47:57.013296 [debug] [MainThread]: On master: Close
[0m01:47:57.014052 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:47:57.014332 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m01:47:57.014600 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m01:47:57.014867 [debug] [MainThread]: Connection 'model.canal_brasil_dbt.my_first_dbt_model' was properly closed.
[0m01:47:57.015362 [info ] [MainThread]: 
[0m01:47:57.015983 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.01 seconds (6.01s).
[0m01:47:57.016854 [debug] [MainThread]: Command end result
[0m01:47:57.023831 [info ] [MainThread]: 
[0m01:47:57.024610 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:47:57.025377 [info ] [MainThread]: 
[0m01:47:57.026023 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:47:57.027769 [debug] [MainThread]: Command `dbt run` succeeded at 01:47:57.027499 after 6.46 seconds
[0m01:47:57.028367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FCC159390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FCC14A2B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FCC149E50>]}
[0m01:47:57.029030 [debug] [MainThread]: Flushing usage events
[0m01:51:59.921779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7FB7E5160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7FE41BD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7FE41B750>]}


============================== 01:51:59.925717 | 97e45d58-4642-4a08-8a34-b9b5087fbcdb ==============================
[0m01:51:59.925717 [info ] [MainThread]: Running with dbt=1.7.4
[0m01:51:59.926290 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --select my_first_dbt_model', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\Felli\\.code\\dbt\\canal_brasil_dbt\\logs', 'warn_error': 'None', 'use_colors': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Felli\\.dbt', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m01:52:00.151898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '97e45d58-4642-4a08-8a34-b9b5087fbcdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7FE353100>]}
[0m01:52:00.231223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '97e45d58-4642-4a08-8a34-b9b5087fbcdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7FE2EF020>]}
[0m01:52:00.232446 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m01:52:00.239266 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m01:52:00.296986 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:52:00.297335 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:52:00.301768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97e45d58-4642-4a08-8a34-b9b5087fbcdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7FE8A4950>]}
[0m01:52:00.310384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '97e45d58-4642-4a08-8a34-b9b5087fbcdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7FE2F7110>]}
[0m01:52:00.310852 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m01:52:00.311337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97e45d58-4642-4a08-8a34-b9b5087fbcdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7FE757CB0>]}
[0m01:52:00.312694 [info ] [MainThread]: 
[0m01:52:00.313556 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:52:00.314628 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:52:00.323423 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:52:00.323808 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:52:00.324104 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:52:01.238355 [debug] [ThreadPool]: SQL status: SELECT 20 in 1.0 seconds
[0m01:52:01.239766 [debug] [ThreadPool]: On list_postgres: Close
[0m01:52:01.241633 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m01:52:01.246458 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m01:52:01.246813 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m01:52:01.247105 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:52:02.094354 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m01:52:02.094725 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m01:52:02.095058 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m01:52:02.202285 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m01:52:02.206409 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m01:52:02.311599 [debug] [ThreadPool]: On list_postgres_public: Close
[0m01:52:02.315791 [debug] [MainThread]: Using postgres connection "master"
[0m01:52:02.316135 [debug] [MainThread]: On master: BEGIN
[0m01:52:02.316416 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:52:03.026362 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m01:52:03.026737 [debug] [MainThread]: Using postgres connection "master"
[0m01:52:03.027090 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:52:03.131776 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m01:52:03.132993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97e45d58-4642-4a08-8a34-b9b5087fbcdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7FE8A25B0>]}
[0m01:52:03.133394 [debug] [MainThread]: On master: ROLLBACK
[0m01:52:03.221936 [debug] [MainThread]: Using postgres connection "master"
[0m01:52:03.222310 [debug] [MainThread]: On master: BEGIN
[0m01:52:03.400181 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:52:03.400556 [debug] [MainThread]: On master: COMMIT
[0m01:52:03.400842 [debug] [MainThread]: Using postgres connection "master"
[0m01:52:03.401144 [debug] [MainThread]: On master: COMMIT
[0m01:52:03.489534 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:52:03.489927 [debug] [MainThread]: On master: Close
[0m01:52:03.490726 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:52:03.491236 [info ] [MainThread]: 
[0m01:52:03.494173 [debug] [Thread-1 (]: Began running node model.canal_brasil_dbt.my_first_dbt_model
[0m01:52:03.494694 [info ] [Thread-1 (]: 1 of 1 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m01:52:03.495636 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.canal_brasil_dbt.my_first_dbt_model'
[0m01:52:03.496003 [debug] [Thread-1 (]: Began compiling node model.canal_brasil_dbt.my_first_dbt_model
[0m01:52:03.501553 [debug] [Thread-1 (]: Writing injected SQL for node "model.canal_brasil_dbt.my_first_dbt_model"
[0m01:52:03.502560 [debug] [Thread-1 (]: Timing info for model.canal_brasil_dbt.my_first_dbt_model (compile): 01:52:03.496232 => 01:52:03.502174
[0m01:52:03.503000 [debug] [Thread-1 (]: Began executing node model.canal_brasil_dbt.my_first_dbt_model
[0m01:52:03.543256 [debug] [Thread-1 (]: Writing runtime sql for node "model.canal_brasil_dbt.my_first_dbt_model"
[0m01:52:03.544258 [debug] [Thread-1 (]: Using postgres connection "model.canal_brasil_dbt.my_first_dbt_model"
[0m01:52:03.544690 [debug] [Thread-1 (]: On model.canal_brasil_dbt.my_first_dbt_model: BEGIN
[0m01:52:03.545028 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:52:04.415425 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m01:52:04.415844 [debug] [Thread-1 (]: Using postgres connection "model.canal_brasil_dbt.my_first_dbt_model"
[0m01:52:04.416202 [debug] [Thread-1 (]: On model.canal_brasil_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "node_id": "model.canal_brasil_dbt.my_first_dbt_model"} */

  
    

  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m01:52:04.528382 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m01:52:04.533970 [debug] [Thread-1 (]: Using postgres connection "model.canal_brasil_dbt.my_first_dbt_model"
[0m01:52:04.534350 [debug] [Thread-1 (]: On model.canal_brasil_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "node_id": "model.canal_brasil_dbt.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m01:52:04.642491 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:52:04.645783 [debug] [Thread-1 (]: Using postgres connection "model.canal_brasil_dbt.my_first_dbt_model"
[0m01:52:04.646199 [debug] [Thread-1 (]: On model.canal_brasil_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "node_id": "model.canal_brasil_dbt.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m01:52:04.754300 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:52:04.772259 [debug] [Thread-1 (]: On model.canal_brasil_dbt.my_first_dbt_model: COMMIT
[0m01:52:04.772745 [debug] [Thread-1 (]: Using postgres connection "model.canal_brasil_dbt.my_first_dbt_model"
[0m01:52:04.773101 [debug] [Thread-1 (]: On model.canal_brasil_dbt.my_first_dbt_model: COMMIT
[0m01:52:04.882524 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m01:52:04.888591 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."my_first_dbt_model__dbt_backup"
[0m01:52:04.893021 [debug] [Thread-1 (]: Using postgres connection "model.canal_brasil_dbt.my_first_dbt_model"
[0m01:52:04.893416 [debug] [Thread-1 (]: On model.canal_brasil_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "node_id": "model.canal_brasil_dbt.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
[0m01:52:05.013205 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m01:52:05.014695 [debug] [Thread-1 (]: Timing info for model.canal_brasil_dbt.my_first_dbt_model (execute): 01:52:03.503234 => 01:52:05.014467
[0m01:52:05.015053 [debug] [Thread-1 (]: On model.canal_brasil_dbt.my_first_dbt_model: Close
[0m01:52:05.015864 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97e45d58-4642-4a08-8a34-b9b5087fbcdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7FE86D9D0>]}
[0m01:52:05.016381 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 1.52s]
[0m01:52:05.017244 [debug] [Thread-1 (]: Finished running node model.canal_brasil_dbt.my_first_dbt_model
[0m01:52:05.018625 [debug] [MainThread]: Using postgres connection "master"
[0m01:52:05.018939 [debug] [MainThread]: On master: BEGIN
[0m01:52:05.019246 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:52:05.737518 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m01:52:05.737899 [debug] [MainThread]: On master: COMMIT
[0m01:52:05.738187 [debug] [MainThread]: Using postgres connection "master"
[0m01:52:05.738527 [debug] [MainThread]: On master: COMMIT
[0m01:52:05.832234 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:52:05.832643 [debug] [MainThread]: On master: Close
[0m01:52:05.833382 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:52:05.833669 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m01:52:05.833934 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m01:52:05.834194 [debug] [MainThread]: Connection 'model.canal_brasil_dbt.my_first_dbt_model' was properly closed.
[0m01:52:05.834509 [info ] [MainThread]: 
[0m01:52:05.835009 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.52 seconds (5.52s).
[0m01:52:05.835797 [debug] [MainThread]: Command end result
[0m01:52:05.844249 [info ] [MainThread]: 
[0m01:52:05.845019 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:52:05.845773 [info ] [MainThread]: 
[0m01:52:05.846526 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:52:05.847937 [debug] [MainThread]: Command `dbt run` succeeded at 01:52:05.847762 after 6.04 seconds
[0m01:52:05.848348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7FD887800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7FE789DB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7FE78B070>]}
[0m01:52:05.848740 [debug] [MainThread]: Flushing usage events
[0m01:52:27.083754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBE1985160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBE45CBD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBE45CB750>]}


============================== 01:52:27.087670 | b73226ef-611b-4c3a-af86-4d9cc29192a0 ==============================
[0m01:52:27.087670 [info ] [MainThread]: Running with dbt=1.7.4
[0m01:52:27.088274 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt show --select my_first_dbt_model', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\Felli\\.code\\dbt\\canal_brasil_dbt\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Felli\\.dbt', 'introspect': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m01:52:27.275230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b73226ef-611b-4c3a-af86-4d9cc29192a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBE4503100>]}
[0m01:52:27.354694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b73226ef-611b-4c3a-af86-4d9cc29192a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBE449F020>]}
[0m01:52:27.355866 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m01:52:27.362884 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m01:52:27.417301 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:52:27.417660 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:52:27.422528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b73226ef-611b-4c3a-af86-4d9cc29192a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBE4A54950>]}
[0m01:52:27.430659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b73226ef-611b-4c3a-af86-4d9cc29192a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBE44A7110>]}
[0m01:52:27.431135 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m01:52:27.431672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b73226ef-611b-4c3a-af86-4d9cc29192a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBE48FFCB0>]}
[0m01:52:27.433095 [info ] [MainThread]: 
[0m01:52:27.433899 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:52:27.434863 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m01:52:27.444396 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m01:52:27.444792 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m01:52:27.445095 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:52:28.309442 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m01:52:28.309814 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m01:52:28.310121 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m01:52:28.425692 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m01:52:28.426952 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m01:52:28.531435 [debug] [ThreadPool]: On list_postgres_public: Close
[0m01:52:28.537828 [debug] [MainThread]: Using postgres connection "master"
[0m01:52:28.538476 [debug] [MainThread]: On master: BEGIN
[0m01:52:28.538916 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:52:29.319307 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m01:52:29.319769 [debug] [MainThread]: Using postgres connection "master"
[0m01:52:29.320139 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:52:29.429187 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m01:52:29.430434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b73226ef-611b-4c3a-af86-4d9cc29192a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBE4A51D90>]}
[0m01:52:29.430849 [debug] [MainThread]: On master: ROLLBACK
[0m01:52:29.524343 [debug] [MainThread]: On master: Close
[0m01:52:29.525243 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:52:29.525790 [info ] [MainThread]: 
[0m01:52:29.531594 [debug] [Thread-1 (]: Began running node model.canal_brasil_dbt.my_first_dbt_model
[0m01:52:29.532385 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.canal_brasil_dbt.my_first_dbt_model'
[0m01:52:29.532747 [debug] [Thread-1 (]: Began compiling node model.canal_brasil_dbt.my_first_dbt_model
[0m01:52:29.538914 [debug] [Thread-1 (]: Writing injected SQL for node "model.canal_brasil_dbt.my_first_dbt_model"
[0m01:52:29.540135 [debug] [Thread-1 (]: Timing info for model.canal_brasil_dbt.my_first_dbt_model (compile): 01:52:29.532971 => 01:52:29.539789
[0m01:52:29.540577 [debug] [Thread-1 (]: Began executing node model.canal_brasil_dbt.my_first_dbt_model
[0m01:52:29.547632 [debug] [Thread-1 (]: Using postgres connection "model.canal_brasil_dbt.my_first_dbt_model"
[0m01:52:29.548066 [debug] [Thread-1 (]: On model.canal_brasil_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "node_id": "model.canal_brasil_dbt.my_first_dbt_model"} */

  
    select *
    from (
        /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    ) as model_limit_subq
    limit 5


[0m01:52:29.548425 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:52:30.331381 [debug] [Thread-1 (]: SQL status: SELECT 2 in 1.0 seconds
[0m01:52:30.332620 [debug] [Thread-1 (]: Timing info for model.canal_brasil_dbt.my_first_dbt_model (execute): 01:52:29.540812 => 01:52:30.332382
[0m01:52:30.332984 [debug] [Thread-1 (]: On model.canal_brasil_dbt.my_first_dbt_model: Close
[0m01:52:30.334254 [debug] [Thread-1 (]: Finished running node model.canal_brasil_dbt.my_first_dbt_model
[0m01:52:30.335052 [debug] [Thread-1 (]: Began running node test.canal_brasil_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m01:52:30.335657 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.canal_brasil_dbt.my_first_dbt_model, now test.canal_brasil_dbt.not_null_my_first_dbt_model_id.5fb22c2710)
[0m01:52:30.336012 [debug] [Thread-1 (]: Began compiling node test.canal_brasil_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m01:52:30.346230 [debug] [Thread-1 (]: Writing injected SQL for node "test.canal_brasil_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m01:52:30.347486 [debug] [Thread-1 (]: Timing info for test.canal_brasil_dbt.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 01:52:30.336234 => 01:52:30.347184
[0m01:52:30.347892 [debug] [Thread-1 (]: Began executing node test.canal_brasil_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m01:52:30.350657 [debug] [Thread-1 (]: Using postgres connection "test.canal_brasil_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m01:52:30.351080 [debug] [Thread-1 (]: On test.canal_brasil_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "node_id": "test.canal_brasil_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */

  
    select *
    from (
        
    
    



select id
from "postgres"."public"."my_first_dbt_model"
where id is null



    ) as model_limit_subq
    limit 5


[0m01:52:30.351470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:52:31.117466 [debug] [Thread-1 (]: SQL status: SELECT 1 in 1.0 seconds
[0m01:52:31.118678 [debug] [Thread-1 (]: Timing info for test.canal_brasil_dbt.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 01:52:30.348169 => 01:52:31.118443
[0m01:52:31.119033 [debug] [Thread-1 (]: On test.canal_brasil_dbt.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m01:52:31.120102 [debug] [Thread-1 (]: Finished running node test.canal_brasil_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m01:52:31.120582 [debug] [Thread-1 (]: Began running node test.canal_brasil_dbt.unique_my_first_dbt_model_id.16e066b321
[0m01:52:31.121197 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.canal_brasil_dbt.not_null_my_first_dbt_model_id.5fb22c2710, now test.canal_brasil_dbt.unique_my_first_dbt_model_id.16e066b321)
[0m01:52:31.121563 [debug] [Thread-1 (]: Began compiling node test.canal_brasil_dbt.unique_my_first_dbt_model_id.16e066b321
[0m01:52:31.127336 [debug] [Thread-1 (]: Writing injected SQL for node "test.canal_brasil_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m01:52:31.128515 [debug] [Thread-1 (]: Timing info for test.canal_brasil_dbt.unique_my_first_dbt_model_id.16e066b321 (compile): 01:52:31.121793 => 01:52:31.128132
[0m01:52:31.129021 [debug] [Thread-1 (]: Began executing node test.canal_brasil_dbt.unique_my_first_dbt_model_id.16e066b321
[0m01:52:31.131404 [debug] [Thread-1 (]: Using postgres connection "test.canal_brasil_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m01:52:31.131791 [debug] [Thread-1 (]: On test.canal_brasil_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "node_id": "test.canal_brasil_dbt.unique_my_first_dbt_model_id.16e066b321"} */

  
    select *
    from (
        
    
    

select
    id as unique_field,
    count(*) as n_records

from "postgres"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



    ) as model_limit_subq
    limit 5


[0m01:52:31.132150 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:52:31.882083 [debug] [Thread-1 (]: SQL status: SELECT 0 in 1.0 seconds
[0m01:52:31.883289 [debug] [Thread-1 (]: Timing info for test.canal_brasil_dbt.unique_my_first_dbt_model_id.16e066b321 (execute): 01:52:31.129263 => 01:52:31.883056
[0m01:52:31.883643 [debug] [Thread-1 (]: On test.canal_brasil_dbt.unique_my_first_dbt_model_id.16e066b321: Close
[0m01:52:31.884670 [debug] [Thread-1 (]: Finished running node test.canal_brasil_dbt.unique_my_first_dbt_model_id.16e066b321
[0m01:52:31.885755 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:52:31.886053 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m01:52:31.886324 [debug] [MainThread]: Connection 'test.canal_brasil_dbt.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m01:52:31.887380 [debug] [MainThread]: Command end result
[0m01:52:31.894287 [debug] [MainThread]: Excluded node 'not_null_my_first_dbt_model_id' from results
[0m01:52:31.894764 [debug] [MainThread]: Excluded node 'unique_my_first_dbt_model_id' from results
[0m01:52:31.895123 [info ] [MainThread]: Previewing node 'my_first_dbt_model':
| id |
| -- |
|  1 |
|    |

[0m01:52:31.896485 [debug] [MainThread]: Command `dbt show` succeeded at 01:52:31.896322 after 4.89 seconds
[0m01:52:31.896847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBE44E2690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBE4948D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBE4948520>]}
[0m01:52:31.897208 [debug] [MainThread]: Flushing usage events
[0m12:57:36.786939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A71015400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A70B66710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A73C6FED0>]}


============================== 12:57:36.790959 | d0eb03e6-a50b-4b3f-a95b-7aa5b9ae53a9 ==============================
[0m12:57:36.790959 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:57:36.791497 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt ', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'c:\\Users\\Felli\\.code\\dbt\\canal_brasil_dbt\\logs', 'profiles_dir': 'C:\\Users\\Felli\\.dbt', 'cache_selected_only': 'False', 'introspect': 'True', 'warn_error': 'None', 'write_json': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m12:57:36.909609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0eb03e6-a50b-4b3f-a95b-7aa5b9ae53a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A73BB5220>]}
[0m12:57:36.911120 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m12:57:36.912734 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m12:57:36.914565 [debug] [MainThread]: Command `cli deps` succeeded at 12:57:36.914320 after 0.23 seconds
[0m12:57:36.915090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A73B43F00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A73B43DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A733C9050>]}
[0m12:57:36.915601 [debug] [MainThread]: Flushing usage events
[0m13:07:55.249849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFDE2F5160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFE0F3BD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFE0F3B750>]}


============================== 13:07:55.253354 | 1770127d-1c8f-4a57-9c28-5ce532458d05 ==============================
[0m13:07:55.253354 [info ] [MainThread]: Running with dbt=1.7.4
[0m13:07:55.253923 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --select canal_brasil_silver', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\Felli\\.code\\dbt\\canal_brasil_dbt\\logs', 'warn_error': 'None', 'cache_selected_only': 'False', 'introspect': 'True', 'write_json': 'True', 'profiles_dir': 'C:\\Users\\Felli\\.dbt', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m13:07:55.434965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1770127d-1c8f-4a57-9c28-5ce532458d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFE0E77100>]}
[0m13:07:55.518883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1770127d-1c8f-4a57-9c28-5ce532458d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFE0E0F020>]}
[0m13:07:55.519872 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m13:07:55.527172 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m13:07:55.582974 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m13:07:55.583443 [debug] [MainThread]: Partial parsing: added file: canal_brasil_dbt://models\example\canal_brasil_silver.sql
[0m13:07:55.718103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1770127d-1c8f-4a57-9c28-5ce532458d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFE1490D50>]}
[0m13:07:55.739486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1770127d-1c8f-4a57-9c28-5ce532458d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFE10774D0>]}
[0m13:07:55.739985 [info ] [MainThread]: Found 3 models, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m13:07:55.740464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1770127d-1c8f-4a57-9c28-5ce532458d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFE13475B0>]}
[0m13:07:55.741507 [warn ] [MainThread]: The selection criterion 'canal_brasil_silver' does not match any nodes
[0m13:07:55.742873 [info ] [MainThread]: 
[0m13:07:55.743387 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:07:55.744120 [debug] [MainThread]: Command end result
[0m13:07:55.751425 [debug] [MainThread]: Command `dbt run` succeeded at 13:07:55.751203 after 0.62 seconds
[0m13:07:55.752061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFE13069C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFE0E4E690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFE153DD90>]}
[0m13:07:55.752492 [debug] [MainThread]: Flushing usage events
[0m13:09:09.257566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C6FCC5160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C7290BD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C7290B750>]}


============================== 13:09:09.261174 | ba63f287-821b-43fd-9ff8-78108fc021f2 ==============================
[0m13:09:09.261174 [info ] [MainThread]: Running with dbt=1.7.4
[0m13:09:09.261814 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --select canal_brasil_silver', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\Felli\\.code\\dbt\\canal_brasil_dbt\\logs', 'profiles_dir': 'C:\\Users\\Felli\\.dbt', 'write_json': 'True', 'introspect': 'True', 'use_colors': 'True', 'warn_error': 'None', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m13:09:09.444907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba63f287-821b-43fd-9ff8-78108fc021f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C72847100>]}
[0m13:09:09.523583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ba63f287-821b-43fd-9ff8-78108fc021f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C727DF020>]}
[0m13:09:09.524460 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m13:09:09.531444 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m13:09:09.595781 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:09:09.596125 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:09:09.600944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba63f287-821b-43fd-9ff8-78108fc021f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C72DD4950>]}
[0m13:09:09.609752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba63f287-821b-43fd-9ff8-78108fc021f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C727E7110>]}
[0m13:09:09.610232 [info ] [MainThread]: Found 3 models, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m13:09:09.610819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba63f287-821b-43fd-9ff8-78108fc021f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C72C87A10>]}
[0m13:09:09.611429 [warn ] [MainThread]: The selection criterion 'canal_brasil_silver' does not match any nodes
[0m13:09:09.612638 [info ] [MainThread]: 
[0m13:09:09.613092 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:09:09.613681 [debug] [MainThread]: Command end result
[0m13:09:09.623366 [debug] [MainThread]: Command `dbt run` succeeded at 13:09:09.623179 after 0.45 seconds
[0m13:09:09.623751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C72C469C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C7281E690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C72DD0A10>]}
[0m13:09:09.624091 [debug] [MainThread]: Flushing usage events
[0m13:12:28.162928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016249525160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001624C15BD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001624C15B750>]}


============================== 13:12:28.166585 | e260bac6-f62d-4d83-afa2-9eece2e30193 ==============================
[0m13:12:28.166585 [info ] [MainThread]: Running with dbt=1.7.4
[0m13:12:28.167223 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --select canal_brasil_silver', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\Felli\\.code\\dbt\\canal_brasil_dbt\\logs', 'warn_error': 'None', 'write_json': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Felli\\.dbt', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m13:12:28.351366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e260bac6-f62d-4d83-afa2-9eece2e30193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001624C093100>]}
[0m13:12:28.430630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e260bac6-f62d-4d83-afa2-9eece2e30193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001624C02F020>]}
[0m13:12:28.431495 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m13:12:28.438412 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m13:12:28.490588 [debug] [MainThread]: Partial parsing enabled: 4 files deleted, 1 files added, 0 files changed.
[0m13:12:28.491064 [debug] [MainThread]: Partial parsing: added file: canal_brasil_dbt://models\canal_brasil_silver.sql
[0m13:12:28.491405 [debug] [MainThread]: Partial parsing: deleted file: canal_brasil_dbt://models\example\my_second_dbt_model.sql
[0m13:12:28.491698 [debug] [MainThread]: Partial parsing: deleted file: canal_brasil_dbt://models\example\canal_brasil_silver.sql
[0m13:12:28.491986 [debug] [MainThread]: Partial parsing: deleted file: canal_brasil_dbt://models\example\my_first_dbt_model.sql
[0m13:12:28.610248 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.canal_brasil_dbt.canal_brasil_silver' (models\canal_brasil_silver.sql) depends on a source named 'public.canal_brasil' which was not found
[0m13:12:28.611465 [debug] [MainThread]: Command `dbt run` failed at 13:12:28.611314 after 0.56 seconds
[0m13:12:28.611816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001624C5E4A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001624C5E4D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001624C6418B0>]}
[0m13:12:28.612170 [debug] [MainThread]: Flushing usage events
[0m13:14:20.481916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9CFCB5160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D28FBD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D28FB750>]}


============================== 13:14:20.485524 | 1b79ef10-8cd5-4c16-800f-24e485b9208a ==============================
[0m13:14:20.485524 [info ] [MainThread]: Running with dbt=1.7.4
[0m13:14:20.486173 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt ls --resource-type model', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\Felli\\.code\\dbt\\canal_brasil_dbt\\logs', 'profiles_dir': 'C:\\Users\\Felli\\.dbt', 'warn_error': 'None', 'introspect': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m13:14:20.669850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b79ef10-8cd5-4c16-800f-24e485b9208a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D2833100>]}
[0m13:14:20.748469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b79ef10-8cd5-4c16-800f-24e485b9208a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D27CF020>]}
[0m13:14:20.749306 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m13:14:20.756635 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m13:14:20.809634 [debug] [MainThread]: Partial parsing enabled: 4 files deleted, 1 files added, 0 files changed.
[0m13:14:20.810099 [debug] [MainThread]: Partial parsing: added file: canal_brasil_dbt://models\canal_brasil_silver.sql
[0m13:14:20.810519 [debug] [MainThread]: Partial parsing: deleted file: canal_brasil_dbt://models\example\my_second_dbt_model.sql
[0m13:14:20.810885 [debug] [MainThread]: Partial parsing: deleted file: canal_brasil_dbt://models\example\my_first_dbt_model.sql
[0m13:14:20.811299 [debug] [MainThread]: Partial parsing: deleted file: canal_brasil_dbt://models\example\canal_brasil_silver.sql
[0m13:14:20.935227 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.canal_brasil_dbt.canal_brasil_silver' (models\canal_brasil_silver.sql) depends on a source named 'public.canal_brasil' which was not found
[0m13:14:20.936449 [debug] [MainThread]: Command `dbt ls` failed at 13:14:20.936300 after 0.57 seconds
[0m13:14:20.936804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D2DC4A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D2DC4D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D2E1D8B0>]}
[0m13:14:20.937153 [debug] [MainThread]: Flushing usage events
[0m13:15:19.252133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB40115160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB42D4BD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB42D4B750>]}


============================== 13:15:19.255634 | 60ed3339-efb2-499b-ad1e-34abb597a218 ==============================
[0m13:15:19.255634 [info ] [MainThread]: Running with dbt=1.7.4
[0m13:15:19.256250 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt ls --resource-type model', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\Felli\\.code\\dbt\\canal_brasil_dbt\\logs', 'profiles_dir': 'C:\\Users\\Felli\\.dbt', 'warn_error': 'None', 'introspect': 'True', 'write_json': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m13:15:19.437049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60ed3339-efb2-499b-ad1e-34abb597a218', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB42C87100>]}
[0m13:15:19.515776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60ed3339-efb2-499b-ad1e-34abb597a218', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB42C1F020>]}
[0m13:15:19.516799 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m13:15:19.523598 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m13:15:19.575535 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:15:19.575905 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:15:19.576542 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.canal_brasil_dbt.example
[0m13:15:19.581800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60ed3339-efb2-499b-ad1e-34abb597a218', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB431D0950>]}
[0m13:15:19.589577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60ed3339-efb2-499b-ad1e-34abb597a218', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB42C27110>]}
[0m13:15:19.590046 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m13:15:19.590607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60ed3339-efb2-499b-ad1e-34abb597a218', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB43083850>]}
[0m13:15:19.592446 [debug] [MainThread]: Command `dbt ls` succeeded at 13:15:19.592263 after 0.42 seconds
[0m13:15:19.592915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB431C8530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB42C5E690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB431CC950>]}
[0m13:15:19.593287 [debug] [MainThread]: Flushing usage events
[0m13:15:36.674327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020152085160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020154CBBD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020154CBB750>]}


============================== 13:15:36.677821 | 8ab02f0b-55c9-4f3f-876f-948429271d40 ==============================
[0m13:15:36.677821 [info ] [MainThread]: Running with dbt=1.7.4
[0m13:15:36.678596 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --select canal_brasil_silver', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\Felli\\.code\\dbt\\canal_brasil_dbt\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Felli\\.dbt', 'introspect': 'True', 'use_colors': 'True', 'write_json': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m13:15:36.860692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ab02f0b-55c9-4f3f-876f-948429271d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020154BF7100>]}
[0m13:15:36.940130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ab02f0b-55c9-4f3f-876f-948429271d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020154B8F020>]}
[0m13:15:36.940972 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m13:15:36.947715 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m13:15:37.003056 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:15:37.003403 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:15:37.003848 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.canal_brasil_dbt.example
[0m13:15:37.008371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ab02f0b-55c9-4f3f-876f-948429271d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020155220950>]}
[0m13:15:37.016530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ab02f0b-55c9-4f3f-876f-948429271d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020154B97110>]}
[0m13:15:37.017033 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m13:15:37.017561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ab02f0b-55c9-4f3f-876f-948429271d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201550D7BD0>]}
[0m13:15:37.019101 [info ] [MainThread]: 
[0m13:15:37.020149 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:15:37.021253 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:15:37.031993 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:15:37.032365 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:15:37.032655 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:15:37.972401 [debug] [ThreadPool]: SQL status: SELECT 20 in 1.0 seconds
[0m13:15:37.973607 [debug] [ThreadPool]: On list_postgres: Close
[0m13:15:37.975838 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m13:15:37.980418 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m13:15:37.980755 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m13:15:37.981039 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:15:38.750937 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m13:15:38.751338 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m13:15:38.751650 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:15:38.855538 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m13:15:38.859731 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m13:15:38.956634 [debug] [ThreadPool]: On list_postgres_public: Close
[0m13:15:38.961792 [debug] [MainThread]: Using postgres connection "master"
[0m13:15:38.962157 [debug] [MainThread]: On master: BEGIN
[0m13:15:38.962438 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:15:39.707794 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m13:15:39.708176 [debug] [MainThread]: Using postgres connection "master"
[0m13:15:39.708720 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:15:39.823052 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m13:15:39.824197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ab02f0b-55c9-4f3f-876f-948429271d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020155219BF0>]}
[0m13:15:39.824598 [debug] [MainThread]: On master: ROLLBACK
[0m13:15:39.919291 [debug] [MainThread]: Using postgres connection "master"
[0m13:15:39.919664 [debug] [MainThread]: On master: BEGIN
[0m13:15:40.103794 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:15:40.104193 [debug] [MainThread]: On master: COMMIT
[0m13:15:40.104498 [debug] [MainThread]: Using postgres connection "master"
[0m13:15:40.104791 [debug] [MainThread]: On master: COMMIT
[0m13:15:40.198330 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:15:40.198721 [debug] [MainThread]: On master: Close
[0m13:15:40.199515 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:15:40.200009 [info ] [MainThread]: 
[0m13:15:40.204698 [debug] [Thread-1 (]: Began running node model.canal_brasil_dbt.canal_brasil_silver
[0m13:15:40.205181 [info ] [Thread-1 (]: 1 of 1 START sql table model public.canal_brasil_silver ........................ [RUN]
[0m13:15:40.206069 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.canal_brasil_dbt.canal_brasil_silver'
[0m13:15:40.206541 [debug] [Thread-1 (]: Began compiling node model.canal_brasil_dbt.canal_brasil_silver
[0m13:15:40.213623 [debug] [Thread-1 (]: Writing injected SQL for node "model.canal_brasil_dbt.canal_brasil_silver"
[0m13:15:40.215058 [debug] [Thread-1 (]: Timing info for model.canal_brasil_dbt.canal_brasil_silver (compile): 13:15:40.206785 => 13:15:40.214622
[0m13:15:40.215511 [debug] [Thread-1 (]: Began executing node model.canal_brasil_dbt.canal_brasil_silver
[0m13:15:40.251926 [debug] [Thread-1 (]: Writing runtime sql for node "model.canal_brasil_dbt.canal_brasil_silver"
[0m13:15:40.252872 [debug] [Thread-1 (]: Using postgres connection "model.canal_brasil_dbt.canal_brasil_silver"
[0m13:15:40.253263 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: BEGIN
[0m13:15:40.253608 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:15:41.029856 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m13:15:41.030295 [debug] [Thread-1 (]: Using postgres connection "model.canal_brasil_dbt.canal_brasil_silver"
[0m13:15:41.030675 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "node_id": "model.canal_brasil_dbt.canal_brasil_silver"} */

  
    

  create  table "postgres"."public"."canal_brasil_silver__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
  SELECT
    id,
    titulo,
    (data || ' ' || horario)::timestamp AS dia_hora,
    split_part(genero_ano, ' / ', 1) AS genero,
    sinopse,
    NULLIF(split_part(genero_ano, ' / ', 2), '') AS ano,
    NULLIF(split_part(genero_ano, ' / ', 3), '') AS nota_imdb
  FROM canal_brasil
)

SELECT 
  id,
  titulo,
  dia_hora,
  LEAD(dia_hora) OVER (ORDER BY dia_hora) - dia_hora AS duracao,
  genero,
  sinopse,
  ano,
  nota_imdb
FROM base
ORDER BY dia_hora;
  );
  
[0m13:15:41.128743 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 36: ORDER BY dia_hora;
                          ^

[0m13:15:41.129445 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: ROLLBACK
[0m13:15:41.225125 [debug] [Thread-1 (]: Timing info for model.canal_brasil_dbt.canal_brasil_silver (execute): 13:15:40.215759 => 13:15:41.224795
[0m13:15:41.225771 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: Close
[0m13:15:41.335117 [debug] [Thread-1 (]: Database Error in model canal_brasil_silver (models\canal_brasil_silver.sql)
  syntax error at or near ";"
  LINE 36: ORDER BY dia_hora;
                            ^
  compiled Code at target\run\canal_brasil_dbt\models\canal_brasil_silver.sql
[0m13:15:41.335642 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ab02f0b-55c9-4f3f-876f-948429271d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002015521D9D0>]}
[0m13:15:41.336207 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.canal_brasil_silver ............... [[31mERROR[0m in 1.13s]
[0m13:15:41.336999 [debug] [Thread-1 (]: Finished running node model.canal_brasil_dbt.canal_brasil_silver
[0m13:15:41.338892 [debug] [MainThread]: Using postgres connection "master"
[0m13:15:41.339211 [debug] [MainThread]: On master: BEGIN
[0m13:15:41.339494 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:15:42.263268 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m13:15:42.263653 [debug] [MainThread]: On master: COMMIT
[0m13:15:42.263951 [debug] [MainThread]: Using postgres connection "master"
[0m13:15:42.264238 [debug] [MainThread]: On master: COMMIT
[0m13:15:42.360946 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:15:42.361351 [debug] [MainThread]: On master: Close
[0m13:15:42.362126 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:15:42.362420 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m13:15:42.362740 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m13:15:42.363017 [debug] [MainThread]: Connection 'model.canal_brasil_dbt.canal_brasil_silver' was properly closed.
[0m13:15:42.363740 [info ] [MainThread]: 
[0m13:15:42.364210 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.34 seconds (5.34s).
[0m13:15:42.364968 [debug] [MainThread]: Command end result
[0m13:15:42.371542 [info ] [MainThread]: 
[0m13:15:42.372219 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:15:42.372876 [info ] [MainThread]: 
[0m13:15:42.373403 [error] [MainThread]:   Database Error in model canal_brasil_silver (models\canal_brasil_silver.sql)
  syntax error at or near ";"
  LINE 36: ORDER BY dia_hora;
                            ^
  compiled Code at target\run\canal_brasil_dbt\models\canal_brasil_silver.sql
[0m13:15:42.373922 [info ] [MainThread]: 
[0m13:15:42.374400 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:15:42.375482 [debug] [MainThread]: Command `dbt run` failed at 13:15:42.375342 after 5.78 seconds
[0m13:15:42.375845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020154BEFEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002014E1682D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002014E584410>]}
[0m13:15:42.376189 [debug] [MainThread]: Flushing usage events
[0m13:25:10.494047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022001355160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022003F7BD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022003F7B750>]}


============================== 13:25:10.497782 | 1dd6fcd6-4993-4d1f-976d-fbc47ef3920a ==============================
[0m13:25:10.497782 [info ] [MainThread]: Running with dbt=1.7.4
[0m13:25:10.498463 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --select canal_brasil_silver', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\Felli\\.code\\dbt\\canal_brasil_dbt\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Felli\\.dbt', 'introspect': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m13:25:10.687672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1dd6fcd6-4993-4d1f-976d-fbc47ef3920a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022003EB7100>]}
[0m13:25:10.772354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1dd6fcd6-4993-4d1f-976d-fbc47ef3920a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022003E4F020>]}
[0m13:25:10.773213 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m13:25:10.780092 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m13:25:10.833210 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:25:10.833762 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:25:10.834408 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.canal_brasil_dbt.example
[0m13:25:10.840147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1dd6fcd6-4993-4d1f-976d-fbc47ef3920a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220044A0950>]}
[0m13:25:10.848013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1dd6fcd6-4993-4d1f-976d-fbc47ef3920a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022003E57110>]}
[0m13:25:10.848484 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m13:25:10.849001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1dd6fcd6-4993-4d1f-976d-fbc47ef3920a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022004357BD0>]}
[0m13:25:10.850902 [info ] [MainThread]: 
[0m13:25:10.852077 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:25:10.853245 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:25:10.862134 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:25:10.862600 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:25:10.862923 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:25:11.799796 [debug] [ThreadPool]: SQL status: SELECT 20 in 1.0 seconds
[0m13:25:11.801536 [debug] [ThreadPool]: On list_postgres: Close
[0m13:25:11.803379 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m13:25:11.808145 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m13:25:11.808486 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m13:25:11.808772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:25:12.559784 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m13:25:12.560165 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m13:25:12.560475 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:25:12.654745 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m13:25:12.658740 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m13:25:12.764042 [debug] [ThreadPool]: On list_postgres_public: Close
[0m13:25:12.768674 [debug] [MainThread]: Using postgres connection "master"
[0m13:25:12.769037 [debug] [MainThread]: On master: BEGIN
[0m13:25:12.769317 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:25:13.507973 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m13:25:13.508393 [debug] [MainThread]: Using postgres connection "master"
[0m13:25:13.508794 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:25:13.616200 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m13:25:13.617802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1dd6fcd6-4993-4d1f-976d-fbc47ef3920a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022004499BF0>]}
[0m13:25:13.618321 [debug] [MainThread]: On master: ROLLBACK
[0m13:25:13.713205 [debug] [MainThread]: Using postgres connection "master"
[0m13:25:13.713606 [debug] [MainThread]: On master: BEGIN
[0m13:25:13.902008 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:25:13.902480 [debug] [MainThread]: On master: COMMIT
[0m13:25:13.903041 [debug] [MainThread]: Using postgres connection "master"
[0m13:25:13.903406 [debug] [MainThread]: On master: COMMIT
[0m13:25:13.997345 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:25:13.997736 [debug] [MainThread]: On master: Close
[0m13:25:13.998517 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:25:13.999011 [info ] [MainThread]: 
[0m13:25:14.002497 [debug] [Thread-1 (]: Began running node model.canal_brasil_dbt.canal_brasil_silver
[0m13:25:14.003018 [info ] [Thread-1 (]: 1 of 1 START sql table model public.canal_brasil_silver ........................ [RUN]
[0m13:25:14.003968 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.canal_brasil_dbt.canal_brasil_silver'
[0m13:25:14.004590 [debug] [Thread-1 (]: Began compiling node model.canal_brasil_dbt.canal_brasil_silver
[0m13:25:14.010526 [debug] [Thread-1 (]: Writing injected SQL for node "model.canal_brasil_dbt.canal_brasil_silver"
[0m13:25:14.011492 [debug] [Thread-1 (]: Timing info for model.canal_brasil_dbt.canal_brasil_silver (compile): 13:25:14.004941 => 13:25:14.011219
[0m13:25:14.011903 [debug] [Thread-1 (]: Began executing node model.canal_brasil_dbt.canal_brasil_silver
[0m13:25:14.052326 [debug] [Thread-1 (]: Writing runtime sql for node "model.canal_brasil_dbt.canal_brasil_silver"
[0m13:25:14.053530 [debug] [Thread-1 (]: Using postgres connection "model.canal_brasil_dbt.canal_brasil_silver"
[0m13:25:14.054158 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: BEGIN
[0m13:25:14.054745 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:25:14.815223 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m13:25:14.815651 [debug] [Thread-1 (]: Using postgres connection "model.canal_brasil_dbt.canal_brasil_silver"
[0m13:25:14.816014 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "node_id": "model.canal_brasil_dbt.canal_brasil_silver"} */

  
    

  create  table "postgres"."public"."canal_brasil_silver__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
  SELECT
    titulo,
    (data || ' ' || horario)::timestamp as dia_hora,
    split_part(genero_ano, ' / ', 1) AS genero,
    sinopse,
    NULLIF(split_part(genero_ano, ' / ', 2), '') AS ano,
    NULLIF(split_part(genero_ano, ' / ', 3), '') AS nota_imdb
  FROM canal_brasil
),
final AS (
  SELECT 
    titulo,
    ano,
    dia_hora,
    LEAD(dia_hora) OVER (ORDER BY dia_hora) - dia_hora AS duracao,
    genero,
    sinopse,
    nota_imdb
  FROM
    base
  ORDER BY 
    dia_hora
  )
  SELECT * FROM final
  WHERE dia_hora >= current_date
  );
  
[0m13:25:14.948954 [debug] [Thread-1 (]: SQL status: SELECT 146 in 0.0 seconds
[0m13:25:14.955779 [debug] [Thread-1 (]: Using postgres connection "model.canal_brasil_dbt.canal_brasil_silver"
[0m13:25:14.956197 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "node_id": "model.canal_brasil_dbt.canal_brasil_silver"} */
alter table "postgres"."public"."canal_brasil_silver__dbt_tmp" rename to "canal_brasil_silver"
[0m13:25:15.054705 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:25:15.078282 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: COMMIT
[0m13:25:15.079063 [debug] [Thread-1 (]: Using postgres connection "model.canal_brasil_dbt.canal_brasil_silver"
[0m13:25:15.079745 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: COMMIT
[0m13:25:15.178360 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:25:15.185716 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."canal_brasil_silver__dbt_backup"
[0m13:25:15.191007 [debug] [Thread-1 (]: Using postgres connection "model.canal_brasil_dbt.canal_brasil_silver"
[0m13:25:15.191423 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "node_id": "model.canal_brasil_dbt.canal_brasil_silver"} */
drop table if exists "postgres"."public"."canal_brasil_silver__dbt_backup" cascade
[0m13:25:15.288080 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:25:15.289674 [debug] [Thread-1 (]: Timing info for model.canal_brasil_dbt.canal_brasil_silver (execute): 13:25:14.012139 => 13:25:15.289440
[0m13:25:15.290091 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: Close
[0m13:25:15.290981 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dd6fcd6-4993-4d1f-976d-fbc47ef3920a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002200449D490>]}
[0m13:25:15.291526 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.canal_brasil_silver ................... [[32mSELECT 146[0m in 1.29s]
[0m13:25:15.292239 [debug] [Thread-1 (]: Finished running node model.canal_brasil_dbt.canal_brasil_silver
[0m13:25:15.293498 [debug] [MainThread]: Using postgres connection "master"
[0m13:25:15.293830 [debug] [MainThread]: On master: BEGIN
[0m13:25:15.294118 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:25:16.082103 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m13:25:16.082510 [debug] [MainThread]: On master: COMMIT
[0m13:25:16.083114 [debug] [MainThread]: Using postgres connection "master"
[0m13:25:16.083792 [debug] [MainThread]: On master: COMMIT
[0m13:25:16.178431 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:25:16.178892 [debug] [MainThread]: On master: Close
[0m13:25:16.180201 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:25:16.180802 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m13:25:16.181299 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m13:25:16.181855 [debug] [MainThread]: Connection 'model.canal_brasil_dbt.canal_brasil_silver' was properly closed.
[0m13:25:16.182555 [info ] [MainThread]: 
[0m13:25:16.183905 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.33 seconds (5.33s).
[0m13:25:16.185135 [debug] [MainThread]: Command end result
[0m13:25:16.193161 [info ] [MainThread]: 
[0m13:25:16.193976 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:25:16.194891 [info ] [MainThread]: 
[0m13:25:16.195865 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:25:16.197349 [debug] [MainThread]: Command `dbt run` succeeded at 13:25:16.197168 after 5.83 seconds
[0m13:25:16.197796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022003EAFEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220044ABD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022004396170>]}
[0m13:25:16.198186 [debug] [MainThread]: Flushing usage events
[0m13:35:23.377464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188F21E5160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188F4E1BD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188F4E1B750>]}


============================== 13:35:23.381082 | 8ef524e6-90b9-4beb-8f13-4dcecedfc771 ==============================
[0m13:35:23.381082 [info ] [MainThread]: Running with dbt=1.7.4
[0m13:35:23.381681 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --select canal_brasil_silver', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\Felli\\.code\\dbt\\canal_brasil_dbt\\logs', 'profiles_dir': 'C:\\Users\\Felli\\.dbt', 'cache_selected_only': 'False', 'introspect': 'True', 'use_colors': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m13:35:23.565951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ef524e6-90b9-4beb-8f13-4dcecedfc771', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188F4D53100>]}
[0m13:35:23.646156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ef524e6-90b9-4beb-8f13-4dcecedfc771', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188F4CEF020>]}
[0m13:35:23.647001 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m13:35:23.653800 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m13:35:23.709437 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:35:23.709952 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:35:23.710406 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.canal_brasil_dbt.example
[0m13:35:23.714929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ef524e6-90b9-4beb-8f13-4dcecedfc771', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188F5360950>]}
[0m13:35:23.723981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ef524e6-90b9-4beb-8f13-4dcecedfc771', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188F4CF7110>]}
[0m13:35:23.725151 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m13:35:23.725938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ef524e6-90b9-4beb-8f13-4dcecedfc771', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188F5213BD0>]}
[0m13:35:23.727783 [info ] [MainThread]: 
[0m13:35:23.728860 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:35:23.730639 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:35:23.740368 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:35:23.740956 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:35:23.741620 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:35:24.813626 [debug] [ThreadPool]: SQL status: SELECT 20 in 1.0 seconds
[0m13:35:24.814886 [debug] [ThreadPool]: On list_postgres: Close
[0m13:35:24.816818 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m13:35:24.821661 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m13:35:24.822015 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m13:35:24.822308 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:35:25.585781 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m13:35:25.586156 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m13:35:25.586462 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:35:25.680286 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m13:35:25.684227 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m13:35:25.776587 [debug] [ThreadPool]: On list_postgres_public: Close
[0m13:35:25.780534 [debug] [MainThread]: Using postgres connection "master"
[0m13:35:25.780881 [debug] [MainThread]: On master: BEGIN
[0m13:35:25.781164 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:35:26.540525 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m13:35:26.541253 [debug] [MainThread]: Using postgres connection "master"
[0m13:35:26.541619 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:35:26.647075 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m13:35:26.648213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ef524e6-90b9-4beb-8f13-4dcecedfc771', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188F5359BF0>]}
[0m13:35:26.648613 [debug] [MainThread]: On master: ROLLBACK
[0m13:35:26.741817 [debug] [MainThread]: Using postgres connection "master"
[0m13:35:26.742195 [debug] [MainThread]: On master: BEGIN
[0m13:35:26.929069 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:35:26.929455 [debug] [MainThread]: On master: COMMIT
[0m13:35:26.929750 [debug] [MainThread]: Using postgres connection "master"
[0m13:35:26.930035 [debug] [MainThread]: On master: COMMIT
[0m13:35:27.020451 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:35:27.020836 [debug] [MainThread]: On master: Close
[0m13:35:27.021626 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:35:27.022184 [info ] [MainThread]: 
[0m13:35:27.025317 [debug] [Thread-1 (]: Began running node model.canal_brasil_dbt.canal_brasil_silver
[0m13:35:27.025871 [info ] [Thread-1 (]: 1 of 1 START sql table model public.canal_brasil_silver ........................ [RUN]
[0m13:35:27.026766 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.canal_brasil_dbt.canal_brasil_silver'
[0m13:35:27.027121 [debug] [Thread-1 (]: Began compiling node model.canal_brasil_dbt.canal_brasil_silver
[0m13:35:27.032681 [debug] [Thread-1 (]: Writing injected SQL for node "model.canal_brasil_dbt.canal_brasil_silver"
[0m13:35:27.033701 [debug] [Thread-1 (]: Timing info for model.canal_brasil_dbt.canal_brasil_silver (compile): 13:35:27.027344 => 13:35:27.033338
[0m13:35:27.034140 [debug] [Thread-1 (]: Began executing node model.canal_brasil_dbt.canal_brasil_silver
[0m13:35:27.070222 [debug] [Thread-1 (]: Writing runtime sql for node "model.canal_brasil_dbt.canal_brasil_silver"
[0m13:35:27.071101 [debug] [Thread-1 (]: Using postgres connection "model.canal_brasil_dbt.canal_brasil_silver"
[0m13:35:27.071486 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: BEGIN
[0m13:35:27.071828 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:35:27.811529 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m13:35:27.811945 [debug] [Thread-1 (]: Using postgres connection "model.canal_brasil_dbt.canal_brasil_silver"
[0m13:35:27.812303 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "node_id": "model.canal_brasil_dbt.canal_brasil_silver"} */

  
    

  create  table "postgres"."public"."canal_brasil_silver__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
  SELECT
    titulo,
    (data || ' ' || horario)::timestamp as dia_hora,
    split_part(genero_ano, ' / ', 1) AS genero,
    sinopse,
    NULLIF(split_part(genero_ano, ' / ', 2), '') AS ano,
    NULLIF(split_part(genero_ano, ' / ', 3), '') AS nota_imdb
  FROM canal_brasil
),
final AS (
  SELECT 
    titulo,
    ano,
    dia_hora,
    LEAD(dia_hora) OVER (ORDER BY dia_hora) - dia_hora AS duracao,
    genero,
    sinopse,
    nota_imdb
  FROM
    base
  ORDER BY 
    dia_hora
  )
  SELECT * FROM final
--   WHERE dia_hora >= current_date
ORDER BY dia_hora
  );
  
[0m13:35:27.933567 [debug] [Thread-1 (]: SQL status: SELECT 215 in 0.0 seconds
[0m13:35:27.939161 [debug] [Thread-1 (]: Using postgres connection "model.canal_brasil_dbt.canal_brasil_silver"
[0m13:35:27.939591 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "node_id": "model.canal_brasil_dbt.canal_brasil_silver"} */
alter table "postgres"."public"."canal_brasil_silver__dbt_tmp" rename to "canal_brasil_silver"
[0m13:35:28.031338 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:35:28.047779 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: COMMIT
[0m13:35:28.048360 [debug] [Thread-1 (]: Using postgres connection "model.canal_brasil_dbt.canal_brasil_silver"
[0m13:35:28.048726 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: COMMIT
[0m13:35:28.141634 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:35:28.147097 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."canal_brasil_silver__dbt_backup"
[0m13:35:28.151793 [debug] [Thread-1 (]: Using postgres connection "model.canal_brasil_dbt.canal_brasil_silver"
[0m13:35:28.152199 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "node_id": "model.canal_brasil_dbt.canal_brasil_silver"} */
drop table if exists "postgres"."public"."canal_brasil_silver__dbt_backup" cascade
[0m13:35:28.245462 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:35:28.246942 [debug] [Thread-1 (]: Timing info for model.canal_brasil_dbt.canal_brasil_silver (execute): 13:35:27.034377 => 13:35:28.246721
[0m13:35:28.247289 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: Close
[0m13:35:28.248071 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ef524e6-90b9-4beb-8f13-4dcecedfc771', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188F535C650>]}
[0m13:35:28.248631 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.canal_brasil_silver ................... [[32mSELECT 215[0m in 1.22s]
[0m13:35:28.249479 [debug] [Thread-1 (]: Finished running node model.canal_brasil_dbt.canal_brasil_silver
[0m13:35:28.250855 [debug] [MainThread]: Using postgres connection "master"
[0m13:35:28.251169 [debug] [MainThread]: On master: BEGIN
[0m13:35:28.251449 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:35:29.021819 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m13:35:29.022197 [debug] [MainThread]: On master: COMMIT
[0m13:35:29.022486 [debug] [MainThread]: Using postgres connection "master"
[0m13:35:29.022834 [debug] [MainThread]: On master: COMMIT
[0m13:35:29.117697 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:35:29.118083 [debug] [MainThread]: On master: Close
[0m13:35:29.118812 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:35:29.119098 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m13:35:29.119372 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m13:35:29.119636 [debug] [MainThread]: Connection 'model.canal_brasil_dbt.canal_brasil_silver' was properly closed.
[0m13:35:29.119951 [info ] [MainThread]: 
[0m13:35:29.120454 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.39 seconds (5.39s).
[0m13:35:29.121316 [debug] [MainThread]: Command end result
[0m13:35:29.129224 [info ] [MainThread]: 
[0m13:35:29.130111 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:35:29.130978 [info ] [MainThread]: 
[0m13:35:29.131619 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:35:29.132848 [debug] [MainThread]: Command `dbt run` succeeded at 13:35:29.132694 after 5.87 seconds
[0m13:35:29.133334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188F4D4FEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188EE6B4410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188EE2982D0>]}
[0m13:35:29.133680 [debug] [MainThread]: Flushing usage events
[0m16:50:06.359578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7DE9E5400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7DE536710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7E162FED0>]}


============================== 16:50:06.363439 | d9b0e81b-3b9c-488b-bffe-e3b9eca2d166 ==============================
[0m16:50:06.363439 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:50:06.363970 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt ', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'c:\\Users\\Felli\\.code\\dbt\\canal_brasil_dbt\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Felli\\.dbt', 'introspect': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m16:50:06.468381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9b0e81b-3b9c-488b-bffe-e3b9eca2d166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7E1575220>]}
[0m16:50:06.469182 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:50:06.470396 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:50:06.471930 [debug] [MainThread]: Command `cli deps` succeeded at 16:50:06.471756 after 0.20 seconds
[0m16:50:06.472282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7E1503F00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7E1503DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7E0D89050>]}
[0m16:50:06.472672 [debug] [MainThread]: Flushing usage events
[0m20:20:53.909005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD17275400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD16DC6710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD19ECFED0>]}


============================== 20:20:53.915127 | f5b50b2a-95d0-460c-84a1-5f1784c04b64 ==============================
[0m20:20:53.915127 [info ] [MainThread]: Running with dbt=1.7.4
[0m20:20:53.916247 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt ', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'c:\\Users\\Felli\\.code\\dbt\\canal_brasil_dbt\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Felli\\.dbt', 'introspect': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m20:20:54.042189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5b50b2a-95d0-460c-84a1-5f1784c04b64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD19E15220>]}
[0m20:20:54.043293 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m20:20:54.045253 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m20:20:54.046723 [debug] [MainThread]: Command `cli deps` succeeded at 20:20:54.046538 after 0.27 seconds
[0m20:20:54.047082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD19DA3F00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD19DA3DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD19629050>]}
[0m20:20:54.047412 [debug] [MainThread]: Flushing usage events
[0m23:53:05.980238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA9D021400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA9CB66710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA9FC5FED0>]}


============================== 23:53:05.984517 | d8c865c1-0bc6-461a-936d-5deff5773877 ==============================
[0m23:53:05.984517 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:53:05.985200 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt ', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'c:\\Users\\Felli\\.code\\dbt\\canal_brasil_dbt\\logs', 'warn_error': 'None', 'write_json': 'True', 'introspect': 'True', 'profiles_dir': 'C:\\Users\\Felli\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m23:53:06.104850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd8c865c1-0bc6-461a-936d-5deff5773877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA9FBA5220>]}
[0m23:53:06.106217 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:53:06.107641 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:53:06.109093 [debug] [MainThread]: Command `cli deps` succeeded at 23:53:06.108885 after 0.24 seconds
[0m23:53:06.109489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA9FB33F00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA9FB33DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA9F3B9050>]}
[0m23:53:06.109884 [debug] [MainThread]: Flushing usage events
[0m11:10:57.121819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020ACDFE5400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020ACDB36710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AD0C2FED0>]}


============================== 11:10:57.125697 | ed947a51-7618-4d94-af5c-6844072a5280 ==============================
[0m11:10:57.125697 [info ] [MainThread]: Running with dbt=1.7.4
[0m11:10:57.126222 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt ', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'c:\\Users\\Felli\\.code\\dbt\\canal_brasil_dbt\\logs', 'profiles_dir': 'C:\\Users\\Felli\\.dbt', 'warn_error': 'None', 'introspect': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m11:10:57.239966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed947a51-7618-4d94-af5c-6844072a5280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AD0B79220>]}
[0m11:10:57.240962 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:10:57.242210 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:10:57.243502 [debug] [MainThread]: Command `cli deps` succeeded at 11:10:57.243329 after 0.21 seconds
[0m11:10:57.243858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AD0B03F00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AD0B03DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AD0389050>]}
[0m11:10:57.244193 [debug] [MainThread]: Flushing usage events
[0m12:46:59.432090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F143A65160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1466ABED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1466ABC50>]}


============================== 12:46:59.435647 | a6ba1bb3-60eb-471e-a0f1-90fe0e000270 ==============================
[0m12:46:59.435647 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:46:59.436292 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt debug', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\Felli\\.code\\dbt\\canal_brasil_dbt\\logs', 'profiles_dir': 'C:\\Users\\Felli\\.dbt', 'warn_error': 'None', 'introspect': 'True', 'use_colors': 'True', 'write_json': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m12:46:59.436834 [info ] [MainThread]: dbt version: 1.7.4
[0m12:46:59.437292 [info ] [MainThread]: python version: 3.13.3
[0m12:46:59.437704 [info ] [MainThread]: python path: c:\Users\Felli\.code\.venv\Scripts\python.exe
[0m12:46:59.438127 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m12:46:59.520133 [info ] [MainThread]: Using profiles dir at C:\Users\Felli\.dbt
[0m12:46:59.520683 [info ] [MainThread]: Using profiles.yml file at C:\Users\Felli\.dbt\profiles.yml
[0m12:46:59.521090 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Felli\.code\dbt\canal_brasil_dbt\dbt_project.yml
[0m12:46:59.521868 [info ] [MainThread]: adapter type: postgres
[0m12:46:59.522294 [info ] [MainThread]: adapter version: 1.7.4
[0m12:46:59.592122 [info ] [MainThread]: Configuration:
[0m12:46:59.592658 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:46:59.593070 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:46:59.593528 [info ] [MainThread]: Required dependencies:
[0m12:46:59.594024 [debug] [MainThread]: Executing "git --help"
[0m12:46:59.621067 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:46:59.621871 [debug] [MainThread]: STDERR: "b''"
[0m12:46:59.622245 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:46:59.622680 [info ] [MainThread]: Connection:
[0m12:46:59.623056 [info ] [MainThread]:   host: aws-0-sa-east-1.pooler.supabase.com
[0m12:46:59.623436 [info ] [MainThread]:   port: 6543
[0m12:46:59.623879 [info ] [MainThread]:   user: postgres.ozadowjafypabbrltwoy
[0m12:46:59.624317 [info ] [MainThread]:   database: postgres
[0m12:46:59.624721 [info ] [MainThread]:   schema: public
[0m12:46:59.625106 [info ] [MainThread]:   connect_timeout: 60
[0m12:46:59.625461 [info ] [MainThread]:   role: None
[0m12:46:59.625798 [info ] [MainThread]:   search_path: None
[0m12:46:59.626136 [info ] [MainThread]:   keepalives_idle: 0
[0m12:46:59.626472 [info ] [MainThread]:   sslmode: require
[0m12:46:59.626806 [info ] [MainThread]:   sslcert: None
[0m12:46:59.627142 [info ] [MainThread]:   sslkey: None
[0m12:46:59.627479 [info ] [MainThread]:   sslrootcert: None
[0m12:46:59.627877 [info ] [MainThread]:   application_name: dbt
[0m12:46:59.628271 [info ] [MainThread]:   retries: 1
[0m12:46:59.628670 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m12:46:59.629233 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:46:59.629579 [debug] [MainThread]: Using postgres connection "debug"
[0m12:46:59.629881 [debug] [MainThread]: On debug: select 1 as id
[0m12:46:59.630168 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:47:00.761904 [debug] [MainThread]: SQL status: SELECT 1 in 1.0 seconds
[0m12:47:00.762796 [debug] [MainThread]: On debug: Close
[0m12:47:00.763260 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:47:00.763766 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:47:00.764966 [debug] [MainThread]: Command `dbt debug` succeeded at 12:47:00.764803 after 1.44 seconds
[0m12:47:00.765301 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:47:00.765630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F13FA869E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1469C28D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F14657F020>]}
[0m12:47:00.765987 [debug] [MainThread]: Flushing usage events
[0m12:47:30.215497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A52855160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A5548BD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A5548B750>]}


============================== 12:47:30.219498 | 4378511b-71ed-47f6-8b65-3bdb70ab6013 ==============================
[0m12:47:30.219498 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:47:30.220163 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --select canal_brasil_silver', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\Felli\\.code\\dbt\\canal_brasil_dbt\\logs', 'warn_error': 'None', 'write_json': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Felli\\.dbt', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m12:47:30.416516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4378511b-71ed-47f6-8b65-3bdb70ab6013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A553C3100>]}
[0m12:47:30.496088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4378511b-71ed-47f6-8b65-3bdb70ab6013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A5535F020>]}
[0m12:47:30.497052 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m12:47:30.504174 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:47:30.558338 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:47:30.558710 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:47:30.559153 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.canal_brasil_dbt.example
[0m12:47:30.563790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4378511b-71ed-47f6-8b65-3bdb70ab6013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A55910950>]}
[0m12:47:30.572994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4378511b-71ed-47f6-8b65-3bdb70ab6013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A55367110>]}
[0m12:47:30.573501 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m12:47:30.574023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4378511b-71ed-47f6-8b65-3bdb70ab6013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A557C7BD0>]}
[0m12:47:30.575610 [info ] [MainThread]: 
[0m12:47:30.576691 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:47:30.578102 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m12:47:30.588145 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m12:47:30.588516 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m12:47:30.588834 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:47:31.474439 [debug] [ThreadPool]: SQL status: SELECT 22 in 1.0 seconds
[0m12:47:31.475652 [debug] [ThreadPool]: On list_postgres: Close
[0m12:47:31.477307 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m12:47:31.481908 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m12:47:31.482236 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m12:47:31.482521 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:47:32.280916 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m12:47:32.281292 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m12:47:32.281594 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:47:32.378525 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m12:47:32.383066 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m12:47:32.498207 [debug] [ThreadPool]: On list_postgres_public: Close
[0m12:47:32.502151 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:32.502492 [debug] [MainThread]: On master: BEGIN
[0m12:47:32.502772 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:47:33.562167 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m12:47:33.562545 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:33.562889 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:47:33.727039 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m12:47:33.728178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4378511b-71ed-47f6-8b65-3bdb70ab6013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A55909BF0>]}
[0m12:47:33.728635 [debug] [MainThread]: On master: ROLLBACK
[0m12:47:33.843766 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:33.844137 [debug] [MainThread]: On master: BEGIN
[0m12:47:34.073439 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:47:34.073816 [debug] [MainThread]: On master: COMMIT
[0m12:47:34.074105 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:34.074403 [debug] [MainThread]: On master: COMMIT
[0m12:47:34.189244 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:47:34.189626 [debug] [MainThread]: On master: Close
[0m12:47:34.190387 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:47:34.190906 [info ] [MainThread]: 
[0m12:47:34.195029 [debug] [Thread-1 (]: Began running node model.canal_brasil_dbt.canal_brasil_silver
[0m12:47:34.195622 [info ] [Thread-1 (]: 1 of 1 START sql table model public.canal_brasil_silver ........................ [RUN]
[0m12:47:34.196781 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.canal_brasil_dbt.canal_brasil_silver'
[0m12:47:34.197337 [debug] [Thread-1 (]: Began compiling node model.canal_brasil_dbt.canal_brasil_silver
[0m12:47:34.204173 [debug] [Thread-1 (]: Writing injected SQL for node "model.canal_brasil_dbt.canal_brasil_silver"
[0m12:47:34.205634 [debug] [Thread-1 (]: Timing info for model.canal_brasil_dbt.canal_brasil_silver (compile): 12:47:34.197653 => 12:47:34.205244
[0m12:47:34.206097 [debug] [Thread-1 (]: Began executing node model.canal_brasil_dbt.canal_brasil_silver
[0m12:47:34.242291 [debug] [Thread-1 (]: Writing runtime sql for node "model.canal_brasil_dbt.canal_brasil_silver"
[0m12:47:34.243754 [debug] [Thread-1 (]: Using postgres connection "model.canal_brasil_dbt.canal_brasil_silver"
[0m12:47:34.244165 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: BEGIN
[0m12:47:34.244496 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:47:35.076980 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m12:47:35.077408 [debug] [Thread-1 (]: Using postgres connection "model.canal_brasil_dbt.canal_brasil_silver"
[0m12:47:35.077792 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "node_id": "model.canal_brasil_dbt.canal_brasil_silver"} */

  
    

  create  table "postgres"."public"."canal_brasil_silver__dbt_tmp"
  
  
    as
  
  (
    

WITH ajustado AS ( -- no script o calendario do dia vai até as 6h do dia seguinte; aqui se corrige isso
  SELECT
    *,
    CASE
      WHEN horario::time < '05:00:00' THEN data::date + INTERVAL '1 day'
      ELSE data::date
    END AS data_ajustada
  FROM canal_brasil
),
com_lag AS (
  SELECT
    *,
    LAG(titulo) OVER (ORDER BY data_ajustada, horario) AS titulo_ant,
    LAG(horario) OVER (ORDER BY data_ajustada, horario) AS horario_ant,
    LAG(data_ajustada) OVER (ORDER BY data_ajustada, horario) AS data_ant
  FROM ajustado
),
-- filtra duplicatas (programas consecutivos por dia e horário)
sem_duplicatas AS (
  SELECT *
  FROM com_lag
  WHERE NOT (
    titulo = titulo_ant AND
    horario = horario_ant AND
    data_ajustada = data_ant
  )
),
df_estrutura AS (
  SELECT
    titulo,
    data_ajustada AS data,
    horario,
    genero_ano,
    sinopse
  FROM sem_duplicatas
  ORDER BY data, horario
),
base AS (
  SELECT
    titulo,
    (data::date || ' ' || horario)::timestamp AS dia_hora,
    split_part(genero_ano, ' / ', 1) AS genero,
    sinopse,
    NULLIF(split_part(genero_ano, ' / ', 2), '') AS ano,
    NULLIF(split_part(genero_ano, ' / ', 3), '') AS nota_imdb
  FROM df_estrutura
),
final AS (
  SELECT
    titulo,
    ano,
    dia_hora,
    LEAD(dia_hora) OVER (ORDER BY dia_hora) - dia_hora AS duracao,
    genero,
    sinopse,
    nota_imdb
  FROM base
  ORDER BY dia_hora
)
SELECT distinct date(dia_hora)
FROM final
WHERE dia_hora >= current_date
  );
  
[0m12:47:35.240820 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.0 seconds
[0m12:47:35.247675 [debug] [Thread-1 (]: Using postgres connection "model.canal_brasil_dbt.canal_brasil_silver"
[0m12:47:35.248099 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "node_id": "model.canal_brasil_dbt.canal_brasil_silver"} */
alter table "postgres"."public"."canal_brasil_silver__dbt_tmp" rename to "canal_brasil_silver"
[0m12:47:35.342906 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:47:35.358762 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: COMMIT
[0m12:47:35.359182 [debug] [Thread-1 (]: Using postgres connection "model.canal_brasil_dbt.canal_brasil_silver"
[0m12:47:35.359531 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: COMMIT
[0m12:47:35.502690 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:47:35.509348 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."canal_brasil_silver__dbt_backup"
[0m12:47:35.513868 [debug] [Thread-1 (]: Using postgres connection "model.canal_brasil_dbt.canal_brasil_silver"
[0m12:47:35.514271 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "node_id": "model.canal_brasil_dbt.canal_brasil_silver"} */
drop table if exists "postgres"."public"."canal_brasil_silver__dbt_backup" cascade
[0m12:47:35.609765 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:47:35.611239 [debug] [Thread-1 (]: Timing info for model.canal_brasil_dbt.canal_brasil_silver (execute): 12:47:34.206336 => 12:47:35.611016
[0m12:47:35.611588 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: Close
[0m12:47:35.612388 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4378511b-71ed-47f6-8b65-3bdb70ab6013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A5590C650>]}
[0m12:47:35.612916 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.canal_brasil_silver ................... [[32mSELECT 7[0m in 1.42s]
[0m12:47:35.614132 [debug] [Thread-1 (]: Finished running node model.canal_brasil_dbt.canal_brasil_silver
[0m12:47:35.615502 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:35.615865 [debug] [MainThread]: On master: BEGIN
[0m12:47:35.616295 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:47:36.574046 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m12:47:36.574421 [debug] [MainThread]: On master: COMMIT
[0m12:47:36.574710 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:36.574991 [debug] [MainThread]: On master: COMMIT
[0m12:47:36.679436 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:47:36.679911 [debug] [MainThread]: On master: Close
[0m12:47:36.680819 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:47:36.681351 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m12:47:36.681872 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m12:47:36.682193 [debug] [MainThread]: Connection 'model.canal_brasil_dbt.canal_brasil_silver' was properly closed.
[0m12:47:36.682848 [info ] [MainThread]: 
[0m12:47:36.683564 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.11 seconds (6.11s).
[0m12:47:36.684640 [debug] [MainThread]: Command end result
[0m12:47:36.693526 [info ] [MainThread]: 
[0m12:47:36.694461 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:47:36.695241 [info ] [MainThread]: 
[0m12:47:36.695911 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:47:36.697229 [debug] [MainThread]: Command `dbt run` succeeded at 12:47:36.697058 after 6.56 seconds
[0m12:47:36.697595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A553BFEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A4ED24410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A4E9082D0>]}
[0m12:47:36.698038 [debug] [MainThread]: Flushing usage events
[0m12:49:25.613396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258260B5160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025828CFBD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025828CFB750>]}


============================== 12:49:25.617879 | c6eb3a19-e4b9-4633-a023-c4985c355a93 ==============================
[0m12:49:25.617879 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:49:25.618630 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --select canal_brasil_silver', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\Felli\\.code\\dbt\\canal_brasil_dbt\\logs', 'profiles_dir': 'C:\\Users\\Felli\\.dbt', 'warn_error': 'None', 'introspect': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m12:49:25.847787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c6eb3a19-e4b9-4633-a023-c4985c355a93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025828C33100>]}
[0m12:49:25.926630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c6eb3a19-e4b9-4633-a023-c4985c355a93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025828BCF020>]}
[0m12:49:25.927557 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m12:49:25.934391 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:49:26.005873 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:49:26.006212 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:49:26.006646 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.canal_brasil_dbt.example
[0m12:49:26.011064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6eb3a19-e4b9-4633-a023-c4985c355a93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258291F0950>]}
[0m12:49:26.019195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6eb3a19-e4b9-4633-a023-c4985c355a93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025828BD7110>]}
[0m12:49:26.019651 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m12:49:26.020183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6eb3a19-e4b9-4633-a023-c4985c355a93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258290A7BD0>]}
[0m12:49:26.021997 [info ] [MainThread]: 
[0m12:49:26.023022 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:49:26.024259 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m12:49:26.033065 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m12:49:26.033600 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m12:49:26.033954 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:49:27.053911 [debug] [ThreadPool]: SQL status: SELECT 22 in 1.0 seconds
[0m12:49:27.055128 [debug] [ThreadPool]: On list_postgres: Close
[0m12:49:27.057001 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m12:49:27.063120 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m12:49:27.063521 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m12:49:27.063809 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:49:27.951081 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m12:49:27.951466 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m12:49:27.951771 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:49:28.066847 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m12:49:28.070891 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m12:49:28.181384 [debug] [ThreadPool]: On list_postgres_public: Close
[0m12:49:28.185295 [debug] [MainThread]: Using postgres connection "master"
[0m12:49:28.185637 [debug] [MainThread]: On master: BEGIN
[0m12:49:28.185917 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:49:28.892939 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m12:49:28.893324 [debug] [MainThread]: Using postgres connection "master"
[0m12:49:28.893675 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:49:29.000540 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m12:49:29.001658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6eb3a19-e4b9-4633-a023-c4985c355a93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258291E9BF0>]}
[0m12:49:29.002043 [debug] [MainThread]: On master: ROLLBACK
[0m12:49:29.091270 [debug] [MainThread]: Using postgres connection "master"
[0m12:49:29.091739 [debug] [MainThread]: On master: BEGIN
[0m12:49:29.270530 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:49:29.270917 [debug] [MainThread]: On master: COMMIT
[0m12:49:29.271206 [debug] [MainThread]: Using postgres connection "master"
[0m12:49:29.271486 [debug] [MainThread]: On master: COMMIT
[0m12:49:29.361021 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:49:29.361408 [debug] [MainThread]: On master: Close
[0m12:49:29.362250 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:49:29.362811 [info ] [MainThread]: 
[0m12:49:29.365720 [debug] [Thread-1 (]: Began running node model.canal_brasil_dbt.canal_brasil_silver
[0m12:49:29.366192 [info ] [Thread-1 (]: 1 of 1 START sql table model public.canal_brasil_silver ........................ [RUN]
[0m12:49:29.367198 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.canal_brasil_dbt.canal_brasil_silver'
[0m12:49:29.367641 [debug] [Thread-1 (]: Began compiling node model.canal_brasil_dbt.canal_brasil_silver
[0m12:49:29.373364 [debug] [Thread-1 (]: Writing injected SQL for node "model.canal_brasil_dbt.canal_brasil_silver"
[0m12:49:29.374410 [debug] [Thread-1 (]: Timing info for model.canal_brasil_dbt.canal_brasil_silver (compile): 12:49:29.367887 => 12:49:29.374036
[0m12:49:29.374879 [debug] [Thread-1 (]: Began executing node model.canal_brasil_dbt.canal_brasil_silver
[0m12:49:29.412579 [debug] [Thread-1 (]: Writing runtime sql for node "model.canal_brasil_dbt.canal_brasil_silver"
[0m12:49:29.413474 [debug] [Thread-1 (]: Using postgres connection "model.canal_brasil_dbt.canal_brasil_silver"
[0m12:49:29.413862 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: BEGIN
[0m12:49:29.414206 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:49:30.284120 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m12:49:30.284710 [debug] [Thread-1 (]: Using postgres connection "model.canal_brasil_dbt.canal_brasil_silver"
[0m12:49:30.285148 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "node_id": "model.canal_brasil_dbt.canal_brasil_silver"} */

  
    

  create  table "postgres"."public"."canal_brasil_silver__dbt_tmp"
  
  
    as
  
  (
    

WITH ajustado AS ( -- no script o calendario do dia vai até as 6h do dia seguinte; aqui se corrige isso
  SELECT
    *,
    CASE
      WHEN horario::time < '05:00:00' THEN data::date + INTERVAL '1 day'
      ELSE data::date
    END AS data_ajustada
  FROM canal_brasil
),
com_lag AS (
  SELECT
    *,
    LAG(titulo) OVER (ORDER BY data_ajustada, horario) AS titulo_ant,
    LAG(horario) OVER (ORDER BY data_ajustada, horario) AS horario_ant,
    LAG(data_ajustada) OVER (ORDER BY data_ajustada, horario) AS data_ant
  FROM ajustado
),
-- filtra duplicatas (programas consecutivos por dia e horário)
sem_duplicatas AS (
  SELECT *
  FROM com_lag
  WHERE NOT (
    titulo = titulo_ant AND
    horario = horario_ant AND
    data_ajustada = data_ant
  )
),
df_estrutura AS (
  SELECT
    titulo,
    data_ajustada AS data,
    horario,
    genero_ano,
    sinopse
  FROM sem_duplicatas
  ORDER BY data, horario
),
base AS (
  SELECT
    titulo,
    (data::date || ' ' || horario)::timestamp AS dia_hora,
    split_part(genero_ano, ' / ', 1) AS genero,
    sinopse,
    NULLIF(split_part(genero_ano, ' / ', 2), '') AS ano,
    NULLIF(split_part(genero_ano, ' / ', 3), '') AS nota_imdb
  FROM df_estrutura
),
final AS (
  SELECT
    titulo,
    ano,
    dia_hora,
    LEAD(dia_hora) OVER (ORDER BY dia_hora) - dia_hora AS duracao,
    genero,
    sinopse,
    nota_imdb
  FROM base
  ORDER BY dia_hora
)
SELECT distinct date(dia_hora)
FROM final
WHERE dia_hora >= current_date
  );
  
[0m12:49:30.423299 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.0 seconds
[0m12:49:30.428648 [debug] [Thread-1 (]: Using postgres connection "model.canal_brasil_dbt.canal_brasil_silver"
[0m12:49:30.429031 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "node_id": "model.canal_brasil_dbt.canal_brasil_silver"} */
alter table "postgres"."public"."canal_brasil_silver__dbt_tmp" rename to "canal_brasil_silver"
[0m12:49:30.536162 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:49:30.552407 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: COMMIT
[0m12:49:30.552874 [debug] [Thread-1 (]: Using postgres connection "model.canal_brasil_dbt.canal_brasil_silver"
[0m12:49:30.553233 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: COMMIT
[0m12:49:30.660547 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:49:30.666590 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."canal_brasil_silver__dbt_backup"
[0m12:49:30.671788 [debug] [Thread-1 (]: Using postgres connection "model.canal_brasil_dbt.canal_brasil_silver"
[0m12:49:30.672211 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "node_id": "model.canal_brasil_dbt.canal_brasil_silver"} */
drop table if exists "postgres"."public"."canal_brasil_silver__dbt_backup" cascade
[0m12:49:30.781070 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:49:30.782569 [debug] [Thread-1 (]: Timing info for model.canal_brasil_dbt.canal_brasil_silver (execute): 12:49:29.375112 => 12:49:30.782339
[0m12:49:30.782924 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: Close
[0m12:49:30.783729 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6eb3a19-e4b9-4633-a023-c4985c355a93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258291EC650>]}
[0m12:49:30.784248 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.canal_brasil_silver ................... [[32mSELECT 7[0m in 1.42s]
[0m12:49:30.785074 [debug] [Thread-1 (]: Finished running node model.canal_brasil_dbt.canal_brasil_silver
[0m12:49:30.786388 [debug] [MainThread]: Using postgres connection "master"
[0m12:49:30.786699 [debug] [MainThread]: On master: BEGIN
[0m12:49:30.786981 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:49:31.538803 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m12:49:31.539183 [debug] [MainThread]: On master: COMMIT
[0m12:49:31.539470 [debug] [MainThread]: Using postgres connection "master"
[0m12:49:31.539749 [debug] [MainThread]: On master: COMMIT
[0m12:49:31.639087 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:49:31.639477 [debug] [MainThread]: On master: Close
[0m12:49:31.640242 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:49:31.640559 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m12:49:31.640833 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m12:49:31.641095 [debug] [MainThread]: Connection 'model.canal_brasil_dbt.canal_brasil_silver' was properly closed.
[0m12:49:31.641413 [info ] [MainThread]: 
[0m12:49:31.641839 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.62 seconds (5.62s).
[0m12:49:31.642632 [debug] [MainThread]: Command end result
[0m12:49:31.649573 [info ] [MainThread]: 
[0m12:49:31.650428 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:49:31.650982 [info ] [MainThread]: 
[0m12:49:31.651471 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:49:31.652685 [debug] [MainThread]: Command `dbt run` succeeded at 12:49:31.652510 after 6.21 seconds
[0m12:49:31.653067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025828C2FEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025822544410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258221282D0>]}
[0m12:49:31.653483 [debug] [MainThread]: Flushing usage events
[0m12:50:34.615884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276042F5160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027606F2BD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027606F2B750>]}


============================== 12:50:34.622190 | 1aedf90e-315e-475f-ab73-c688b1100ac5 ==============================
[0m12:50:34.622190 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:50:34.623413 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --select canal_brasil_silver', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\Felli\\.code\\dbt\\canal_brasil_dbt\\logs', 'profiles_dir': 'C:\\Users\\Felli\\.dbt', 'use_colors': 'True', 'introspect': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m12:50:34.926522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1aedf90e-315e-475f-ab73-c688b1100ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027606E63100>]}
[0m12:50:35.014782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1aedf90e-315e-475f-ab73-c688b1100ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027606DFF020>]}
[0m12:50:35.016477 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m12:50:35.024216 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:50:35.091490 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:50:35.091873 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:50:35.092322 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.canal_brasil_dbt.example
[0m12:50:35.099900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1aedf90e-315e-475f-ab73-c688b1100ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276074A0950>]}
[0m12:50:35.109998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1aedf90e-315e-475f-ab73-c688b1100ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027606E07110>]}
[0m12:50:35.110507 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m12:50:35.111029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1aedf90e-315e-475f-ab73-c688b1100ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027607353BD0>]}
[0m12:50:35.112548 [info ] [MainThread]: 
[0m12:50:35.113492 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:50:35.114863 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m12:50:35.125903 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m12:50:35.126292 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m12:50:35.126591 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:50:35.958614 [debug] [ThreadPool]: SQL status: SELECT 22 in 1.0 seconds
[0m12:50:35.959820 [debug] [ThreadPool]: On list_postgres: Close
[0m12:50:35.961524 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m12:50:35.967630 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m12:50:35.968103 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m12:50:35.968421 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:50:36.719962 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m12:50:36.720340 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m12:50:36.720641 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:50:36.815182 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m12:50:36.819762 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m12:50:36.911469 [debug] [ThreadPool]: On list_postgres_public: Close
[0m12:50:36.916534 [debug] [MainThread]: Using postgres connection "master"
[0m12:50:36.917118 [debug] [MainThread]: On master: BEGIN
[0m12:50:36.917515 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:50:37.845800 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m12:50:37.846176 [debug] [MainThread]: Using postgres connection "master"
[0m12:50:37.846529 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:50:37.977112 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m12:50:37.978231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1aedf90e-315e-475f-ab73-c688b1100ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027607499BF0>]}
[0m12:50:37.978616 [debug] [MainThread]: On master: ROLLBACK
[0m12:50:38.091316 [debug] [MainThread]: Using postgres connection "master"
[0m12:50:38.091697 [debug] [MainThread]: On master: BEGIN
[0m12:50:38.330102 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:50:38.330488 [debug] [MainThread]: On master: COMMIT
[0m12:50:38.330780 [debug] [MainThread]: Using postgres connection "master"
[0m12:50:38.331115 [debug] [MainThread]: On master: COMMIT
[0m12:50:38.446813 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:50:38.447412 [debug] [MainThread]: On master: Close
[0m12:50:38.448849 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:50:38.449641 [info ] [MainThread]: 
[0m12:50:38.453216 [debug] [Thread-1 (]: Began running node model.canal_brasil_dbt.canal_brasil_silver
[0m12:50:38.454059 [info ] [Thread-1 (]: 1 of 1 START sql table model public.canal_brasil_silver ........................ [RUN]
[0m12:50:38.456068 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.canal_brasil_dbt.canal_brasil_silver'
[0m12:50:38.456895 [debug] [Thread-1 (]: Began compiling node model.canal_brasil_dbt.canal_brasil_silver
[0m12:50:38.465808 [debug] [Thread-1 (]: Writing injected SQL for node "model.canal_brasil_dbt.canal_brasil_silver"
[0m12:50:38.467256 [debug] [Thread-1 (]: Timing info for model.canal_brasil_dbt.canal_brasil_silver (compile): 12:50:38.457594 => 12:50:38.466759
[0m12:50:38.467990 [debug] [Thread-1 (]: Began executing node model.canal_brasil_dbt.canal_brasil_silver
[0m12:50:38.537145 [debug] [Thread-1 (]: Writing runtime sql for node "model.canal_brasil_dbt.canal_brasil_silver"
[0m12:50:38.538586 [debug] [Thread-1 (]: Using postgres connection "model.canal_brasil_dbt.canal_brasil_silver"
[0m12:50:38.539368 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: BEGIN
[0m12:50:38.540101 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:50:39.302641 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m12:50:39.303086 [debug] [Thread-1 (]: Using postgres connection "model.canal_brasil_dbt.canal_brasil_silver"
[0m12:50:39.303486 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "node_id": "model.canal_brasil_dbt.canal_brasil_silver"} */

  
    

  create  table "postgres"."public"."canal_brasil_silver__dbt_tmp"
  
  
    as
  
  (
    

WITH ajustado AS ( -- no script o calendario do dia vai até as 6h do dia seguinte; aqui se corrige isso
  SELECT
    *,
    CASE
      WHEN horario::time < '05:00:00' THEN data::date + INTERVAL '1 day'
      ELSE data::date
    END AS data_ajustada
  FROM canal_brasil
),
com_lag AS (
  SELECT
    *,
    LAG(titulo) OVER (ORDER BY data_ajustada, horario) AS titulo_ant,
    LAG(horario) OVER (ORDER BY data_ajustada, horario) AS horario_ant,
    LAG(data_ajustada) OVER (ORDER BY data_ajustada, horario) AS data_ant
  FROM ajustado
),
-- filtra duplicatas (programas consecutivos por dia e horário)
sem_duplicatas AS (
  SELECT *
  FROM com_lag
  WHERE NOT (
    titulo = titulo_ant AND
    horario = horario_ant AND
    data_ajustada = data_ant
  )
),
df_estrutura AS (
  SELECT
    titulo,
    data_ajustada AS data,
    horario,
    genero_ano,
    sinopse
  FROM sem_duplicatas
  ORDER BY data, horario
),
base AS (
  SELECT
    titulo,
    (data::date || ' ' || horario)::timestamp AS dia_hora,
    split_part(genero_ano, ' / ', 1) AS genero,
    sinopse,
    NULLIF(split_part(genero_ano, ' / ', 2), '') AS ano,
    NULLIF(split_part(genero_ano, ' / ', 3), '') AS nota_imdb
  FROM df_estrutura
),
final AS (
  SELECT
    titulo,
    ano,
    dia_hora,
    LEAD(dia_hora) OVER (ORDER BY dia_hora) - dia_hora AS duracao,
    genero,
    sinopse,
    nota_imdb
  FROM base
  ORDER BY dia_hora
)
SELECT *
FROM final
WHERE dia_hora >= current_date
  );
  
[0m12:50:39.433249 [debug] [Thread-1 (]: SQL status: SELECT 185 in 0.0 seconds
[0m12:50:39.438859 [debug] [Thread-1 (]: Using postgres connection "model.canal_brasil_dbt.canal_brasil_silver"
[0m12:50:39.439252 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "node_id": "model.canal_brasil_dbt.canal_brasil_silver"} */
alter table "postgres"."public"."canal_brasil_silver__dbt_tmp" rename to "canal_brasil_silver"
[0m12:50:39.534728 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:50:39.551187 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: COMMIT
[0m12:50:39.551607 [debug] [Thread-1 (]: Using postgres connection "model.canal_brasil_dbt.canal_brasil_silver"
[0m12:50:39.551974 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: COMMIT
[0m12:50:39.647056 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:50:39.653949 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."canal_brasil_silver__dbt_backup"
[0m12:50:39.658978 [debug] [Thread-1 (]: Using postgres connection "model.canal_brasil_dbt.canal_brasil_silver"
[0m12:50:39.659421 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "node_id": "model.canal_brasil_dbt.canal_brasil_silver"} */
drop table if exists "postgres"."public"."canal_brasil_silver__dbt_backup" cascade
[0m12:50:39.761337 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:50:39.762985 [debug] [Thread-1 (]: Timing info for model.canal_brasil_dbt.canal_brasil_silver (execute): 12:50:38.468481 => 12:50:39.762732
[0m12:50:39.763398 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: Close
[0m12:50:39.765191 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1aedf90e-315e-475f-ab73-c688b1100ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002760749C650>]}
[0m12:50:39.766053 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.canal_brasil_silver ................... [[32mSELECT 185[0m in 1.31s]
[0m12:50:39.767037 [debug] [Thread-1 (]: Finished running node model.canal_brasil_dbt.canal_brasil_silver
[0m12:50:39.768363 [debug] [MainThread]: Using postgres connection "master"
[0m12:50:39.768777 [debug] [MainThread]: On master: BEGIN
[0m12:50:39.769084 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:50:40.535274 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m12:50:40.535997 [debug] [MainThread]: On master: COMMIT
[0m12:50:40.536618 [debug] [MainThread]: Using postgres connection "master"
[0m12:50:40.537206 [debug] [MainThread]: On master: COMMIT
[0m12:50:40.629964 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:50:40.630457 [debug] [MainThread]: On master: Close
[0m12:50:40.631972 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:50:40.632643 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m12:50:40.633050 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m12:50:40.633364 [debug] [MainThread]: Connection 'model.canal_brasil_dbt.canal_brasil_silver' was properly closed.
[0m12:50:40.633758 [info ] [MainThread]: 
[0m12:50:40.634454 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.52 seconds (5.52s).
[0m12:50:40.635470 [debug] [MainThread]: Command end result
[0m12:50:40.643599 [info ] [MainThread]: 
[0m12:50:40.644551 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:50:40.646004 [info ] [MainThread]: 
[0m12:50:40.646965 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:50:40.649179 [debug] [MainThread]: Command `dbt run` succeeded at 12:50:40.648840 after 6.20 seconds
[0m12:50:40.649754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027606E5FEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027600814410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276003F82D0>]}
[0m12:50:40.650262 [debug] [MainThread]: Flushing usage events
[0m15:53:25.815088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002236A7D5160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002236D40BD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002236D40B750>]}


============================== 15:53:25.819686 | e6c92b63-69ba-4326-9854-b5e220cf25f5 ==============================
[0m15:53:25.819686 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:53:25.820339 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt test --select canal_brasil_silver', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\Felli\\.code\\dbt\\canal_brasil_dbt\\logs', 'profiles_dir': 'C:\\Users\\Felli\\.dbt', 'warn_error': 'None', 'introspect': 'True', 'use_colors': 'True', 'write_json': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m15:53:26.064456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6c92b63-69ba-4326-9854-b5e220cf25f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002236D343100>]}
[0m15:53:26.148513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6c92b63-69ba-4326-9854-b5e220cf25f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002236D2DF020>]}
[0m15:53:26.149546 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m15:53:26.156546 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:53:26.219868 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 0 files changed.
[0m15:53:26.220343 [debug] [MainThread]: Partial parsing: added file: canal_brasil_dbt://models\tests\no_duplicate_titulo_hora.sql
[0m15:53:26.220716 [debug] [MainThread]: Partial parsing: added file: canal_brasil_dbt://models\canal_brasil_silver.yml
[0m15:53:26.351002 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.canal_brasil_dbt.example
[0m15:53:26.355337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6c92b63-69ba-4326-9854-b5e220cf25f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002236D971A50>]}
[0m15:53:26.364217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6c92b63-69ba-4326-9854-b5e220cf25f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002236D5474D0>]}
[0m15:53:26.364864 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m15:53:26.365603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6c92b63-69ba-4326-9854-b5e220cf25f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002236D8275B0>]}
[0m15:53:26.366948 [info ] [MainThread]: 
[0m15:53:26.367493 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:53:26.368137 [debug] [MainThread]: Command end result
[0m15:53:26.374832 [debug] [MainThread]: Command `dbt test` succeeded at 15:53:26.374513 after 0.69 seconds
[0m15:53:26.375288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002236D7E2D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002236D322690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002236DA11D90>]}
[0m15:53:26.375695 [debug] [MainThread]: Flushing usage events
[0m15:57:17.806517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002789E1B5160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278A0DEBD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278A0DEB750>]}


============================== 15:57:17.810289 | 52a74d55-ea88-4fd0-af0e-ddb2601ce764 ==============================
[0m15:57:17.810289 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:57:17.810949 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt build --select canal_brasil_silver', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\Felli\\.code\\dbt\\canal_brasil_dbt\\logs', 'warn_error': 'None', 'use_colors': 'True', 'introspect': 'True', 'profiles_dir': 'C:\\Users\\Felli\\.dbt', 'write_json': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m15:57:17.995015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52a74d55-ea88-4fd0-af0e-ddb2601ce764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278A0D23100>]}
[0m15:57:18.076358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '52a74d55-ea88-4fd0-af0e-ddb2601ce764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278A0CBF020>]}
[0m15:57:18.077246 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m15:57:18.084449 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:57:18.144744 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:57:18.145091 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:57:18.145579 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.canal_brasil_dbt.example
[0m15:57:18.150110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52a74d55-ea88-4fd0-af0e-ddb2601ce764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278A1340950>]}
[0m15:57:18.159200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52a74d55-ea88-4fd0-af0e-ddb2601ce764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278A0CC7110>]}
[0m15:57:18.159701 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m15:57:18.161259 [info ] [MainThread]: 
[0m15:57:18.162198 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:57:18.163338 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:57:18.172217 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:57:18.172615 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:57:18.172928 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:19.242784 [debug] [ThreadPool]: SQL status: SELECT 22 in 1.0 seconds
[0m15:57:19.244003 [debug] [ThreadPool]: On list_postgres: Close
[0m15:57:19.245786 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m15:57:19.253170 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:57:19.253539 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m15:57:19.254152 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:20.051361 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m15:57:20.051738 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:57:20.052048 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:57:20.153390 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m15:57:20.154537 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m15:57:20.252138 [debug] [ThreadPool]: On list_postgres_public: Close
[0m15:57:20.256439 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:20.256788 [debug] [MainThread]: On master: BEGIN
[0m15:57:20.257067 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:57:20.967715 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m15:57:20.968129 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:20.968486 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:57:21.072823 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m15:57:21.074039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52a74d55-ea88-4fd0-af0e-ddb2601ce764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278A1235390>]}
[0m15:57:21.074446 [debug] [MainThread]: On master: ROLLBACK
[0m15:57:21.163979 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:21.164349 [debug] [MainThread]: On master: BEGIN
[0m15:57:21.343193 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:57:21.343573 [debug] [MainThread]: On master: COMMIT
[0m15:57:21.343863 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:21.344148 [debug] [MainThread]: On master: COMMIT
[0m15:57:21.433178 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:57:21.433562 [debug] [MainThread]: On master: Close
[0m15:57:21.434338 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:57:21.434860 [info ] [MainThread]: 
[0m15:57:21.438972 [debug] [Thread-1 (]: Began running node model.canal_brasil_dbt.canal_brasil_silver
[0m15:57:21.439464 [info ] [Thread-1 (]: 1 of 1 START sql table model public.canal_brasil_silver ........................ [RUN]
[0m15:57:21.440426 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.canal_brasil_dbt.canal_brasil_silver'
[0m15:57:21.440971 [debug] [Thread-1 (]: Began compiling node model.canal_brasil_dbt.canal_brasil_silver
[0m15:57:21.447643 [debug] [Thread-1 (]: Writing injected SQL for node "model.canal_brasil_dbt.canal_brasil_silver"
[0m15:57:21.448824 [debug] [Thread-1 (]: Timing info for model.canal_brasil_dbt.canal_brasil_silver (compile): 15:57:21.441415 => 15:57:21.448455
[0m15:57:21.449256 [debug] [Thread-1 (]: Began executing node model.canal_brasil_dbt.canal_brasil_silver
[0m15:57:21.484574 [debug] [Thread-1 (]: Writing runtime sql for node "model.canal_brasil_dbt.canal_brasil_silver"
[0m15:57:21.485577 [debug] [Thread-1 (]: Using postgres connection "model.canal_brasil_dbt.canal_brasil_silver"
[0m15:57:21.485950 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: BEGIN
[0m15:57:21.486280 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:57:22.298022 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m15:57:22.298532 [debug] [Thread-1 (]: Using postgres connection "model.canal_brasil_dbt.canal_brasil_silver"
[0m15:57:22.299082 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "node_id": "model.canal_brasil_dbt.canal_brasil_silver"} */

  
    

  create  table "postgres"."public"."canal_brasil_silver__dbt_tmp"
  
  
    as
  
  (
    

WITH ajustado AS ( -- no script o calendario do dia vai até as 6h do dia seguinte; aqui se corrige isso
  SELECT
    *,
    CASE
      WHEN horario::time < '05:00:00' THEN data::date + INTERVAL '1 day'
      ELSE data::date
    END AS data_ajustada
  FROM canal_brasil
),
com_lag AS (
  SELECT
    *,
    LAG(titulo) OVER (ORDER BY data_ajustada, horario) AS titulo_ant,
    LAG(horario) OVER (ORDER BY data_ajustada, horario) AS horario_ant,
    LAG(data_ajustada) OVER (ORDER BY data_ajustada, horario) AS data_ant
  FROM ajustado
),
-- filtra duplicatas (programas consecutivos por dia e horário)
sem_duplicatas AS (
  SELECT *
  FROM com_lag
  WHERE NOT (
    titulo = titulo_ant AND
    horario = horario_ant AND
    data_ajustada = data_ant
  )
),
df_estrutura AS (
  SELECT
    titulo,
    data_ajustada AS data,
    horario,
    genero_ano,
    sinopse
  FROM sem_duplicatas
  ORDER BY data, horario
),
base AS (
  SELECT
    titulo,
    (data::date || ' ' || horario)::timestamp AS dia_hora,
    split_part(genero_ano, ' / ', 1) AS genero,
    sinopse,
    NULLIF(split_part(genero_ano, ' / ', 2), '') AS ano,
    NULLIF(split_part(genero_ano, ' / ', 3), '') AS nota_imdb
  FROM df_estrutura
),
final AS (
  SELECT
    titulo,
    ano,
    dia_hora,
    LEAD(dia_hora) OVER (ORDER BY dia_hora) - dia_hora AS duracao,
    genero,
    sinopse,
    nota_imdb
  FROM base
  ORDER BY dia_hora
)
SELECT *
FROM final
WHERE dia_hora >= current_date
  );
  
[0m15:57:22.460166 [debug] [Thread-1 (]: SQL status: SELECT 185 in 0.0 seconds
[0m15:57:22.465693 [debug] [Thread-1 (]: Using postgres connection "model.canal_brasil_dbt.canal_brasil_silver"
[0m15:57:22.466170 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "node_id": "model.canal_brasil_dbt.canal_brasil_silver"} */
alter table "postgres"."public"."canal_brasil_silver" rename to "canal_brasil_silver__dbt_backup"
[0m15:57:22.566675 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:57:22.569259 [debug] [Thread-1 (]: Using postgres connection "model.canal_brasil_dbt.canal_brasil_silver"
[0m15:57:22.569680 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "node_id": "model.canal_brasil_dbt.canal_brasil_silver"} */
alter table "postgres"."public"."canal_brasil_silver__dbt_tmp" rename to "canal_brasil_silver"
[0m15:57:22.670027 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:57:22.687049 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: COMMIT
[0m15:57:22.687463 [debug] [Thread-1 (]: Using postgres connection "model.canal_brasil_dbt.canal_brasil_silver"
[0m15:57:22.687804 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: COMMIT
[0m15:57:22.790788 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:57:22.796608 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."canal_brasil_silver__dbt_backup"
[0m15:57:22.800810 [debug] [Thread-1 (]: Using postgres connection "model.canal_brasil_dbt.canal_brasil_silver"
[0m15:57:22.801297 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "node_id": "model.canal_brasil_dbt.canal_brasil_silver"} */
drop table if exists "postgres"."public"."canal_brasil_silver__dbt_backup" cascade
[0m15:57:22.913736 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:57:22.915210 [debug] [Thread-1 (]: Timing info for model.canal_brasil_dbt.canal_brasil_silver (execute): 15:57:21.449488 => 15:57:22.914986
[0m15:57:22.915573 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: Close
[0m15:57:22.916806 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52a74d55-ea88-4fd0-af0e-ddb2601ce764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278A133AB60>]}
[0m15:57:22.917351 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.canal_brasil_silver ................... [[32mSELECT 185[0m in 1.48s]
[0m15:57:22.918224 [debug] [Thread-1 (]: Finished running node model.canal_brasil_dbt.canal_brasil_silver
[0m15:57:22.919517 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:22.919832 [debug] [MainThread]: On master: BEGIN
[0m15:57:22.920109 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:57:23.649531 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m15:57:23.649909 [debug] [MainThread]: On master: COMMIT
[0m15:57:23.650196 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:23.650477 [debug] [MainThread]: On master: COMMIT
[0m15:57:23.739775 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:57:23.740162 [debug] [MainThread]: On master: Close
[0m15:57:23.740891 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:57:23.741170 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m15:57:23.741432 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m15:57:23.741699 [debug] [MainThread]: Connection 'model.canal_brasil_dbt.canal_brasil_silver' was properly closed.
[0m15:57:23.742513 [info ] [MainThread]: 
[0m15:57:23.743034 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.58 seconds (5.58s).
[0m15:57:23.743829 [debug] [MainThread]: Command end result
[0m15:57:23.751428 [info ] [MainThread]: 
[0m15:57:23.752092 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:57:23.752715 [info ] [MainThread]: 
[0m15:57:23.753665 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:57:23.755239 [debug] [MainThread]: Command `dbt build` succeeded at 15:57:23.754956 after 6.06 seconds
[0m15:57:23.755722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278A0D02690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278A0D1FEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278A0257800>]}
[0m15:57:23.756283 [debug] [MainThread]: Flushing usage events
[0m16:00:09.434322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0B4DE5160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0B7A1BD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0B7A1B750>]}


============================== 16:00:09.437940 | 468d3050-95fb-4ebc-a002-260b096ef0e3 ==============================
[0m16:00:09.437940 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:00:09.438544 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt build --select canal_brasil_silver', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\Felli\\.code\\dbt\\canal_brasil_dbt\\logs', 'profiles_dir': 'C:\\Users\\Felli\\.dbt', 'write_json': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m16:00:09.619618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '468d3050-95fb-4ebc-a002-260b096ef0e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0B7957100>]}
[0m16:00:09.698895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '468d3050-95fb-4ebc-a002-260b096ef0e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0B78EF020>]}
[0m16:00:09.699787 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m16:00:09.706474 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:00:09.761331 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:00:09.761678 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:00:09.765982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '468d3050-95fb-4ebc-a002-260b096ef0e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0B7EB0950>]}
[0m16:00:09.774646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '468d3050-95fb-4ebc-a002-260b096ef0e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0B78F7110>]}
[0m16:00:09.775249 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:00:09.776858 [info ] [MainThread]: 
[0m16:00:09.777738 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:00:09.778742 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:00:09.787577 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:00:09.788102 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:00:09.788564 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:10.721028 [debug] [ThreadPool]: SQL status: SELECT 22 in 1.0 seconds
[0m16:00:10.722225 [debug] [ThreadPool]: On list_postgres: Close
[0m16:00:10.724201 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m16:00:10.731746 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:00:10.732110 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m16:00:10.732396 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:11.633300 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m16:00:11.633665 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:00:11.633967 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:00:11.750029 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m16:00:11.751490 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m16:00:11.863896 [debug] [ThreadPool]: On list_postgres_public: Close
[0m16:00:11.868278 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:11.868620 [debug] [MainThread]: On master: BEGIN
[0m16:00:11.868899 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:00:12.703180 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m16:00:12.703556 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:12.703904 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:00:12.822314 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m16:00:12.823472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '468d3050-95fb-4ebc-a002-260b096ef0e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0B7DA9390>]}
[0m16:00:12.823914 [debug] [MainThread]: On master: ROLLBACK
[0m16:00:12.926368 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:12.926793 [debug] [MainThread]: On master: BEGIN
[0m16:00:13.131166 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:00:13.131772 [debug] [MainThread]: On master: COMMIT
[0m16:00:13.132246 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:13.132573 [debug] [MainThread]: On master: COMMIT
[0m16:00:13.234653 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:00:13.235134 [debug] [MainThread]: On master: Close
[0m16:00:13.235969 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:00:13.236495 [info ] [MainThread]: 
[0m16:00:13.238890 [debug] [Thread-1 (]: Began running node model.canal_brasil_dbt.canal_brasil_silver
[0m16:00:13.239393 [info ] [Thread-1 (]: 1 of 1 START sql table model public.canal_brasil_silver ........................ [RUN]
[0m16:00:13.240207 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.canal_brasil_dbt.canal_brasil_silver'
[0m16:00:13.240567 [debug] [Thread-1 (]: Began compiling node model.canal_brasil_dbt.canal_brasil_silver
[0m16:00:13.246676 [debug] [Thread-1 (]: Writing injected SQL for node "model.canal_brasil_dbt.canal_brasil_silver"
[0m16:00:13.248030 [debug] [Thread-1 (]: Timing info for model.canal_brasil_dbt.canal_brasil_silver (compile): 16:00:13.240798 => 16:00:13.247475
[0m16:00:13.248624 [debug] [Thread-1 (]: Began executing node model.canal_brasil_dbt.canal_brasil_silver
[0m16:00:13.282934 [debug] [Thread-1 (]: Writing runtime sql for node "model.canal_brasil_dbt.canal_brasil_silver"
[0m16:00:13.283974 [debug] [Thread-1 (]: Using postgres connection "model.canal_brasil_dbt.canal_brasil_silver"
[0m16:00:13.284782 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: BEGIN
[0m16:00:13.285464 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:00:14.026086 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m16:00:14.026788 [debug] [Thread-1 (]: Using postgres connection "model.canal_brasil_dbt.canal_brasil_silver"
[0m16:00:14.027501 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "node_id": "model.canal_brasil_dbt.canal_brasil_silver"} */

  
    

  create  table "postgres"."public"."canal_brasil_silver__dbt_tmp"
  
  
    as
  
  (
    

WITH ajustado AS ( -- no script o calendario do dia vai até as 6h do dia seguinte; aqui se corrige isso
  SELECT
    *,
    CASE
      WHEN horario::time < '05:00:00' THEN data::date + INTERVAL '1 day'
      ELSE data::date
    END AS data_ajustada
  FROM canal_brasil
),
com_lag AS (
  SELECT
    *,
    LAG(titulo) OVER (ORDER BY data_ajustada, horario) AS titulo_ant,
    LAG(horario) OVER (ORDER BY data_ajustada, horario) AS horario_ant,
    LAG(data_ajustada) OVER (ORDER BY data_ajustada, horario) AS data_ant
  FROM ajustado
),
-- filtra duplicatas (programas consecutivos por dia e horário)
sem_duplicatas AS (
  SELECT *
  FROM com_lag
  WHERE NOT (
    titulo = titulo_ant AND
    horario = horario_ant AND
    data_ajustada = data_ant
  )
),
df_estrutura AS (
  SELECT
    titulo,
    data_ajustada AS data,
    horario,
    genero_ano,
    sinopse
  FROM sem_duplicatas
  ORDER BY data, horario
),
base AS (
  SELECT
    titulo,
    (data::date || ' ' || horario)::timestamp AS dia_hora,
    split_part(genero_ano, ' / ', 1) AS genero,
    sinopse,
    NULLIF(split_part(genero_ano, ' / ', 2), '') AS ano,
    NULLIF(split_part(genero_ano, ' / ', 3), '') AS nota_imdb
  FROM df_estrutura
),
final AS (
  SELECT
    titulo,
    ano,
    dia_hora,
    LEAD(dia_hora) OVER (ORDER BY dia_hora) - dia_hora AS duracao,
    genero,
    sinopse,
    nota_imdb
  FROM base
  ORDER BY dia_hora
)
SELECT *
FROM final
WHERE dia_hora >= current_date
  );
  
[0m16:00:14.157224 [debug] [Thread-1 (]: SQL status: SELECT 185 in 0.0 seconds
[0m16:00:14.163508 [debug] [Thread-1 (]: Using postgres connection "model.canal_brasil_dbt.canal_brasil_silver"
[0m16:00:14.163936 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "node_id": "model.canal_brasil_dbt.canal_brasil_silver"} */
alter table "postgres"."public"."canal_brasil_silver" rename to "canal_brasil_silver__dbt_backup"
[0m16:00:14.256309 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:00:14.258871 [debug] [Thread-1 (]: Using postgres connection "model.canal_brasil_dbt.canal_brasil_silver"
[0m16:00:14.259234 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "node_id": "model.canal_brasil_dbt.canal_brasil_silver"} */
alter table "postgres"."public"."canal_brasil_silver__dbt_tmp" rename to "canal_brasil_silver"
[0m16:00:14.349639 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:00:14.368072 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: COMMIT
[0m16:00:14.368616 [debug] [Thread-1 (]: Using postgres connection "model.canal_brasil_dbt.canal_brasil_silver"
[0m16:00:14.369004 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: COMMIT
[0m16:00:14.461510 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:00:14.467380 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."canal_brasil_silver__dbt_backup"
[0m16:00:14.471695 [debug] [Thread-1 (]: Using postgres connection "model.canal_brasil_dbt.canal_brasil_silver"
[0m16:00:14.472070 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "node_id": "model.canal_brasil_dbt.canal_brasil_silver"} */
drop table if exists "postgres"."public"."canal_brasil_silver__dbt_backup" cascade
[0m16:00:14.567480 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:00:14.568959 [debug] [Thread-1 (]: Timing info for model.canal_brasil_dbt.canal_brasil_silver (execute): 16:00:13.248912 => 16:00:14.568735
[0m16:00:14.569320 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: Close
[0m16:00:14.570127 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '468d3050-95fb-4ebc-a002-260b096ef0e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0B7EAAB60>]}
[0m16:00:14.570643 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.canal_brasil_silver ................... [[32mSELECT 185[0m in 1.33s]
[0m16:00:14.571415 [debug] [Thread-1 (]: Finished running node model.canal_brasil_dbt.canal_brasil_silver
[0m16:00:14.572722 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:14.573034 [debug] [MainThread]: On master: BEGIN
[0m16:00:14.573317 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:00:15.542942 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m16:00:15.543325 [debug] [MainThread]: On master: COMMIT
[0m16:00:15.543624 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:15.543910 [debug] [MainThread]: On master: COMMIT
[0m16:00:15.662516 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:00:15.662899 [debug] [MainThread]: On master: Close
[0m16:00:15.663635 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:00:15.663916 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m16:00:15.664178 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m16:00:15.664434 [debug] [MainThread]: Connection 'model.canal_brasil_dbt.canal_brasil_silver' was properly closed.
[0m16:00:15.664738 [info ] [MainThread]: 
[0m16:00:15.665238 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.89 seconds (5.89s).
[0m16:00:15.666030 [debug] [MainThread]: Command end result
[0m16:00:15.672747 [info ] [MainThread]: 
[0m16:00:15.673384 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:00:15.674146 [info ] [MainThread]: 
[0m16:00:15.674813 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:00:15.676190 [debug] [MainThread]: Command `dbt build` succeeded at 16:00:15.676015 after 6.35 seconds
[0m16:00:15.676561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0B7932690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0B794FEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0B6E87800>]}
[0m16:00:15.676913 [debug] [MainThread]: Flushing usage events
[0m16:00:36.328962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A79FE25160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7A2A5BD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7A2A5B750>]}


============================== 16:00:36.332505 | 18385be3-6f66-40d7-81ae-8901c7f90ec5 ==============================
[0m16:00:36.332505 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:00:36.333267 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt test --select canal_brasil_silver', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\Felli\\.code\\dbt\\canal_brasil_dbt\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Felli\\.dbt', 'introspect': 'True', 'write_json': 'True', 'use_colors': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m16:00:36.519927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18385be3-6f66-40d7-81ae-8901c7f90ec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7A2997100>]}
[0m16:00:36.599161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '18385be3-6f66-40d7-81ae-8901c7f90ec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7A292F020>]}
[0m16:00:36.600002 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m16:00:36.606719 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:00:36.661473 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:00:36.661825 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:00:36.666098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18385be3-6f66-40d7-81ae-8901c7f90ec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7A2FB0950>]}
[0m16:00:36.674302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18385be3-6f66-40d7-81ae-8901c7f90ec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7A2937110>]}
[0m16:00:36.674768 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:00:36.675312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18385be3-6f66-40d7-81ae-8901c7f90ec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7A2E63BD0>]}
[0m16:00:36.676565 [info ] [MainThread]: 
[0m16:00:36.677054 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:00:36.677657 [debug] [MainThread]: Command end result
[0m16:00:36.687169 [debug] [MainThread]: Command `dbt test` succeeded at 16:00:36.686958 after 0.44 seconds
[0m16:00:36.687620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7A2E229C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7A296E690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7A2FACA10>]}
[0m16:00:36.688027 [debug] [MainThread]: Flushing usage events
[0m16:05:09.673566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024481055160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024483C5BD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024483C5B750>]}


============================== 16:05:09.677061 | c77fa37c-e2e6-48ef-896b-4931535c3a76 ==============================
[0m16:05:09.677061 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:05:09.677776 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt build --select canal_brasil_silver', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\Felli\\.code\\dbt\\canal_brasil_dbt\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Felli\\.dbt', 'introspect': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m16:05:09.865579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c77fa37c-e2e6-48ef-896b-4931535c3a76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024483B93100>]}
[0m16:05:09.945615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c77fa37c-e2e6-48ef-896b-4931535c3a76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024483B2F020>]}
[0m16:05:09.946598 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m16:05:09.953353 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:05:10.007102 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:05:10.007451 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:05:10.011887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c77fa37c-e2e6-48ef-896b-4931535c3a76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244841A4950>]}
[0m16:05:10.020707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c77fa37c-e2e6-48ef-896b-4931535c3a76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024483B37110>]}
[0m16:05:10.021164 [info ] [MainThread]: Found 2 models, 2 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:05:10.022649 [info ] [MainThread]: 
[0m16:05:10.023549 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:05:10.024531 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:05:10.033454 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:05:10.033899 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:05:10.034243 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:05:10.880216 [debug] [ThreadPool]: SQL status: SELECT 22 in 1.0 seconds
[0m16:05:10.881804 [debug] [ThreadPool]: On list_postgres: Close
[0m16:05:10.883642 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m16:05:10.891191 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:05:10.891641 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m16:05:10.891937 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:05:11.858320 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m16:05:11.858693 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:05:11.858995 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:05:11.980646 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m16:05:11.982209 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m16:05:12.100601 [debug] [ThreadPool]: On list_postgres_public: Close
[0m16:05:12.104695 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:12.105024 [debug] [MainThread]: On master: BEGIN
[0m16:05:12.105301 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:05:12.961746 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m16:05:12.962111 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:12.962457 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:05:13.083775 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m16:05:13.085225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c77fa37c-e2e6-48ef-896b-4931535c3a76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024484099390>]}
[0m16:05:13.085693 [debug] [MainThread]: On master: ROLLBACK
[0m16:05:13.190719 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:13.191080 [debug] [MainThread]: On master: BEGIN
[0m16:05:13.402875 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:05:13.403262 [debug] [MainThread]: On master: COMMIT
[0m16:05:13.403586 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:13.403872 [debug] [MainThread]: On master: COMMIT
[0m16:05:13.512775 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:05:13.513158 [debug] [MainThread]: On master: Close
[0m16:05:13.513911 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:05:13.514432 [info ] [MainThread]: 
[0m16:05:13.517332 [debug] [Thread-1 (]: Began running node model.canal_brasil_dbt.canal_brasil_silver
[0m16:05:13.517806 [info ] [Thread-1 (]: 1 of 3 START sql table model public.canal_brasil_silver ........................ [RUN]
[0m16:05:13.518688 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.canal_brasil_dbt.canal_brasil_silver'
[0m16:05:13.519037 [debug] [Thread-1 (]: Began compiling node model.canal_brasil_dbt.canal_brasil_silver
[0m16:05:13.526236 [debug] [Thread-1 (]: Writing injected SQL for node "model.canal_brasil_dbt.canal_brasil_silver"
[0m16:05:13.528019 [debug] [Thread-1 (]: Timing info for model.canal_brasil_dbt.canal_brasil_silver (compile): 16:05:13.519265 => 16:05:13.527271
[0m16:05:13.528638 [debug] [Thread-1 (]: Began executing node model.canal_brasil_dbt.canal_brasil_silver
[0m16:05:13.565966 [debug] [Thread-1 (]: Writing runtime sql for node "model.canal_brasil_dbt.canal_brasil_silver"
[0m16:05:13.566922 [debug] [Thread-1 (]: Using postgres connection "model.canal_brasil_dbt.canal_brasil_silver"
[0m16:05:13.567306 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: BEGIN
[0m16:05:13.567642 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:05:14.449675 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m16:05:14.450088 [debug] [Thread-1 (]: Using postgres connection "model.canal_brasil_dbt.canal_brasil_silver"
[0m16:05:14.450480 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "node_id": "model.canal_brasil_dbt.canal_brasil_silver"} */

  
    

  create  table "postgres"."public"."canal_brasil_silver__dbt_tmp"
  
  
    as
  
  (
    

WITH ajustado AS ( -- no script o calendario do dia vai até as 6h do dia seguinte; aqui se corrige isso
  SELECT
    *,
    CASE
      WHEN horario::time < '05:00:00' THEN data::date + INTERVAL '1 day'
      ELSE data::date
    END AS data_ajustada
  FROM canal_brasil
),
com_lag AS (
  SELECT
    *,
    LAG(titulo) OVER (ORDER BY data_ajustada, horario) AS titulo_ant,
    LAG(horario) OVER (ORDER BY data_ajustada, horario) AS horario_ant,
    LAG(data_ajustada) OVER (ORDER BY data_ajustada, horario) AS data_ant
  FROM ajustado
),
-- filtra duplicatas (programas consecutivos por dia e horário)
sem_duplicatas AS (
  SELECT *
  FROM com_lag
  WHERE NOT (
    titulo = titulo_ant AND
    horario = horario_ant AND
    data_ajustada = data_ant
  )
),
df_estrutura AS (
  SELECT
    titulo,
    data_ajustada AS data,
    horario,
    genero_ano,
    sinopse
  FROM sem_duplicatas
  ORDER BY data, horario
),
base AS (
  SELECT
    titulo,
    (data::date || ' ' || horario)::timestamp AS dia_hora,
    split_part(genero_ano, ' / ', 1) AS genero,
    sinopse,
    NULLIF(split_part(genero_ano, ' / ', 2), '') AS ano,
    NULLIF(split_part(genero_ano, ' / ', 3), '') AS nota_imdb
  FROM df_estrutura
),
final AS (
  SELECT
    titulo,
    ano,
    dia_hora,
    LEAD(dia_hora) OVER (ORDER BY dia_hora) - dia_hora AS duracao,
    genero,
    sinopse,
    nota_imdb
  FROM base
  ORDER BY dia_hora
)
SELECT *
FROM final
WHERE dia_hora >= current_date
  );
  
[0m16:05:14.593858 [debug] [Thread-1 (]: SQL status: SELECT 185 in 0.0 seconds
[0m16:05:14.600224 [debug] [Thread-1 (]: Using postgres connection "model.canal_brasil_dbt.canal_brasil_silver"
[0m16:05:14.600633 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "node_id": "model.canal_brasil_dbt.canal_brasil_silver"} */
alter table "postgres"."public"."canal_brasil_silver" rename to "canal_brasil_silver__dbt_backup"
[0m16:05:14.711413 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:05:14.714396 [debug] [Thread-1 (]: Using postgres connection "model.canal_brasil_dbt.canal_brasil_silver"
[0m16:05:14.714874 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "node_id": "model.canal_brasil_dbt.canal_brasil_silver"} */
alter table "postgres"."public"."canal_brasil_silver__dbt_tmp" rename to "canal_brasil_silver"
[0m16:05:14.822733 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:05:14.840506 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: COMMIT
[0m16:05:14.840910 [debug] [Thread-1 (]: Using postgres connection "model.canal_brasil_dbt.canal_brasil_silver"
[0m16:05:14.841242 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: COMMIT
[0m16:05:14.950832 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:05:14.956642 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."canal_brasil_silver__dbt_backup"
[0m16:05:14.960952 [debug] [Thread-1 (]: Using postgres connection "model.canal_brasil_dbt.canal_brasil_silver"
[0m16:05:14.961324 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "node_id": "model.canal_brasil_dbt.canal_brasil_silver"} */
drop table if exists "postgres"."public"."canal_brasil_silver__dbt_backup" cascade
[0m16:05:15.081764 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:05:15.083346 [debug] [Thread-1 (]: Timing info for model.canal_brasil_dbt.canal_brasil_silver (execute): 16:05:13.528878 => 16:05:15.083121
[0m16:05:15.083704 [debug] [Thread-1 (]: On model.canal_brasil_dbt.canal_brasil_silver: Close
[0m16:05:15.084521 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c77fa37c-e2e6-48ef-896b-4931535c3a76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002448419EEA0>]}
[0m16:05:15.085038 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.canal_brasil_silver ................... [[32mSELECT 185[0m in 1.57s]
[0m16:05:15.085811 [debug] [Thread-1 (]: Finished running node model.canal_brasil_dbt.canal_brasil_silver
[0m16:05:15.086529 [debug] [Thread-1 (]: Began running node test.canal_brasil_dbt.not_null_canal_brasil_silver_dia_hora.34f502ae97
[0m16:05:15.086906 [info ] [Thread-1 (]: 2 of 3 START test not_null_canal_brasil_silver_dia_hora ........................ [RUN]
[0m16:05:15.087689 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.canal_brasil_dbt.canal_brasil_silver, now test.canal_brasil_dbt.not_null_canal_brasil_silver_dia_hora.34f502ae97)
[0m16:05:15.088042 [debug] [Thread-1 (]: Began compiling node test.canal_brasil_dbt.not_null_canal_brasil_silver_dia_hora.34f502ae97
[0m16:05:15.097706 [debug] [Thread-1 (]: Writing injected SQL for node "test.canal_brasil_dbt.not_null_canal_brasil_silver_dia_hora.34f502ae97"
[0m16:05:15.099601 [debug] [Thread-1 (]: Timing info for test.canal_brasil_dbt.not_null_canal_brasil_silver_dia_hora.34f502ae97 (compile): 16:05:15.088265 => 16:05:15.099194
[0m16:05:15.100047 [debug] [Thread-1 (]: Began executing node test.canal_brasil_dbt.not_null_canal_brasil_silver_dia_hora.34f502ae97
[0m16:05:15.113207 [debug] [Thread-1 (]: Writing runtime sql for node "test.canal_brasil_dbt.not_null_canal_brasil_silver_dia_hora.34f502ae97"
[0m16:05:15.115059 [debug] [Thread-1 (]: Using postgres connection "test.canal_brasil_dbt.not_null_canal_brasil_silver_dia_hora.34f502ae97"
[0m16:05:15.116028 [debug] [Thread-1 (]: On test.canal_brasil_dbt.not_null_canal_brasil_silver_dia_hora.34f502ae97: BEGIN
[0m16:05:15.116715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:05:15.993857 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m16:05:15.994271 [debug] [Thread-1 (]: Using postgres connection "test.canal_brasil_dbt.not_null_canal_brasil_silver_dia_hora.34f502ae97"
[0m16:05:15.994616 [debug] [Thread-1 (]: On test.canal_brasil_dbt.not_null_canal_brasil_silver_dia_hora.34f502ae97: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "node_id": "test.canal_brasil_dbt.not_null_canal_brasil_silver_dia_hora.34f502ae97"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select dia_hora
from "postgres"."public"."canal_brasil_silver"
where dia_hora is null



      
    ) dbt_internal_test
[0m16:05:16.101301 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:05:16.103108 [debug] [Thread-1 (]: Timing info for test.canal_brasil_dbt.not_null_canal_brasil_silver_dia_hora.34f502ae97 (execute): 16:05:15.100314 => 16:05:16.102873
[0m16:05:16.103460 [debug] [Thread-1 (]: On test.canal_brasil_dbt.not_null_canal_brasil_silver_dia_hora.34f502ae97: ROLLBACK
[0m16:05:16.211118 [debug] [Thread-1 (]: On test.canal_brasil_dbt.not_null_canal_brasil_silver_dia_hora.34f502ae97: Close
[0m16:05:16.212252 [info ] [Thread-1 (]: 2 of 3 PASS not_null_canal_brasil_silver_dia_hora .............................. [[32mPASS[0m in 1.12s]
[0m16:05:16.213589 [debug] [Thread-1 (]: Finished running node test.canal_brasil_dbt.not_null_canal_brasil_silver_dia_hora.34f502ae97
[0m16:05:16.214307 [debug] [Thread-1 (]: Began running node test.canal_brasil_dbt.not_null_canal_brasil_silver_titulo.be6adba8dd
[0m16:05:16.214671 [info ] [Thread-1 (]: 3 of 3 START test not_null_canal_brasil_silver_titulo .......................... [RUN]
[0m16:05:16.215562 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.canal_brasil_dbt.not_null_canal_brasil_silver_dia_hora.34f502ae97, now test.canal_brasil_dbt.not_null_canal_brasil_silver_titulo.be6adba8dd)
[0m16:05:16.215925 [debug] [Thread-1 (]: Began compiling node test.canal_brasil_dbt.not_null_canal_brasil_silver_titulo.be6adba8dd
[0m16:05:16.219812 [debug] [Thread-1 (]: Writing injected SQL for node "test.canal_brasil_dbt.not_null_canal_brasil_silver_titulo.be6adba8dd"
[0m16:05:16.221293 [debug] [Thread-1 (]: Timing info for test.canal_brasil_dbt.not_null_canal_brasil_silver_titulo.be6adba8dd (compile): 16:05:16.216149 => 16:05:16.220926
[0m16:05:16.221751 [debug] [Thread-1 (]: Began executing node test.canal_brasil_dbt.not_null_canal_brasil_silver_titulo.be6adba8dd
[0m16:05:16.223609 [debug] [Thread-1 (]: Writing runtime sql for node "test.canal_brasil_dbt.not_null_canal_brasil_silver_titulo.be6adba8dd"
[0m16:05:16.224738 [debug] [Thread-1 (]: Using postgres connection "test.canal_brasil_dbt.not_null_canal_brasil_silver_titulo.be6adba8dd"
[0m16:05:16.225143 [debug] [Thread-1 (]: On test.canal_brasil_dbt.not_null_canal_brasil_silver_titulo.be6adba8dd: BEGIN
[0m16:05:16.225477 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:05:17.020922 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m16:05:17.021338 [debug] [Thread-1 (]: Using postgres connection "test.canal_brasil_dbt.not_null_canal_brasil_silver_titulo.be6adba8dd"
[0m16:05:17.021681 [debug] [Thread-1 (]: On test.canal_brasil_dbt.not_null_canal_brasil_silver_titulo.be6adba8dd: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "node_id": "test.canal_brasil_dbt.not_null_canal_brasil_silver_titulo.be6adba8dd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select titulo
from "postgres"."public"."canal_brasil_silver"
where titulo is null



      
    ) dbt_internal_test
[0m16:05:17.119253 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:05:17.120639 [debug] [Thread-1 (]: Timing info for test.canal_brasil_dbt.not_null_canal_brasil_silver_titulo.be6adba8dd (execute): 16:05:16.221983 => 16:05:17.120407
[0m16:05:17.120984 [debug] [Thread-1 (]: On test.canal_brasil_dbt.not_null_canal_brasil_silver_titulo.be6adba8dd: ROLLBACK
[0m16:05:17.218476 [debug] [Thread-1 (]: On test.canal_brasil_dbt.not_null_canal_brasil_silver_titulo.be6adba8dd: Close
[0m16:05:17.219439 [info ] [Thread-1 (]: 3 of 3 PASS not_null_canal_brasil_silver_titulo ................................ [[32mPASS[0m in 1.00s]
[0m16:05:17.220215 [debug] [Thread-1 (]: Finished running node test.canal_brasil_dbt.not_null_canal_brasil_silver_titulo.be6adba8dd
[0m16:05:17.221539 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:17.221852 [debug] [MainThread]: On master: BEGIN
[0m16:05:17.222132 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:05:18.031172 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m16:05:18.031551 [debug] [MainThread]: On master: COMMIT
[0m16:05:18.031841 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:18.032122 [debug] [MainThread]: On master: COMMIT
[0m16:05:18.132465 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:05:18.132855 [debug] [MainThread]: On master: Close
[0m16:05:18.133586 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:05:18.133868 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m16:05:18.134130 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m16:05:18.134392 [debug] [MainThread]: Connection 'test.canal_brasil_dbt.not_null_canal_brasil_silver_titulo.be6adba8dd' was properly closed.
[0m16:05:18.134714 [info ] [MainThread]: 
[0m16:05:18.135231 [info ] [MainThread]: Finished running 1 table model, 2 tests in 0 hours 0 minutes and 8.11 seconds (8.11s).
[0m16:05:18.136409 [debug] [MainThread]: Command end result
[0m16:05:18.143482 [info ] [MainThread]: 
[0m16:05:18.144163 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:05:18.144967 [info ] [MainThread]: 
[0m16:05:18.145642 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:05:18.147396 [debug] [MainThread]: Command `dbt build` succeeded at 16:05:18.147152 after 8.59 seconds
[0m16:05:18.147803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024483B72690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244840B87E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244840B8470>]}
[0m16:05:18.148154 [debug] [MainThread]: Flushing usage events
[0m16:05:21.445777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BAA875160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BAD4ABD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BAD4AB750>]}


============================== 16:05:21.449215 | 0fff73ac-55de-4d33-b4e6-74141991be4e ==============================
[0m16:05:21.449215 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:05:21.449846 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt test --select canal_brasil_silver', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\Felli\\.code\\dbt\\canal_brasil_dbt\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Felli\\.dbt', 'introspect': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m16:05:21.672361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0fff73ac-55de-4d33-b4e6-74141991be4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BAD3E3100>]}
[0m16:05:21.752656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0fff73ac-55de-4d33-b4e6-74141991be4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BAD37F020>]}
[0m16:05:21.753500 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m16:05:21.760273 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:05:21.812090 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:05:21.812495 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:05:21.817308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0fff73ac-55de-4d33-b4e6-74141991be4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BADA24950>]}
[0m16:05:21.825016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0fff73ac-55de-4d33-b4e6-74141991be4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BAD387110>]}
[0m16:05:21.825489 [info ] [MainThread]: Found 2 models, 2 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:05:21.825972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fff73ac-55de-4d33-b4e6-74141991be4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BAD8D3CB0>]}
[0m16:05:21.827355 [info ] [MainThread]: 
[0m16:05:21.828182 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:05:21.829566 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m16:05:21.838356 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:05:21.838710 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m16:05:21.838999 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:05:22.720460 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m16:05:22.720837 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:05:22.721144 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:05:22.830916 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m16:05:22.832215 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m16:05:22.939240 [debug] [ThreadPool]: On list_postgres_public: Close
[0m16:05:22.943425 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:22.943765 [debug] [MainThread]: On master: BEGIN
[0m16:05:22.944045 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:05:23.801534 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m16:05:23.801907 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:23.802249 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:05:23.924438 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m16:05:23.925594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fff73ac-55de-4d33-b4e6-74141991be4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BADA1D570>]}
[0m16:05:23.925980 [debug] [MainThread]: On master: ROLLBACK
[0m16:05:24.031321 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:24.031942 [debug] [MainThread]: On master: BEGIN
[0m16:05:24.245113 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:05:24.245498 [debug] [MainThread]: On master: COMMIT
[0m16:05:24.245893 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:24.246317 [debug] [MainThread]: On master: COMMIT
[0m16:05:24.351091 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:05:24.351483 [debug] [MainThread]: On master: Close
[0m16:05:24.352242 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:05:24.352758 [info ] [MainThread]: 
[0m16:05:24.358884 [debug] [Thread-1 (]: Began running node test.canal_brasil_dbt.not_null_canal_brasil_silver_dia_hora.34f502ae97
[0m16:05:24.359306 [info ] [Thread-1 (]: 1 of 2 START test not_null_canal_brasil_silver_dia_hora ........................ [RUN]
[0m16:05:24.360308 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.canal_brasil_dbt.not_null_canal_brasil_silver_dia_hora.34f502ae97'
[0m16:05:24.360793 [debug] [Thread-1 (]: Began compiling node test.canal_brasil_dbt.not_null_canal_brasil_silver_dia_hora.34f502ae97
[0m16:05:24.378791 [debug] [Thread-1 (]: Writing injected SQL for node "test.canal_brasil_dbt.not_null_canal_brasil_silver_dia_hora.34f502ae97"
[0m16:05:24.380672 [debug] [Thread-1 (]: Timing info for test.canal_brasil_dbt.not_null_canal_brasil_silver_dia_hora.34f502ae97 (compile): 16:05:24.361186 => 16:05:24.380082
[0m16:05:24.381550 [debug] [Thread-1 (]: Began executing node test.canal_brasil_dbt.not_null_canal_brasil_silver_dia_hora.34f502ae97
[0m16:05:24.394760 [debug] [Thread-1 (]: Writing runtime sql for node "test.canal_brasil_dbt.not_null_canal_brasil_silver_dia_hora.34f502ae97"
[0m16:05:24.395917 [debug] [Thread-1 (]: Using postgres connection "test.canal_brasil_dbt.not_null_canal_brasil_silver_dia_hora.34f502ae97"
[0m16:05:24.396795 [debug] [Thread-1 (]: On test.canal_brasil_dbt.not_null_canal_brasil_silver_dia_hora.34f502ae97: BEGIN
[0m16:05:24.397714 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:05:25.338536 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m16:05:25.338951 [debug] [Thread-1 (]: Using postgres connection "test.canal_brasil_dbt.not_null_canal_brasil_silver_dia_hora.34f502ae97"
[0m16:05:25.339298 [debug] [Thread-1 (]: On test.canal_brasil_dbt.not_null_canal_brasil_silver_dia_hora.34f502ae97: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "node_id": "test.canal_brasil_dbt.not_null_canal_brasil_silver_dia_hora.34f502ae97"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select dia_hora
from "postgres"."public"."canal_brasil_silver"
where dia_hora is null



      
    ) dbt_internal_test
[0m16:05:25.454077 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:05:25.455953 [debug] [Thread-1 (]: Timing info for test.canal_brasil_dbt.not_null_canal_brasil_silver_dia_hora.34f502ae97 (execute): 16:05:24.382057 => 16:05:25.455698
[0m16:05:25.456326 [debug] [Thread-1 (]: On test.canal_brasil_dbt.not_null_canal_brasil_silver_dia_hora.34f502ae97: ROLLBACK
[0m16:05:25.571389 [debug] [Thread-1 (]: On test.canal_brasil_dbt.not_null_canal_brasil_silver_dia_hora.34f502ae97: Close
[0m16:05:25.572376 [info ] [Thread-1 (]: 1 of 2 PASS not_null_canal_brasil_silver_dia_hora .............................. [[32mPASS[0m in 1.21s]
[0m16:05:25.573146 [debug] [Thread-1 (]: Finished running node test.canal_brasil_dbt.not_null_canal_brasil_silver_dia_hora.34f502ae97
[0m16:05:25.573563 [debug] [Thread-1 (]: Began running node test.canal_brasil_dbt.not_null_canal_brasil_silver_titulo.be6adba8dd
[0m16:05:25.573927 [info ] [Thread-1 (]: 2 of 2 START test not_null_canal_brasil_silver_titulo .......................... [RUN]
[0m16:05:25.574691 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.canal_brasil_dbt.not_null_canal_brasil_silver_dia_hora.34f502ae97, now test.canal_brasil_dbt.not_null_canal_brasil_silver_titulo.be6adba8dd)
[0m16:05:25.575054 [debug] [Thread-1 (]: Began compiling node test.canal_brasil_dbt.not_null_canal_brasil_silver_titulo.be6adba8dd
[0m16:05:25.578622 [debug] [Thread-1 (]: Writing injected SQL for node "test.canal_brasil_dbt.not_null_canal_brasil_silver_titulo.be6adba8dd"
[0m16:05:25.580336 [debug] [Thread-1 (]: Timing info for test.canal_brasil_dbt.not_null_canal_brasil_silver_titulo.be6adba8dd (compile): 16:05:25.575280 => 16:05:25.579712
[0m16:05:25.581469 [debug] [Thread-1 (]: Began executing node test.canal_brasil_dbt.not_null_canal_brasil_silver_titulo.be6adba8dd
[0m16:05:25.584278 [debug] [Thread-1 (]: Writing runtime sql for node "test.canal_brasil_dbt.not_null_canal_brasil_silver_titulo.be6adba8dd"
[0m16:05:25.585226 [debug] [Thread-1 (]: Using postgres connection "test.canal_brasil_dbt.not_null_canal_brasil_silver_titulo.be6adba8dd"
[0m16:05:25.585623 [debug] [Thread-1 (]: On test.canal_brasil_dbt.not_null_canal_brasil_silver_titulo.be6adba8dd: BEGIN
[0m16:05:25.585964 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:05:26.402843 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m16:05:26.403583 [debug] [Thread-1 (]: Using postgres connection "test.canal_brasil_dbt.not_null_canal_brasil_silver_titulo.be6adba8dd"
[0m16:05:26.404249 [debug] [Thread-1 (]: On test.canal_brasil_dbt.not_null_canal_brasil_silver_titulo.be6adba8dd: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "node_id": "test.canal_brasil_dbt.not_null_canal_brasil_silver_titulo.be6adba8dd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select titulo
from "postgres"."public"."canal_brasil_silver"
where titulo is null



      
    ) dbt_internal_test
[0m16:05:26.506456 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:05:26.510581 [debug] [Thread-1 (]: Timing info for test.canal_brasil_dbt.not_null_canal_brasil_silver_titulo.be6adba8dd (execute): 16:05:25.582274 => 16:05:26.509780
[0m16:05:26.511465 [debug] [Thread-1 (]: On test.canal_brasil_dbt.not_null_canal_brasil_silver_titulo.be6adba8dd: ROLLBACK
[0m16:05:26.613427 [debug] [Thread-1 (]: On test.canal_brasil_dbt.not_null_canal_brasil_silver_titulo.be6adba8dd: Close
[0m16:05:26.614983 [info ] [Thread-1 (]: 2 of 2 PASS not_null_canal_brasil_silver_titulo ................................ [[32mPASS[0m in 1.04s]
[0m16:05:26.615820 [debug] [Thread-1 (]: Finished running node test.canal_brasil_dbt.not_null_canal_brasil_silver_titulo.be6adba8dd
[0m16:05:26.617191 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:26.617555 [debug] [MainThread]: On master: BEGIN
[0m16:05:26.617856 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:05:27.527170 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m16:05:27.527806 [debug] [MainThread]: On master: COMMIT
[0m16:05:27.528304 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:27.528784 [debug] [MainThread]: On master: COMMIT
[0m16:05:27.642199 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:05:27.642599 [debug] [MainThread]: On master: Close
[0m16:05:27.643379 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:05:27.643712 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m16:05:27.643993 [debug] [MainThread]: Connection 'test.canal_brasil_dbt.not_null_canal_brasil_silver_titulo.be6adba8dd' was properly closed.
[0m16:05:27.644359 [info ] [MainThread]: 
[0m16:05:27.644887 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 5.82 seconds (5.82s).
[0m16:05:27.646281 [debug] [MainThread]: Command end result
[0m16:05:27.655034 [info ] [MainThread]: 
[0m16:05:27.655737 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:05:27.656397 [info ] [MainThread]: 
[0m16:05:27.656959 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:05:27.658129 [debug] [MainThread]: Command `dbt test` succeeded at 16:05:27.657963 after 6.29 seconds
[0m16:05:27.658513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BAD3BE690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BAD938E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BAD938C00>]}
[0m16:05:27.658905 [debug] [MainThread]: Flushing usage events
[0m16:07:36.232441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252606E5160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002526331BD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002526331B750>]}


============================== 16:07:36.236175 | b0ed027d-d633-47d1-b112-d6d2aa6ec703 ==============================
[0m16:07:36.236175 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:07:36.236853 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt test --select test_name:no_duplicate_titulo_hora', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\Felli\\.code\\dbt\\canal_brasil_dbt\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Felli\\.dbt', 'introspect': 'True', 'write_json': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m16:07:36.420255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0ed027d-d633-47d1-b112-d6d2aa6ec703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025263253100>]}
[0m16:07:36.500265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0ed027d-d633-47d1-b112-d6d2aa6ec703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252631EF020>]}
[0m16:07:36.501118 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m16:07:36.508210 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:07:36.562801 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:07:36.563272 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:07:36.568690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0ed027d-d633-47d1-b112-d6d2aa6ec703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252637A4950>]}
[0m16:07:36.577674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0ed027d-d633-47d1-b112-d6d2aa6ec703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252631F7110>]}
[0m16:07:36.578358 [info ] [MainThread]: Found 2 models, 2 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:07:36.579117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0ed027d-d633-47d1-b112-d6d2aa6ec703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025263657CB0>]}
[0m16:07:36.579781 [warn ] [MainThread]: The selection criterion 'test_name:no_duplicate_titulo_hora' does not match any nodes
[0m16:07:36.581002 [info ] [MainThread]: 
[0m16:07:36.581478 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:07:36.582102 [debug] [MainThread]: Command end result
[0m16:07:36.591261 [debug] [MainThread]: Command `dbt test` succeeded at 16:07:36.591074 after 0.47 seconds
[0m16:07:36.591642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025263612D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002526322E690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252637A0650>]}
[0m16:07:36.591989 [debug] [MainThread]: Flushing usage events
[0m16:09:36.279561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002180CB55160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002180F79BD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002180F79B750>]}


============================== 16:09:36.283070 | 40bc1b62-d3ae-4dbc-ba90-b980bda2d529 ==============================
[0m16:09:36.283070 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:09:36.283712 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt test --select test_name:no_duplicate_titulo_hora', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\Felli\\.code\\dbt\\canal_brasil_dbt\\logs', 'profiles_dir': 'C:\\Users\\Felli\\.dbt', 'warn_error': 'None', 'introspect': 'True', 'use_colors': 'True', 'write_json': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m16:09:36.468197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40bc1b62-d3ae-4dbc-ba90-b980bda2d529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002180F6D3100>]}
[0m16:09:36.548584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40bc1b62-d3ae-4dbc-ba90-b980bda2d529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002180F66F020>]}
[0m16:09:36.549408 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m16:09:36.556826 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:09:36.610926 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:09:36.611306 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:09:36.615841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40bc1b62-d3ae-4dbc-ba90-b980bda2d529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002180FCA4950>]}
[0m16:09:36.624216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40bc1b62-d3ae-4dbc-ba90-b980bda2d529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002180F677110>]}
[0m16:09:36.624849 [info ] [MainThread]: Found 2 models, 2 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:09:36.625551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40bc1b62-d3ae-4dbc-ba90-b980bda2d529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002180FB57A10>]}
[0m16:09:36.626227 [warn ] [MainThread]: The selection criterion 'test_name:no_duplicate_titulo_hora' does not match any nodes
[0m16:09:36.627434 [info ] [MainThread]: 
[0m16:09:36.627884 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:09:36.628479 [debug] [MainThread]: Command end result
[0m16:09:36.637375 [debug] [MainThread]: Command `dbt test` succeeded at 16:09:36.637189 after 0.47 seconds
[0m16:09:36.637777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002180FB12DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002180F6AE690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002180FCA0650>]}
[0m16:09:36.638143 [debug] [MainThread]: Flushing usage events
[0m16:10:52.762092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E77FE85160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E702B5BD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E702B5B750>]}


============================== 16:10:52.765639 | 99fc656d-95aa-4cf0-9b2c-42739e4262f2 ==============================
[0m16:10:52.765639 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:10:52.766262 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt test --select path:tests/no_duplicate_titulo_hora.sql', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\Felli\\.code\\dbt\\canal_brasil_dbt\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Felli\\.dbt', 'introspect': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m16:10:52.950229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99fc656d-95aa-4cf0-9b2c-42739e4262f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E702A97100>]}
[0m16:10:53.031328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '99fc656d-95aa-4cf0-9b2c-42739e4262f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E702A2F020>]}
[0m16:10:53.032198 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m16:10:53.038849 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:10:53.095617 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:10:53.096057 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:10:53.100581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99fc656d-95aa-4cf0-9b2c-42739e4262f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7030D4950>]}
[0m16:10:53.109385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99fc656d-95aa-4cf0-9b2c-42739e4262f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E702A37110>]}
[0m16:10:53.109926 [info ] [MainThread]: Found 2 models, 2 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:10:53.110423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99fc656d-95aa-4cf0-9b2c-42739e4262f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E702F87A10>]}
[0m16:10:53.111185 [warn ] [MainThread]: The selection criterion 'path:tests/no_duplicate_titulo_hora.sql' does not match any nodes
[0m16:10:53.112406 [info ] [MainThread]: 
[0m16:10:53.112878 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:10:53.113500 [debug] [MainThread]: Command end result
[0m16:10:53.122392 [debug] [MainThread]: Command `dbt test` succeeded at 16:10:53.122198 after 0.45 seconds
[0m16:10:53.122788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E702F42DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E702A6E690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7030D0650>]}
[0m16:10:53.123140 [debug] [MainThread]: Flushing usage events
[0m16:12:45.258513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A713735160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A71636BD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A71636B750>]}


============================== 16:12:45.262017 | 8fe17abc-fb5c-491e-b5e9-f4d70bf40e4a ==============================
[0m16:12:45.262017 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:12:45.262639 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt ls --resource-type model', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\Felli\\.code\\dbt\\canal_brasil_dbt\\logs', 'warn_error': 'None', 'use_colors': 'True', 'introspect': 'True', 'write_json': 'True', 'profiles_dir': 'C:\\Users\\Felli\\.dbt', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m16:12:45.443342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8fe17abc-fb5c-491e-b5e9-f4d70bf40e4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7162A3100>]}
[0m16:12:45.524390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8fe17abc-fb5c-491e-b5e9-f4d70bf40e4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A71623F020>]}
[0m16:12:45.525230 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m16:12:45.531997 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:12:45.586097 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:12:45.586448 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:12:45.591739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8fe17abc-fb5c-491e-b5e9-f4d70bf40e4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A716894950>]}
[0m16:12:45.600209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8fe17abc-fb5c-491e-b5e9-f4d70bf40e4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A716247110>]}
[0m16:12:45.600748 [info ] [MainThread]: Found 2 models, 2 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:12:45.601282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fe17abc-fb5c-491e-b5e9-f4d70bf40e4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A716743850>]}
[0m16:12:45.602984 [debug] [MainThread]: Command `dbt ls` succeeded at 16:12:45.602826 after 0.46 seconds
[0m16:12:45.603343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A716706D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A716282690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A716890950>]}
[0m16:12:45.603682 [debug] [MainThread]: Flushing usage events
[0m16:13:09.184728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227B1BF5160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227B483BD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227B483B750>]}


============================== 16:13:09.189298 | e344c2ab-e842-4bdb-937a-0fcb34bc42cc ==============================
[0m16:13:09.189298 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:13:09.190346 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt test --select path:tests/no_duplicate_titulo_hora.sql', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\Felli\\.code\\dbt\\canal_brasil_dbt\\logs', 'warn_error': 'None', 'use_colors': 'True', 'introspect': 'True', 'profiles_dir': 'C:\\Users\\Felli\\.dbt', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m16:13:09.405863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e344c2ab-e842-4bdb-937a-0fcb34bc42cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227B4777100>]}
[0m16:13:09.485966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e344c2ab-e842-4bdb-937a-0fcb34bc42cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227B470F020>]}
[0m16:13:09.486862 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m16:13:09.493822 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:13:09.552044 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:13:09.552415 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:13:09.557536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e344c2ab-e842-4bdb-937a-0fcb34bc42cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227B4D24950>]}
[0m16:13:09.566144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e344c2ab-e842-4bdb-937a-0fcb34bc42cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227B4717110>]}
[0m16:13:09.566770 [info ] [MainThread]: Found 2 models, 2 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:13:09.567638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e344c2ab-e842-4bdb-937a-0fcb34bc42cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227B4BD7A10>]}
[0m16:13:09.568550 [warn ] [MainThread]: The selection criterion 'path:tests/no_duplicate_titulo_hora.sql' does not match any nodes
[0m16:13:09.570010 [info ] [MainThread]: 
[0m16:13:09.570623 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:13:09.571631 [debug] [MainThread]: Command end result
[0m16:13:09.583830 [debug] [MainThread]: Command `dbt test` succeeded at 16:13:09.583586 after 0.50 seconds
[0m16:13:09.584266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227B4B96DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227B4752690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227B4D20650>]}
[0m16:13:09.584629 [debug] [MainThread]: Flushing usage events
[0m16:14:41.829263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013AD1D15160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013AD495BD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013AD495B750>]}


============================== 16:14:41.832882 | 044cfe4f-2a4e-4c8c-99b5-a5f2e9d5e332 ==============================
[0m16:14:41.832882 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:14:41.833500 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt test --select path:tests/no_duplicate_titulo_hora.sql', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\Felli\\.code\\dbt\\canal_brasil_dbt\\logs', 'profiles_dir': 'C:\\Users\\Felli\\.dbt', 'use_colors': 'True', 'introspect': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m16:14:42.018778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '044cfe4f-2a4e-4c8c-99b5-a5f2e9d5e332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013AD4893100>]}
[0m16:14:42.098837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '044cfe4f-2a4e-4c8c-99b5-a5f2e9d5e332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013AD482F020>]}
[0m16:14:42.099767 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m16:14:42.106756 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:14:42.161553 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:14:42.161912 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:14:42.166207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '044cfe4f-2a4e-4c8c-99b5-a5f2e9d5e332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013AD4DE0950>]}
[0m16:14:42.174061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '044cfe4f-2a4e-4c8c-99b5-a5f2e9d5e332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013AD4837110>]}
[0m16:14:42.174562 [info ] [MainThread]: Found 1 model, 1 test, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:14:42.175174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '044cfe4f-2a4e-4c8c-99b5-a5f2e9d5e332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013AD4C97CB0>]}
[0m16:14:42.176706 [info ] [MainThread]: 
[0m16:14:42.177581 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:14:42.178665 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m16:14:42.187755 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:14:42.188136 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m16:14:42.188424 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:14:43.132071 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m16:14:43.132450 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:14:43.132757 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:14:43.237312 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m16:14:43.238697 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m16:14:43.339935 [debug] [ThreadPool]: On list_postgres_public: Close
[0m16:14:43.344063 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:43.344397 [debug] [MainThread]: On master: BEGIN
[0m16:14:43.344678 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:14:44.092775 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m16:14:44.093161 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:44.093504 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:14:44.206171 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m16:14:44.207315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '044cfe4f-2a4e-4c8c-99b5-a5f2e9d5e332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013AD4DD97E0>]}
[0m16:14:44.207712 [debug] [MainThread]: On master: ROLLBACK
[0m16:14:44.302647 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:44.303019 [debug] [MainThread]: On master: BEGIN
[0m16:14:44.494879 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:14:44.495256 [debug] [MainThread]: On master: COMMIT
[0m16:14:44.495540 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:44.495824 [debug] [MainThread]: On master: COMMIT
[0m16:14:44.590285 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:14:44.590666 [debug] [MainThread]: On master: Close
[0m16:14:44.591414 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:14:44.591913 [info ] [MainThread]: 
[0m16:14:44.598154 [debug] [Thread-1 (]: Began running node test.canal_brasil_dbt.no_duplicate_titulo_hora
[0m16:14:44.598578 [info ] [Thread-1 (]: 1 of 1 START test no_duplicate_titulo_hora ..................................... [RUN]
[0m16:14:44.599670 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.canal_brasil_dbt.no_duplicate_titulo_hora'
[0m16:14:44.600399 [debug] [Thread-1 (]: Began compiling node test.canal_brasil_dbt.no_duplicate_titulo_hora
[0m16:14:44.605908 [debug] [Thread-1 (]: Writing injected SQL for node "test.canal_brasil_dbt.no_duplicate_titulo_hora"
[0m16:14:44.607629 [debug] [Thread-1 (]: Timing info for test.canal_brasil_dbt.no_duplicate_titulo_hora (compile): 16:14:44.600693 => 16:14:44.607212
[0m16:14:44.608198 [debug] [Thread-1 (]: Began executing node test.canal_brasil_dbt.no_duplicate_titulo_hora
[0m16:14:44.622804 [debug] [Thread-1 (]: Writing runtime sql for node "test.canal_brasil_dbt.no_duplicate_titulo_hora"
[0m16:14:44.624251 [debug] [Thread-1 (]: Using postgres connection "test.canal_brasil_dbt.no_duplicate_titulo_hora"
[0m16:14:44.624706 [debug] [Thread-1 (]: On test.canal_brasil_dbt.no_duplicate_titulo_hora: BEGIN
[0m16:14:44.625044 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:14:45.478832 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m16:14:45.479248 [debug] [Thread-1 (]: Using postgres connection "test.canal_brasil_dbt.no_duplicate_titulo_hora"
[0m16:14:45.479622 [debug] [Thread-1 (]: On test.canal_brasil_dbt.no_duplicate_titulo_hora: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "node_id": "test.canal_brasil_dbt.no_duplicate_titulo_hora"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/no_duplicate_titulo_hora.sql
SELECT
  titulo,
  dia_hora,
  COUNT(*) as qtd
FROM canal_brasil_silver
GROUP BY titulo, dia_hora
HAVING COUNT(*) > 1
      
    ) dbt_internal_test
[0m16:14:45.587432 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:14:45.589423 [debug] [Thread-1 (]: Timing info for test.canal_brasil_dbt.no_duplicate_titulo_hora (execute): 16:14:44.608441 => 16:14:45.589147
[0m16:14:45.589812 [debug] [Thread-1 (]: On test.canal_brasil_dbt.no_duplicate_titulo_hora: ROLLBACK
[0m16:14:45.706065 [debug] [Thread-1 (]: On test.canal_brasil_dbt.no_duplicate_titulo_hora: Close
[0m16:14:45.707050 [info ] [Thread-1 (]: 1 of 1 PASS no_duplicate_titulo_hora ........................................... [[32mPASS[0m in 1.11s]
[0m16:14:45.707848 [debug] [Thread-1 (]: Finished running node test.canal_brasil_dbt.no_duplicate_titulo_hora
[0m16:14:45.709075 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:45.709389 [debug] [MainThread]: On master: BEGIN
[0m16:14:45.709672 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:14:46.629390 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m16:14:46.629776 [debug] [MainThread]: On master: COMMIT
[0m16:14:46.630068 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:46.630351 [debug] [MainThread]: On master: COMMIT
[0m16:14:46.750494 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:14:46.750877 [debug] [MainThread]: On master: Close
[0m16:14:46.751619 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:14:46.751906 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m16:14:46.752340 [debug] [MainThread]: Connection 'test.canal_brasil_dbt.no_duplicate_titulo_hora' was properly closed.
[0m16:14:46.752735 [info ] [MainThread]: 
[0m16:14:46.753327 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 4.58 seconds (4.58s).
[0m16:14:46.754441 [debug] [MainThread]: Command end result
[0m16:14:46.761627 [info ] [MainThread]: 
[0m16:14:46.762312 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:14:46.762961 [info ] [MainThread]: 
[0m16:14:46.763664 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:14:46.764894 [debug] [MainThread]: Command `dbt test` succeeded at 16:14:46.764741 after 5.05 seconds
[0m16:14:46.765248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013AD4872690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013AD4CF83C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013AD4CF8B50>]}
[0m16:14:46.765592 [debug] [MainThread]: Flushing usage events
[0m16:15:31.890023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FD2875160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FD54BBD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FD54BB750>]}


============================== 16:15:31.893633 | d570e854-490d-44cb-a3e7-735c9b26256d ==============================
[0m16:15:31.893633 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:15:31.894314 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt test --select path:tests/no_duplicate_titulo_hora.sql', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\Felli\\.code\\dbt\\canal_brasil_dbt\\logs', 'warn_error': 'None', 'cache_selected_only': 'False', 'introspect': 'True', 'profiles_dir': 'C:\\Users\\Felli\\.dbt', 'use_colors': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m16:15:32.076913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd570e854-490d-44cb-a3e7-735c9b26256d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FD53F3100>]}
[0m16:15:32.155849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd570e854-490d-44cb-a3e7-735c9b26256d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FD538F020>]}
[0m16:15:32.156684 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m16:15:32.163307 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:15:32.216873 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:15:32.217225 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:15:32.221839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd570e854-490d-44cb-a3e7-735c9b26256d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FD59A0950>]}
[0m16:15:32.229690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd570e854-490d-44cb-a3e7-735c9b26256d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FD5397110>]}
[0m16:15:32.230150 [info ] [MainThread]: Found 1 model, 1 test, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:15:32.230627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd570e854-490d-44cb-a3e7-735c9b26256d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FD5857CB0>]}
[0m16:15:32.232160 [info ] [MainThread]: 
[0m16:15:32.232986 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:15:32.234050 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m16:15:32.243152 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:15:32.243613 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m16:15:32.243922 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:15:33.000853 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m16:15:33.001246 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:15:33.001562 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:15:33.093789 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m16:15:33.095023 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m16:15:33.187408 [debug] [ThreadPool]: On list_postgres_public: Close
[0m16:15:33.191508 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:33.191840 [debug] [MainThread]: On master: BEGIN
[0m16:15:33.192122 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:15:34.120265 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m16:15:34.120643 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:34.121003 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:15:34.252070 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m16:15:34.253197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd570e854-490d-44cb-a3e7-735c9b26256d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FD59997E0>]}
[0m16:15:34.253592 [debug] [MainThread]: On master: ROLLBACK
[0m16:15:34.369257 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:34.369627 [debug] [MainThread]: On master: BEGIN
[0m16:15:34.600514 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:15:34.600904 [debug] [MainThread]: On master: COMMIT
[0m16:15:34.601197 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:34.601478 [debug] [MainThread]: On master: COMMIT
[0m16:15:34.719197 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:15:34.719659 [debug] [MainThread]: On master: Close
[0m16:15:34.720524 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:15:34.721050 [info ] [MainThread]: 
[0m16:15:34.727145 [debug] [Thread-1 (]: Began running node test.canal_brasil_dbt.no_duplicate_titulo_hora
[0m16:15:34.727569 [info ] [Thread-1 (]: 1 of 1 START test no_duplicate_titulo_hora ..................................... [RUN]
[0m16:15:34.728768 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.canal_brasil_dbt.no_duplicate_titulo_hora'
[0m16:15:34.729366 [debug] [Thread-1 (]: Began compiling node test.canal_brasil_dbt.no_duplicate_titulo_hora
[0m16:15:34.735637 [debug] [Thread-1 (]: Writing injected SQL for node "test.canal_brasil_dbt.no_duplicate_titulo_hora"
[0m16:15:34.737157 [debug] [Thread-1 (]: Timing info for test.canal_brasil_dbt.no_duplicate_titulo_hora (compile): 16:15:34.729610 => 16:15:34.736566
[0m16:15:34.737861 [debug] [Thread-1 (]: Began executing node test.canal_brasil_dbt.no_duplicate_titulo_hora
[0m16:15:34.751407 [debug] [Thread-1 (]: Writing runtime sql for node "test.canal_brasil_dbt.no_duplicate_titulo_hora"
[0m16:15:34.752938 [debug] [Thread-1 (]: Using postgres connection "test.canal_brasil_dbt.no_duplicate_titulo_hora"
[0m16:15:34.753507 [debug] [Thread-1 (]: On test.canal_brasil_dbt.no_duplicate_titulo_hora: BEGIN
[0m16:15:34.753904 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:15:35.526038 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m16:15:35.526513 [debug] [Thread-1 (]: Using postgres connection "test.canal_brasil_dbt.no_duplicate_titulo_hora"
[0m16:15:35.526867 [debug] [Thread-1 (]: On test.canal_brasil_dbt.no_duplicate_titulo_hora: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "canal_brasil_dbt", "target_name": "dev", "node_id": "test.canal_brasil_dbt.no_duplicate_titulo_hora"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/no_duplicate_titulo_hora.sql
SELECT
  titulo,
  dia_hora,
  COUNT(*) as qtd
FROM canal_brasil_silver
GROUP BY titulo, dia_hora
HAVING COUNT(*) > 1
      
    ) dbt_internal_test
[0m16:15:35.622069 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:15:35.623869 [debug] [Thread-1 (]: Timing info for test.canal_brasil_dbt.no_duplicate_titulo_hora (execute): 16:15:34.738164 => 16:15:35.623631
[0m16:15:35.624225 [debug] [Thread-1 (]: On test.canal_brasil_dbt.no_duplicate_titulo_hora: ROLLBACK
[0m16:15:35.719653 [debug] [Thread-1 (]: On test.canal_brasil_dbt.no_duplicate_titulo_hora: Close
[0m16:15:35.720638 [info ] [Thread-1 (]: 1 of 1 PASS no_duplicate_titulo_hora ........................................... [[32mPASS[0m in 0.99s]
[0m16:15:35.721422 [debug] [Thread-1 (]: Finished running node test.canal_brasil_dbt.no_duplicate_titulo_hora
[0m16:15:35.722635 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:35.722949 [debug] [MainThread]: On master: BEGIN
[0m16:15:35.723232 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:15:36.528481 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m16:15:36.528864 [debug] [MainThread]: On master: COMMIT
[0m16:15:36.529151 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:36.529429 [debug] [MainThread]: On master: COMMIT
[0m16:15:36.628631 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:15:36.629024 [debug] [MainThread]: On master: Close
[0m16:15:36.629776 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:15:36.630060 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m16:15:36.630324 [debug] [MainThread]: Connection 'test.canal_brasil_dbt.no_duplicate_titulo_hora' was properly closed.
[0m16:15:36.630626 [info ] [MainThread]: 
[0m16:15:36.631132 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 4.40 seconds (4.40s).
[0m16:15:36.631926 [debug] [MainThread]: Command end result
[0m16:15:36.638945 [info ] [MainThread]: 
[0m16:15:36.639560 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:15:36.640215 [info ] [MainThread]: 
[0m16:15:36.640872 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:15:36.642570 [debug] [MainThread]: Command `dbt test` succeeded at 16:15:36.642309 after 4.83 seconds
[0m16:15:36.643017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FD53D2690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FD58B83C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FD58B8B50>]}
[0m16:15:36.643413 [debug] [MainThread]: Flushing usage events
[0m20:04:11.309784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E044315400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E043E66710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E046F5FED0>]}


============================== 20:04:11.313846 | afd8e034-3642-4f4f-b37f-543c3787ae7a ==============================
[0m20:04:11.313846 [info ] [MainThread]: Running with dbt=1.7.4
[0m20:04:11.314494 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt ', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'c:\\Users\\Felli\\.code\\dbt\\canal_brasil_dbt\\logs', 'warn_error': 'None', 'cache_selected_only': 'False', 'introspect': 'True', 'write_json': 'True', 'profiles_dir': 'C:\\Users\\Felli\\.dbt', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m20:04:11.424438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'afd8e034-3642-4f4f-b37f-543c3787ae7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E046EA5220>]}
[0m20:04:11.425206 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m20:04:11.426306 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m20:04:11.427812 [debug] [MainThread]: Command `cli deps` succeeded at 20:04:11.427629 after 0.21 seconds
[0m20:04:11.428193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E046E33F00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E046E33DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E0466B9050>]}
[0m20:04:11.428536 [debug] [MainThread]: Flushing usage events
